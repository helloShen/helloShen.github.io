<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Container,容器," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="容器的填充实现容器抽象类例子是一个“享元模式（FlyWeight）”。顾名思义，Fly Weight，就是用在有大量对象的组件里，为了节省内存空间的大小。指导思想，就是把巨量的对象从代码中剥离出来，单独储存，供大家访问。
这里实现享元模式的动机就是要把Map里的数据从Map里分离出来。演示Map里如果没有实际数据，也是可以依靠外部数据源工作的。
当然现有的容器类不能和它兼容。需要重新构造专用容器。">
<meta property="og:type" content="article">
<meta property="og:title" content="（草稿中）">
<meta property="og:url" content="www.ciaoshen.com/2016/09/09/tij4-17/index.html">
<meta property="og:site_name" content="沈玮 | Wei SHEN">
<meta property="og:description" content="容器的填充实现容器抽象类例子是一个“享元模式（FlyWeight）”。顾名思义，Fly Weight，就是用在有大量对象的组件里，为了节省内存空间的大小。指导思想，就是把巨量的对象从代码中剥离出来，单独储存，供大家访问。
这里实现享元模式的动机就是要把Map里的数据从Map里分离出来。演示Map里如果没有实际数据，也是可以依靠外部数据源工作的。
当然现有的容器类不能和它兼容。需要重新构造专用容器。">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-17/collection.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-17/cursor.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-17/listIterator.png">
<meta property="og:updated_time" content="2016-09-13T05:25:07.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="（草稿中）">
<meta name="twitter:description" content="容器的填充实现容器抽象类例子是一个“享元模式（FlyWeight）”。顾名思义，Fly Weight，就是用在有大量对象的组件里，为了节省内存空间的大小。指导思想，就是把巨量的对象从代码中剥离出来，单独储存，供大家访问。
这里实现享元模式的动机就是要把Map里的数据从Map里分离出来。演示Map里如果没有实际数据，也是可以依靠外部数据源工作的。
当然现有的容器类不能和它兼容。需要重新构造专用容器。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: 'Author'
    }
  };
</script>



  <meta name="baidu-site-verification" content="3iRy3UFlpa" />


<script>
  (function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>


  <title> （草稿中） | 沈玮 | Wei SHEN </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-74473715-1', 'auto');
  ga('send', 'pageview');
</script>







  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">沈玮 | Wei SHEN</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Coder & Designer</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
      
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'hDG3wYskg4CYKGSXw8x7','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                （草稿中）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-09T12:06:45+08:00" content="2016-09-09">
              2016-09-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Note/" itemprop="url" rel="index">
                    <span itemprop="name">Note</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/09/tij4-17/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/09/09/tij4-17/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
            <span id="busuanzi_container_page_pv">&nbsp; |  &nbsp; &nbsp; Viewed <span id="busuanzi_value_page_pv"></span> times</span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="容器的填充"><a href="#容器的填充" class="headerlink" title="容器的填充"></a>容器的填充</h3><h4 id="实现容器抽象类"><a href="#实现容器抽象类" class="headerlink" title="实现容器抽象类"></a>实现容器抽象类</h4><p>例子是一个“享元模式（FlyWeight）”。顾名思义，Fly Weight，就是用在有大量对象的组件里，为了节省内存空间的大小。指导思想，就是把巨量的对象从代码中剥离出来，单独储存，供大家访问。</p>
<p>这里实现享元模式的动机就是要把Map里的数据从Map里分离出来。演示Map里如果没有实际数据，也是可以依靠外部数据源工作的。</p>
<p>当然现有的容器类不能和它兼容。需要重新构造专用容器。但也不需要完全重头开始造轮子。可以继承类库提供的容器抽象类。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCountries</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  数据二维数组</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String[][] DATA = &#123;</span><br><span class="line">    <span class="comment">// Africa</span></span><br><span class="line">    &#123;<span class="string">"ALGERIA"</span>,<span class="string">"Algiers"</span>&#125;, &#123;<span class="string">"ANGOLA"</span>,<span class="string">"Luanda"</span>&#125;,</span><br><span class="line">    <span class="comment">//一万个国家名和首都的pair... ...</span></span><br><span class="line">    &#123;<span class="string">"URUGUAY"</span>,<span class="string">"Montevideo"</span>&#125;, &#123;<span class="string">"VENEZUELA"</span>,<span class="string">"Caracas"</span>&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">       </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 套嵌MAP</span><br><span class="line">     * 实现 AbstractMap 要实现 entrySet()。因为AbstractMap没有实现Map接口定义的entrySet方法。</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CountriesMap</span> <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * MAP内部二层套嵌类Entry 实现 Map.Entry 套嵌泛型类。这里为了支持享元，要重写两个方法：getKey()和getValue()。</span><br><span class="line">         * 享元模式：Entry只要一个index字段。Entry所有内容根据这个index到享元里找。</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">Entry</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.index=index;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getKey</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> DATA[index%DATA.length][<span class="number">0</span>];&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> DATA[index%DATA.length][<span class="number">1</span>];&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span></span>&#123;<span class="keyword">return</span> getKey()==((Entry)o).getKey();&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> getValue().hashCode();&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">setValue</span><span class="params">(String value)</span></span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();  <span class="comment">//只读，不支持改数据</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 二层套嵌 Set</span><br><span class="line">         * 实现只读 AbstractSet 要实现 size() &amp; iterator()。 因为AbstractSet继承自AbstractCollection。但AbstractCollection中定义了size() &amp; iterator()方法，但没有实现。</span><br><span class="line">         * 享元模式：只保留一个size字段。Set的所有内容根据这个size从享元中找。</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EntrySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">EntrySet</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.size=DATA.length;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">EntrySet</span><span class="params">(<span class="keyword">int</span> size)</span></span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(size&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.size=<span class="number">0</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(size&gt;DATA.length)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.size=DATA.length;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.size=size;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> size;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/**</span><br><span class="line">             * Set 内部三层套嵌迭代器</span><br><span class="line">             */</span></span><br><span class="line">            <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">EntryIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">private</span> Entry e=<span class="keyword">new</span> Entry(<span class="number">0</span>);</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> e.index&lt;size-<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">public</span> Map.Entry&lt;String,String&gt; next()&#123;</span><br><span class="line">                    e.index++;</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;e.index=<span class="number">0</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">public</span> Iterator&lt;Map.Entry&lt;String,String&gt;&gt; iterator()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> EntryIterator();</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//定义好了套嵌Set之后，写entrySet()方法</span></span><br><span class="line">        <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet()&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(DATA.length);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//神奇的匿名内部类，重写entrySet()方法。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; select(<span class="keyword">final</span> <span class="keyword">int</span> size)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CountriesMap()&#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(size);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回整个Map</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;String,String&gt; map=<span class="keyword">new</span> CountriesMap();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; capitals()&#123;</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回部分Map</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; capitals(<span class="keyword">int</span> size)&#123;</span><br><span class="line">        <span class="keyword">return</span> select(size);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回所有国家名的List</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">names</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;String&gt;(map.keySet());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回部分国家名的List</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">names</span><span class="params">(<span class="keyword">int</span> size)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;String&gt;(capitals(size).keySet());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="看看keySet-方法的源代码，看它是怎么实现的"><a href="#看看keySet-方法的源代码，看它是怎么实现的" class="headerlink" title="看看keySet( )方法的源代码，看它是怎么实现的"></a>看看keySet( )方法的源代码，看它是怎么实现的</h5><p>简单讲就是利用AbstractSet里的Iterator，逐个获取元素的Key键值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Set&lt;K&gt; <span class="title">keySet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (keySet == <span class="keyword">null</span>) &#123;</span><br><span class="line">        keySet = <span class="keyword">new</span> AbstractSet&lt;K&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> Iterator&lt;K&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;K&gt;() &#123;</span><br><span class="line">                    <span class="keyword">private</span> Iterator&lt;Entry&lt;K,V&gt;&gt; i = entrySet().iterator();	<span class="comment">//代理模式</span></span><br><span class="line"></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> i.hasNext();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> K <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> i.next().getKey();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        i.remove();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//AbstractSet接口的其他方法</span></span><br><span class="line"><span class="comment">//... ...</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> keySet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里用了一个代理模式，内部的委托类就是我们实现了的entrySet()方法和iterator()方法。</p>
<p>所以这这个Map实现地非常轻量级，仅仅是设置了一个到储存数据的二维数组的一个索引，就实现了对数据的查询功能。</p>
<h5 id="用匿名内部类覆盖某方法，有奇效"><a href="#用匿名内部类覆盖某方法，有奇效" class="headerlink" title="用匿名内部类覆盖某方法，有奇效"></a>用匿名内部类覆盖某方法，有奇效</h5><p>内部类这一章，只注意到了匿名内部类的一种使用场景：实现某个interface。</p>
<p>但实际上<strong>匿名内部类的语法表达的是一个“继承”的概念</strong>。看select()方法的代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//神奇的匿名内部类，重写entrySet()方法。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; select(<span class="keyword">final</span> <span class="keyword">int</span> size)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CountriesMap()&#123;</span><br><span class="line">        <span class="annotation">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet()&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(size);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里<strong>“new CountriesMap()”</strong>表达的是：</p>
<ul>
<li><strong>创建一个继承自CountriesMap的匿名类的对象。</strong></li>
</ul>
<p>这里仅仅是重写了entrySet()方法，就能够返回数据表不同大小的子块。这算是匿名内部类比较经典的应用场景了。</p>
<h3 id="Collection接口"><a href="#Collection接口" class="headerlink" title="Collection接口"></a>Collection接口</h3><p>不多说，放张图，这几个方法是要记住的。总的来说，以一个List表为代表的一组容器，最典型的操作就这么几样：</p>
<ul>
<li><strong>读取元素</strong>：add(), addAll()</li>
<li><strong>检查元素</strong>：contains(), containsAll(), isEmpty(), size()</li>
<li><strong>改变元素</strong>：clear(), remove(), removeAll(), retainAll()</li>
<li><strong>迭代器</strong>：iterator(), Iterator.hasNext(), Iterator.next(), Iterator.remove()</li>
<li><strong>类型转换</strong>：toArray()</li>
</ul>
<p>这些都是经过时间检验的<strong>“工程经验”</strong>。</p>
<p><img src="/uploads/tij4-17/collection.png" alt="collection"></p>
<p>注意一下迭代器光标Cursor位置：<br><img src="/uploads/tij4-17/cursor.png" alt="cursor"></p>
<h3 id="可选操作"><a href="#可选操作" class="headerlink" title="可选操作"></a>可选操作</h3><p>可选操作是个坑。它是指比如在Collection接口中，以下几个方法，</p>
<ul>
<li>retainAll()</li>
<li>removeAll()</li>
<li>clear()</li>
<li>add()</li>
<li>addAll()</li>
<li>remove()</li>
</ul>
<p>它们是可选方法。但仅仅是在官方文档的方法解释后面加了两个字<strong>“(optional operation)”</strong>而已。</p>
<p>它的实现方式非常隐蔽，当我们用<strong>“Arrays.asList()”</strong>方法把一个数组转换成一个List的时候，看起来返回的数据类型是ArrayList，但注意这不是<strong>java.util.ArrayList</strong>，而是Arrays内部一个同名的套嵌类<strong>java.util.Arrays.ArrayList</strong>。在这个“山寨”ArrayList里以上列出来的方法只是假装实现了一下，抛出一个<strong>UnsupportedOperationException</strong>而已。贴一下部分源代码：</p>
<p>下面是java.util.Arrays中套嵌ArrayList的代码开头部分。很明显，它继承自抽象类AbstractList<e>。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;</span><br><span class="line">       <span class="keyword">implements</span> <span class="title">RandomAccess</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span><br><span class="line">   </span>&#123;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">2764017481108945198L</span>;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">final</span> E[] a;</span><br><span class="line"></span><br><span class="line">       ArrayList(E[] array) &#123;</span><br><span class="line">           <span class="keyword">if</span> (array==<span class="keyword">null</span>)</span><br><span class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">           a = array;</span><br><span class="line">       &#125;</span><br><span class="line">	<span class="comment">//... ...</span></span><br><span class="line">	<span class="comment">//... ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></e></p>
<p>而抽象类AbstractList里，以上列出来的几个方法根本没有实现，只是抛出<strong>UnsupportedOperationException</strong>。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> index, E element)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">//... ...</span></span><br><span class="line"><span class="comment">//... ...</span></span><br></pre></td></tr></table></figure></p>
<h4 id="可选操作是坑？还是良好的设计？"><a href="#可选操作是坑？还是良好的设计？" class="headerlink" title="可选操作是坑？还是良好的设计？"></a>可选操作是坑？还是良好的设计？</h4><p>书上对此的解释是：</p>
<ul>
<li>因为Arrays.asList()生成的List，基于一个固定大小的数组，所以仅支持那些不会改变数组大小的操作，是有道理的。</li>
</ul>
<p>我表示，很难接受这样的解释。这真的很坑。要么索性就重新取个名字，干嘛要取一样的名字骗我们呢。网上都把这个错误列为<a href="http://www.importnew.com/12074.html" target="_blank" rel="external"><strong>《Java程序员们最常犯的10个错误》</strong></a>之首了好吗，真的不能原谅。</p>
<p>类似这样的“未获支持的操作”的坑，还有<strong>Collections.unmodifiableList()</strong>方法返回的Collection。除了以上列出来的方法，它还禁掉了一个List.set()方法，因为它返回的容器不仅仅是固定大小，还完全不能修改。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = Arrays.asList(<span class="string">"A B C D E F G H I J K L"</span>.split(<span class="string">" "</span>));</span><br><span class="line">Collections.unmodifiableList(<span class="keyword">new</span> ArrayList&lt;String&gt;(list));</span><br></pre></td></tr></table></figure></p>
<p>书上更深层的解释是：</p>
<ul>
<li>这样设计是为了防止“接口爆炸”。</li>
</ul>
<p>因为上面两个例子，就省去了FixSizeList和UnmodifiableList两个接口。</p>
<h3 id="AbstractCollection抽象类"><a href="#AbstractCollection抽象类" class="headerlink" title="AbstractCollection抽象类"></a>AbstractCollection抽象类</h3><p>翻一下AbstractCollection抽象类的源码。看到它是完全不依赖于任何数据而独立存在的。对它的简单描述应该是这样：</p>
<ol>
<li>是个空壳，没有数据。</li>
<li>所有定义的操作全都指向一个假象的数据体。</li>
<li>操作和数据之间唯二的发生关系的途径是通过：<strong>get()</strong>和<strong>size()</strong>两个方法。而这两个方法是抽象方法，留给用户自己定义。</li>
<li>大致的思路就是以size()为界，用Iterator遍历元素。然后假设get()方法能返回元素。能完成几乎所有读取，查找，转换操作。</li>
<li>然后写操作的add()方法是未定义操作UnsupportedOperationException。</li>
</ol>
<p>所以AbstractCollection是完全没有实体的。</p>
<h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><p>工程模型和Collection是一致的，操作也分成：读取元素，检查元素，改变元素，迭代器，类型转换，这几大类。不赘述。</p>
<p>需要注意：<strong>List有个更强大的迭代器ListIterator。</strong> 遍历能往前，往后，双向移动。还有写操作add(),set()。看下图，<br><img src="/uploads/tij4-17/listIterator.png" alt="listIterator"></p>
<h4 id="单向链表设计思路"><a href="#单向链表设计思路" class="headerlink" title="单向链表设计思路"></a>单向链表设计思路</h4><p>比较重要的几个点，方便以后回顾比较：</p>
<ol>
<li>节点的数据结构很清楚：一部分放数据，一部分是指向下一个节点的指针。</li>
<li>个人比较喜欢：前后两个固定的头节点head和尾节点tail。只站桩，无数据。</li>
<li>其中，只有头节点是必须的。无头节点的话，对第一个元素的操作会和其他元素不同，代码复杂化。</li>
<li>尾节点可以没有。可以让最后一个元素指向null。加尾节点是为了在末尾插入新元素更高效。不然就得从head遍历到最后一个元素，再插入。</li>
<li>head.next指向第一个节点，tail.next指向最后一个节点。当链表为空，head.next=tail。 tail.next=head。</li>
<li>cursor光标表示上一个next()方法返回的节点。</li>
<li>previous引用盯住cursor。表示cursor的前一个节点。为了remove()的时候能找到前一个节点的向后引用。</li>
<li>每一次调用next()，只能用remove()方法删除一次当前节点。删除完，光标退回上一节点。</li>
<li>只有两种情况，previous和cursor指向同一个节点：要么初始阶段还没有调用过next()。要么next()返回的上一个节点被remove()方法删掉。</li>
<li>previous和cursor永远不可能指向tail。</li>
</ol>
<p>关于LinkedList头节点的总结：</p>
<ol>
<li>头节点是不储存元素信息的纯功能性节点。用来停放指针。</li>
<li>单纯从功能上讲，单个头节点head就够了。不需要尾节点。</li>
<li>没有head头节点的话，大部分操作对第一个元素和后续元素，实现都不同。导致逻辑复杂。容易出bug。编程目标是不出错，不是为了挑战脑力。</li>
<li>不需要专门的桩子尾节点。但需要一个tail指针，指向末尾元素，方便从末尾插入新元素。</li>
<li>双头节点版本：一个头节点head，一个尾节点tail。也没什么不好。反而逻辑清楚。</li>
<li>JDK里的官方LinkedList是没有头节点的版本。不知道为什么。难道是节约内存？</li>
</ol>
<h3 id="Exercise"><a href="#Exercise" class="headerlink" title="Exercise"></a>Exercise</h3><p>本章习题依赖的工具有：</p>
<h4 id="MyCountries-java"><a href="#MyCountries-java" class="headerlink" title="MyCountries.java"></a>MyCountries.java</h4><p>我自己重新写的一个“国家-首都”填充器。也是基于享元模式。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCountries</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  数据二维数组</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String[][] DATA = &#123;</span><br><span class="line">    <span class="comment">// Africa</span></span><br><span class="line">    &#123;<span class="string">"ALGERIA"</span>,<span class="string">"Algiers"</span>&#125;, &#123;<span class="string">"ANGOLA"</span>,<span class="string">"Luanda"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BENIN"</span>,<span class="string">"Porto-Novo"</span>&#125;, &#123;<span class="string">"BOTSWANA"</span>,<span class="string">"Gaberone"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BURKINA FASO"</span>,<span class="string">"Ouagadougou"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BURUNDI"</span>,<span class="string">"Bujumbura"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CAMEROON"</span>,<span class="string">"Yaounde"</span>&#125;, &#123;<span class="string">"CAPE VERDE"</span>,<span class="string">"Praia"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CENTRAL AFRICAN REPUBLIC"</span>,<span class="string">"Bangui"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CHAD"</span>,<span class="string">"N’djamena"</span>&#125;, &#123;<span class="string">"COMOROS"</span>,<span class="string">"Moroni"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CONGO"</span>,<span class="string">"Brazzaville"</span>&#125;, &#123;<span class="string">"DJIBOUTI"</span>,<span class="string">"Dijibouti"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"EGYPT"</span>,<span class="string">"Cairo"</span>&#125;, &#123;<span class="string">"EQUATORIAL GUINEA"</span>,<span class="string">"Malabo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"ERITREA"</span>,<span class="string">"Asmara"</span>&#125;, &#123;<span class="string">"ETHIOPIA"</span>,<span class="string">"Addis Ababa"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"GABON"</span>,<span class="string">"Libreville"</span>&#125;, &#123;<span class="string">"THE GAMBIA"</span>,<span class="string">"Banjul"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"GHANA"</span>,<span class="string">"Accra"</span>&#125;, &#123;<span class="string">"GUINEA"</span>,<span class="string">"Conakry"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BISSAU"</span>,<span class="string">"Bissau"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"COTE D’IVOIR (IVORY COAST)"</span>,<span class="string">"Yamoussoukro"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"KENYA"</span>,<span class="string">"Nairobi"</span>&#125;, &#123;<span class="string">"LESOTHO"</span>,<span class="string">"Maseru"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"LIBERIA"</span>,<span class="string">"Monrovia"</span>&#125;, &#123;<span class="string">"LIBYA"</span>,<span class="string">"Tripoli"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MADAGASCAR"</span>,<span class="string">"Antananarivo"</span>&#125;, &#123;<span class="string">"MALAWI"</span>,<span class="string">"Lilongwe"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MALI"</span>,<span class="string">"Bamako"</span>&#125;, &#123;<span class="string">"MAURITANIA"</span>,<span class="string">"Nouakchott"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MAURITIUS"</span>,<span class="string">"Port Louis"</span>&#125;, &#123;<span class="string">"MOROCCO"</span>,<span class="string">"Rabat"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MOZAMBIQUE"</span>,<span class="string">"Maputo"</span>&#125;, &#123;<span class="string">"NAMIBIA"</span>,<span class="string">"Windhoek"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"NIGER"</span>,<span class="string">"Niamey"</span>&#125;, &#123;<span class="string">"NIGERIA"</span>,<span class="string">"Abuja"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"RWANDA"</span>,<span class="string">"Kigali"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SAO TOME E PRINCIPE"</span>,<span class="string">"Sao Tome"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SENEGAL"</span>,<span class="string">"Dakar"</span>&#125;, &#123;<span class="string">"SEYCHELLES"</span>,<span class="string">"Victoria"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SIERRA LEONE"</span>,<span class="string">"Freetown"</span>&#125;, &#123;<span class="string">"SOMALIA"</span>,<span class="string">"Mogadishu"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SOUTH AFRICA"</span>,<span class="string">"Pretoria/Cape Town"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SUDAN"</span>,<span class="string">"Khartoum"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SWAZILAND"</span>,<span class="string">"Mbabane"</span>&#125;, &#123;<span class="string">"TANZANIA"</span>,<span class="string">"Dodoma"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"TOGO"</span>,<span class="string">"Lome"</span>&#125;, &#123;<span class="string">"TUNISIA"</span>,<span class="string">"Tunis"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"UGANDA"</span>,<span class="string">"Kampala"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"DEMOCRATIC REPUBLIC OF THE CONGO (ZAIRE)"</span>,</span><br><span class="line">    <span class="string">"Kinshasa"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"ZAMBIA"</span>,<span class="string">"Lusaka"</span>&#125;, &#123;<span class="string">"ZIMBABWE"</span>,<span class="string">"Harare"</span>&#125;,</span><br><span class="line">    <span class="comment">// Asia</span></span><br><span class="line">    &#123;<span class="string">"AFGHANISTAN"</span>,<span class="string">"Kabul"</span>&#125;, &#123;<span class="string">"BAHRAIN"</span>,<span class="string">"Manama"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BANGLADESH"</span>,<span class="string">"Dhaka"</span>&#125;, &#123;<span class="string">"BHUTAN"</span>,<span class="string">"Thimphu"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BRUNEI"</span>,<span class="string">"Bandar Seri Begawan"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CAMBODIA"</span>,<span class="string">"Phnom Penh"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CHINA"</span>,<span class="string">"Beijing"</span>&#125;, &#123;<span class="string">"CYPRUS"</span>,<span class="string">"Nicosia"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"INDIA"</span>,<span class="string">"New Delhi"</span>&#125;, &#123;<span class="string">"INDONESIA"</span>,<span class="string">"Jakarta"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"IRAN"</span>,<span class="string">"Tehran"</span>&#125;, &#123;<span class="string">"IRAQ"</span>,<span class="string">"Baghdad"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"ISRAEL"</span>,<span class="string">"Jerusalem"</span>&#125;, &#123;<span class="string">"JAPAN"</span>,<span class="string">"Tokyo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"JORDAN"</span>,<span class="string">"Amman"</span>&#125;, &#123;<span class="string">"KUWAIT"</span>,<span class="string">"Kuwait City"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"LAOS"</span>,<span class="string">"Vientiane"</span>&#125;, &#123;<span class="string">"LEBANON"</span>,<span class="string">"Beirut"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MALAYSIA"</span>,<span class="string">"Kuala Lumpur"</span>&#125;, &#123;<span class="string">"THE MALDIVES"</span>,<span class="string">"Male"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MONGOLIA"</span>,<span class="string">"Ulan Bator"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MYANMAR (BURMA)"</span>,<span class="string">"Rangoon"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"NEPAL"</span>,<span class="string">"Katmandu"</span>&#125;, &#123;<span class="string">"NORTH KOREA"</span>,<span class="string">"P’yongyang"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"OMAN"</span>,<span class="string">"Muscat"</span>&#125;, &#123;<span class="string">"PAKISTAN"</span>,<span class="string">"Islamabad"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"PHILIPPINES"</span>,<span class="string">"Manila"</span>&#125;, &#123;<span class="string">"QATAR"</span>,<span class="string">"Doha"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SAUDI ARABIA"</span>,<span class="string">"Riyadh"</span>&#125;, &#123;<span class="string">"SINGAPORE"</span>,<span class="string">"Singapore"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SOUTH KOREA"</span>,<span class="string">"Seoul"</span>&#125;, &#123;<span class="string">"SRI LANKA"</span>,<span class="string">"Colombo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SYRIA"</span>,<span class="string">"Damascus"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"TAIWAN (REPUBLIC OF CHINA)"</span>,<span class="string">"Taipei"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"THAILAND"</span>,<span class="string">"Bangkok"</span>&#125;, &#123;<span class="string">"TURKEY"</span>,<span class="string">"Ankara"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"UNITED ARAB EMIRATES"</span>,<span class="string">"Abu Dhabi"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"VIETNAM"</span>,<span class="string">"Hanoi"</span>&#125;, &#123;<span class="string">"YEMEN"</span>,<span class="string">"Sana’a"</span>&#125;,</span><br><span class="line">    <span class="comment">// Australia and Oceania</span></span><br><span class="line">    &#123;<span class="string">"AUSTRALIA"</span>,<span class="string">"Canberra"</span>&#125;, &#123;<span class="string">"FIJI"</span>,<span class="string">"Suva"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"KIRIBATI"</span>,<span class="string">"Bairiki"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MARSHALL ISLANDS"</span>,<span class="string">"Dalap-Uliga-Darrit"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MICRONESIA"</span>,<span class="string">"Palikir"</span>&#125;, &#123;<span class="string">"NAURU"</span>,<span class="string">"Yaren"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"NEW ZEALAND"</span>,<span class="string">"Wellington"</span>&#125;, &#123;<span class="string">"PALAU"</span>,<span class="string">"Koror"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"PAPUA NEW GUINEA"</span>,<span class="string">"Port Moresby"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SOLOMON ISLANDS"</span>,<span class="string">"Honaira"</span>&#125;, &#123;<span class="string">"TONGA"</span>,<span class="string">"Nuku’alofa"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"TUVALU"</span>,<span class="string">"Fongafale"</span>&#125;, &#123;<span class="string">"VANUATU"</span>,<span class="string">"&lt; Port-Vila"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"WESTERN SAMOA"</span>,<span class="string">"Apia"</span>&#125;,</span><br><span class="line">    <span class="comment">// Eastern Europe and former USSR</span></span><br><span class="line">    &#123;<span class="string">"ARMENIA"</span>,<span class="string">"Yerevan"</span>&#125;, &#123;<span class="string">"AZERBAIJAN"</span>,<span class="string">"Baku"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BELARUS (BYELORUSSIA)"</span>,<span class="string">"Minsk"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BULGARIA"</span>,<span class="string">"Sofia"</span>&#125;, &#123;<span class="string">"GEORGIA"</span>,<span class="string">"Tbilisi"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"KAZAKSTAN"</span>,<span class="string">"Almaty"</span>&#125;, &#123;<span class="string">"KYRGYZSTAN"</span>,<span class="string">"Alma-Ata"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MOLDOVA"</span>,<span class="string">"Chisinau"</span>&#125;, &#123;<span class="string">"RUSSIA"</span>,<span class="string">"Moscow"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"TAJIKISTAN"</span>,<span class="string">"Dushanbe"</span>&#125;, &#123;<span class="string">"TURKMENISTAN"</span>,<span class="string">"Ashkabad"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"UKRAINE"</span>,<span class="string">"Kyiv"</span>&#125;, &#123;<span class="string">"UZBEKISTAN"</span>,<span class="string">"Tashkent"</span>&#125;,</span><br><span class="line">    <span class="comment">// Europe</span></span><br><span class="line">    &#123;<span class="string">"ALBANIA"</span>,<span class="string">"Tirana"</span>&#125;, &#123;<span class="string">"ANDORRA"</span>,<span class="string">"Andorra la Vella"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"AUSTRIA"</span>,<span class="string">"Vienna"</span>&#125;, &#123;<span class="string">"BELGIUM"</span>,<span class="string">"Brussels"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BOSNIA"</span>,<span class="string">"-"</span>&#125;, &#123;<span class="string">"HERZEGOVINA"</span>,<span class="string">"Sarajevo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CROATIA"</span>,<span class="string">"Zagreb"</span>&#125;, &#123;<span class="string">"CZECH REPUBLIC"</span>,<span class="string">"Prague"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"DENMARK"</span>,<span class="string">"Copenhagen"</span>&#125;, &#123;<span class="string">"ESTONIA"</span>,<span class="string">"Tallinn"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"FINLAND"</span>,<span class="string">"Helsinki"</span>&#125;, &#123;<span class="string">"FRANCE"</span>,<span class="string">"Paris"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"GERMANY"</span>,<span class="string">"Berlin"</span>&#125;, &#123;<span class="string">"GREECE"</span>,<span class="string">"Athens"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"HUNGARY"</span>,<span class="string">"Budapest"</span>&#125;, &#123;<span class="string">"ICELAND"</span>,<span class="string">"Reykjavik"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"IRELAND"</span>,<span class="string">"Dublin"</span>&#125;, &#123;<span class="string">"ITALY"</span>,<span class="string">"Rome"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"LATVIA"</span>,<span class="string">"Riga"</span>&#125;, &#123;<span class="string">"LIECHTENSTEIN"</span>,<span class="string">"Vaduz"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"LITHUANIA"</span>,<span class="string">"Vilnius"</span>&#125;, &#123;<span class="string">"LUXEMBOURG"</span>,<span class="string">"Luxembourg"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MACEDONIA"</span>,<span class="string">"Skopje"</span>&#125;, &#123;<span class="string">"MALTA"</span>,<span class="string">"Valletta"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MONACO"</span>,<span class="string">"Monaco"</span>&#125;, &#123;<span class="string">"MONTENEGRO"</span>,<span class="string">"Podgorica"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"THE NETHERLANDS"</span>,<span class="string">"Amsterdam"</span>&#125;, &#123;<span class="string">"NORWAY"</span>,<span class="string">"Oslo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"POLAND"</span>,<span class="string">"Warsaw"</span>&#125;, &#123;<span class="string">"PORTUGAL"</span>,<span class="string">"Lisbon"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"ROMANIA"</span>,<span class="string">"Bucharest"</span>&#125;, &#123;<span class="string">"SAN MARINO"</span>,<span class="string">"San Marino"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SERBIA"</span>,<span class="string">"Belgrade"</span>&#125;, &#123;<span class="string">"SLOVAKIA"</span>,<span class="string">"Bratislava"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SLOVENIA"</span>,<span class="string">"Ljuijana"</span>&#125;, &#123;<span class="string">"SPAIN"</span>,<span class="string">"Madrid"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"SWEDEN"</span>,<span class="string">"Stockholm"</span>&#125;, &#123;<span class="string">"SWITZERLAND"</span>,<span class="string">"Berne"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"UNITED KINGDOM"</span>,<span class="string">"London"</span>&#125;, &#123;<span class="string">"VATICAN CITY"</span>,<span class="string">"---"</span>&#125;,</span><br><span class="line">    <span class="comment">// North and Central America</span></span><br><span class="line">    &#123;<span class="string">"ANTIGUA AND BARBUDA"</span>,<span class="string">"Saint John’s"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BAHAMAS"</span>,<span class="string">"Nassau"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BARBADOS"</span>,<span class="string">"Bridgetown"</span>&#125;, &#123;<span class="string">"BELIZE"</span>,<span class="string">"Belmopan"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CANADA"</span>,<span class="string">"Ottawa"</span>&#125;, &#123;<span class="string">"COSTA RICA"</span>,<span class="string">"San Jose"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"CUBA"</span>,<span class="string">"Havana"</span>&#125;, &#123;<span class="string">"DOMINICA"</span>,<span class="string">"Roseau"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"DOMINICAN REPUBLIC"</span>,<span class="string">"Santo Domingo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"EL SALVADOR"</span>,<span class="string">"San Salvador"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"GRENADA"</span>,<span class="string">"Saint George’s"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"GUATEMALA"</span>,<span class="string">"Guatemala City"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"HAITI"</span>,<span class="string">"Port-au-Prince"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"HONDURAS"</span>,<span class="string">"Tegucigalpa"</span>&#125;, &#123;<span class="string">"JAMAICA"</span>,<span class="string">"Kingston"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"MEXICO"</span>,<span class="string">"Mexico City"</span>&#125;, &#123;<span class="string">"NICARAGUA"</span>,<span class="string">"Managua"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"PANAMA"</span>,<span class="string">"Panama City"</span>&#125;, &#123;<span class="string">"ST. KITTS"</span>,<span class="string">"-"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"NEVIS"</span>,<span class="string">"Basseterre"</span>&#125;, &#123;<span class="string">"ST. LUCIA"</span>,<span class="string">"Castries"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"ST. VINCENT AND THE GRENADINES"</span>,<span class="string">"Kingstown"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"UNITED STATES OF AMERICA"</span>,<span class="string">"Washington, D.C."</span>&#125;,</span><br><span class="line">    <span class="comment">// South America</span></span><br><span class="line">    &#123;<span class="string">"ARGENTINA"</span>,<span class="string">"Buenos Aires"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BOLIVIA"</span>,<span class="string">"Sucre (legal)/La Paz(administrative)"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"BRAZIL"</span>,<span class="string">"Brasilia"</span>&#125;, &#123;<span class="string">"CHILE"</span>,<span class="string">"Santiago"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"COLOMBIA"</span>,<span class="string">"Bogota"</span>&#125;, &#123;<span class="string">"ECUADOR"</span>,<span class="string">"Quito"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"GUYANA"</span>,<span class="string">"Georgetown"</span>&#125;, &#123;<span class="string">"PARAGUAY"</span>,<span class="string">"Asuncion"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"PERU"</span>,<span class="string">"Lima"</span>&#125;, &#123;<span class="string">"SURINAME"</span>,<span class="string">"Paramaribo"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"TRINIDAD AND TOBAGO"</span>,<span class="string">"Port of Spain"</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"URUGUAY"</span>,<span class="string">"Montevideo"</span>&#125;, &#123;<span class="string">"VENEZUELA"</span>,<span class="string">"Caracas"</span>&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     * 套嵌MAP</span><br><span class="line">     * 实现 AbstractMap 要实现 entrySet()。因为AbstractMap没有实现Map接口定义的entrySet方法。</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">CountriesMap</span> <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * MAP内部二层套嵌类Entry 实现 Map.Entry 套嵌泛型类。这里为了支持享元，要重写两个方法：getKey()和getValue()。</span><br><span class="line">         * 享元模式：Entry只要一个index字段。Entry所有内容根据这个index到享元里找。</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">Entry</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.index=index;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getKey</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> DATA[index%DATA.length][<span class="number">0</span>];&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> DATA[index%DATA.length][<span class="number">1</span>];&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span></span>&#123;<span class="keyword">return</span> getKey()==((Entry)o).getKey();&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> getValue().hashCode();&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">setValue</span><span class="params">(String value)</span></span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();  <span class="comment">//只读，不支持改数据</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="string">"("</span>+getKey()+<span class="string">","</span>+getValue()+<span class="string">")"</span>;&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getIndex</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> index;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         * 二层套嵌 Set</span><br><span class="line">         * 实现只读 AbstractSet 要实现 size() &amp; iterator()。 因为AbstractSet继承自AbstractCollection。但AbstractCollection中定义了size() &amp; iterator()方法，但没有实现。</span><br><span class="line">         * 享元模式：只保留一个size字段。Set的所有内容根据这个size从享元中找。</span><br><span class="line">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EntrySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">EntrySet</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.size=DATA.length;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">EntrySet</span><span class="params">(<span class="keyword">int</span> size)</span></span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(size&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.size=<span class="number">0</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(size&gt;DATA.length)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.size=DATA.length;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.size=size;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> size;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/**</span><br><span class="line">             * Set 内部三层套嵌迭代器</span><br><span class="line">             */</span></span><br><span class="line">            <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">EntryIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> index&lt;size-<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">public</span> Map.Entry&lt;String,String&gt; next()&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> Entry(index++);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;index=<span class="number">0</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">public</span> Iterator&lt;Map.Entry&lt;String,String&gt;&gt; iterator()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> EntryIterator();</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//定义好了套嵌Set之后，写entrySet()方法</span></span><br><span class="line">        <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet()&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(DATA.length);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//神奇的匿名内部类，重写entrySet()方法。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; select(<span class="keyword">final</span> <span class="keyword">int</span> size)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CountriesMap()&#123;</span><br><span class="line">            <span class="annotation">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Set&lt;Map.Entry&lt;String,String&gt;&gt; entrySet()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(size);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回整个Map</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;String,String&gt; map=<span class="keyword">new</span> CountriesMap();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; capitals()&#123;</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回部分Map</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; capitals(<span class="keyword">int</span> size)&#123;</span><br><span class="line">        <span class="keyword">return</span> select(size);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回所有国家名的List</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">names</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;String&gt;(map.keySet());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回部分国家名的List</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">names</span><span class="params">(<span class="keyword">int</span> size)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;String&gt;(capitals(size).keySet());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Exercise-1"><a href="#Exercise-1" class="headerlink" title="Exercise 1"></a>Exercise 1</h4><ul>
<li><strong>Exercise 1</strong>: (1) Create a List (try both ArrayList and LinkedList) and fill it using Countries. Sort the list and print it, then apply Collections.shuffle( ) to the list repeatedly, printing it each time so that you can see how the shuffle( ) method randomizes the list differently each time.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CountriesComparator</span> <span class="keyword">implements</span> <span class="title">Comparator</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;&gt;</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Map.Entry&lt;String,String&gt; entry1, Map.Entry&lt;String,String&gt; entry2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> entry1.getKey().compareTo(entry2.getKey());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exercise1</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  ArrayList版本</span><br><span class="line">         */</span></span><br><span class="line">        List&lt;Map.Entry&lt;String,String&gt;&gt; al=<span class="keyword">new</span> ArrayList&lt;Map.Entry&lt;String,String&gt;&gt;(MyCountries.capitals(<span class="number">10</span>).entrySet());</span><br><span class="line">        <span class="comment">//System.out.println(al);</span></span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  LinkedList版本</span><br><span class="line">         */</span></span><br><span class="line">        List&lt;Map.Entry&lt;String,String&gt;&gt; ll=<span class="keyword">new</span> LinkedList&lt;Map.Entry&lt;String,String&gt;&gt;(MyCountries.capitals(<span class="number">15</span>).entrySet());</span><br><span class="line">        <span class="comment">//System.out.println(ll);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  排序再乱序</span><br><span class="line">         */</span></span><br><span class="line">        Collections.sort(al, <span class="keyword">new</span> CountriesComparator());</span><br><span class="line">        System.out.println(al);</span><br><span class="line">        Collections.shuffle(al);</span><br><span class="line">        System.out.println(al);</span><br><span class="line">        Collections.sort(al, <span class="keyword">new</span> CountriesComparator());</span><br><span class="line">        System.out.println(al);</span><br><span class="line">        Collections.shuffle(al);</span><br><span class="line">        System.out.println(al);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exercise-2"><a href="#Exercise-2" class="headerlink" title="Exercise 2"></a>Exercise 2</h4><p>Exercise 2: (2) Produce a Map and a Set containing all the countries that begin with ‘A’.<br>在MyCountries.java里增加一个countriesBeginWithXXX()方法。</p>
<h5 id="MyCountries-java-1"><a href="#MyCountries-java-1" class="headerlink" title="MyCountries.java"></a>MyCountries.java</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCountries</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//之前的代码... ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回国家名以“subName”开头的国家map</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String,String&gt; countriesBeginWithXXX(String subName)&#123;</span><br><span class="line">        Map&lt;String,String&gt; hm=<span class="keyword">new</span> HashMap&lt;String,String&gt;();</span><br><span class="line">        Set&lt;Map.Entry&lt;String,String&gt;&gt; set=map.entrySet();</span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String,String&gt; entry:set)&#123;</span><br><span class="line">            <span class="keyword">if</span>(entry.getKey().indexOf(subName)==<span class="number">0</span>)&#123;</span><br><span class="line">                hm.put(entry.getKey(),entry.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Exercise2-java"><a href="#Exercise2-java" class="headerlink" title="Exercise2.java"></a>Exercise2.java</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exercise2</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  "A"字母打头国家的Map</span><br><span class="line">         */</span></span><br><span class="line">        System.out.println(MyCountries.countriesBeginWithXXX(<span class="string">"A"</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  "A"字母打头国家的Set</span><br><span class="line">         */</span></span><br><span class="line">        System.out.println(MyCountries.countriesBeginWithXXX(<span class="string">"A"</span>).entrySet());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exercise-3"><a href="#Exercise-3" class="headerlink" title="Exercise 3"></a>Exercise 3</h4><ul>
<li><strong>Exercise 3</strong>: (1) Using Countries, fill a Set multiple times with the same data and verify that the Set ends up with only one of each instance. Try this with HashSet, LinkedHashSet, and TreeSet.</li>
</ul>
<h5 id="Exercise3-java"><a href="#Exercise3-java" class="headerlink" title="Exercise3.java"></a>Exercise3.java</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exercise3</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  AbstractSet版本: 按插入顺序</span><br><span class="line">         */</span></span><br><span class="line">        System.out.println(<span class="string">""</span>);</span><br><span class="line">        System.out.println(<span class="string">"##########################################"</span>);</span><br><span class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      AbstractSet      &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;"</span>);</span><br><span class="line">        System.out.println(<span class="string">"##########################################"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">            Set&lt;Map.Entry&lt;String,String&gt;&gt; set=MyCountries.capitals(<span class="number">20</span>).entrySet();</span><br><span class="line">            System.out.println(set);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  HashSet版本：不保持插入顺序</span><br><span class="line">         */</span></span><br><span class="line">        System.out.println(<span class="string">""</span>);</span><br><span class="line">        System.out.println(<span class="string">"######################################"</span>);</span><br><span class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      HashSet      &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;"</span>);</span><br><span class="line">        System.out.println(<span class="string">"######################################"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">            Set&lt;Map.Entry&lt;String,String&gt;&gt; set=<span class="keyword">new</span> HashSet&lt;Map.Entry&lt;String,String&gt;&gt;(MyCountries.capitals(<span class="number">20</span>).entrySet());</span><br><span class="line">            System.out.println(set);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  LinkedHashSet版本：保持插入顺序</span><br><span class="line">         */</span></span><br><span class="line">        System.out.println(<span class="string">""</span>);</span><br><span class="line">        System.out.println(<span class="string">"############################################"</span>);</span><br><span class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      LinkedHashSet      &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;"</span>);</span><br><span class="line">        System.out.println(<span class="string">"############################################"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">            Set&lt;Map.Entry&lt;String,String&gt;&gt; set=<span class="keyword">new</span> LinkedHashSet&lt;Map.Entry&lt;String,String&gt;&gt;(MyCountries.capitals(<span class="number">20</span>).entrySet());</span><br><span class="line">            System.out.println(set);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/**</span><br><span class="line">         *  TreeSet版本: 按照ABCD顺序</span><br><span class="line">         */</span></span><br><span class="line">        System.out.println(<span class="string">""</span>);</span><br><span class="line">        System.out.println(<span class="string">"######################################"</span>);</span><br><span class="line">        System.out.println(<span class="string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;      TreeSet      &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;"</span>);</span><br><span class="line">        System.out.println(<span class="string">"######################################"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">            Set&lt;Map.Entry&lt;String,String&gt;&gt; set=<span class="keyword">new</span> TreeSet&lt;Map.Entry&lt;String,String&gt;&gt;(MyCountries.capitals(<span class="number">20</span>).entrySet());</span><br><span class="line">            System.out.println(set);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="MyCountries-java-2"><a href="#MyCountries-java-2" class="headerlink" title="MyCountries.java"></a>MyCountries.java</h5><p>在MyCountries.CountriesMap.Entry套嵌类里，要加一个compareTo()方法，以实现Comparable接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCountries</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//之前的代码 ... ...</span></span><br><span class="line">	</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">String</span>,<span class="title">String</span>&gt;, <span class="title">Comparable</span>&lt;<span class="title">Entry</span>&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">private</span> <span class="keyword">int</span> index;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="title">Entry</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.index=index;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getKey</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> DATA[index%DATA.length][<span class="number">0</span>];&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> DATA[index%DATA.length][<span class="number">1</span>];&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span></span>&#123;<span class="keyword">return</span> getKey()==((Entry)o).getKey();&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> getValue().hashCode();&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">setValue</span><span class="params">(String value)</span></span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();  <span class="comment">//只读，不支持改数据</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="string">"("</span>+getKey()+<span class="string">","</span>+getValue()+<span class="string">")"</span>;&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getIndex</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> index;&#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Entry e)</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.getKey().compareTo(e.getKey());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//之后的代码 ... ...</span></span><br></pre></td></tr></table></figure>
<h4 id="Exercise-4"><a href="#Exercise-4" class="headerlink" title="Exercise 4"></a>Exercise 4</h4><ul>
<li><strong>Exercise 4</strong>: (2) Create a Collection initializer that opens a file and breaks it into words using TextFile, and then uses the words as the source of data for the resulting Collection. Demonstrate that it works.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollectionInit</span></span>&#123;</span><br><span class="line">    <span class="comment">//读文件切词</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">readFile</span><span class="params">(String inFile)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            BufferedReader in=<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(inFile));</span><br><span class="line">            String s;</span><br><span class="line">            List&lt;String&gt; words=<span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    s=in.readLine();</span><br><span class="line">                    <span class="keyword">if</span>(s==<span class="keyword">null</span>)&#123;<span class="keyword">break</span>;&#125;</span><br><span class="line">                    words.addAll(Arrays.asList(s.replaceAll(<span class="string">"\\p&#123;Punct&#125;"</span>,<span class="string">""</span>).split(<span class="string">"\\s"</span>)));</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    System.out.println(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> words;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exercise4</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        List&lt;String&gt; list=CollectionInit.readFile(<span class="string">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter17/Text.txt"</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exercise-5"><a href="#Exercise-5" class="headerlink" title="Exercise 5"></a>Exercise 5</h4><ul>
<li><strong>Exercise 5</strong>: (3) Modify CountingMapData.java to fully implement the flyweight by adding a custom EntrySet class like the one in Countries.java.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CountingMapData</span> <span class="keyword">extends</span> <span class="title">AbstractMap</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String[] chars = <span class="string">"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z"</span>.split(<span class="string">" "</span>);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CountingMapData</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(size &lt; <span class="number">0</span>) <span class="keyword">this</span>.size = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.size = size;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index;</span><br><span class="line">        Entry(<span class="keyword">int</span> index) &#123; <span class="keyword">this</span>.index = index; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.valueOf(index).equals(o);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getKey</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> index; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> chars[index % chars.length] + Integer.toString(index / chars.length);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">setValue</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.valueOf(index).hashCode();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EntrySet</span> <span class="keyword">extends</span> <span class="title">AbstractSet</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt;&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">EntrySet</span><span class="params">(<span class="keyword">int</span> size)</span></span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.size=size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> size;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Iter</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">Integer</span>,<span class="title">String</span>&gt;&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">return</span> index&lt;size;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">public</span> Map.Entry&lt;Integer,String&gt; next()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Entry(index++);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> Iterator&lt;Map.Entry&lt;Integer,String&gt;&gt; iterator()&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Iter();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Set&lt;Map.Entry&lt;Integer,String&gt;&gt; entrySet() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> EntrySet(size);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">new</span> CountingMapData(<span class="number">60</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Exercise-6"><a href="#Exercise-6" class="headerlink" title="Exercise 6"></a>Exercise 6</h4><ul>
<li><strong>Exercise 6</strong>: (2) Note that List has additional “optional” operations that are not included in Collection. Write a version of Unsupported.java that tests these additional optional operations.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnsupportedList</span> <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String[] staticStr=<span class="string">"A B C D E F G H I J"</span>.split(<span class="string">" "</span>);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> staticStr[index];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> staticStr.length;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exercise6</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;String&gt; list=<span class="keyword">new</span> UnsupportedList();</span><br><span class="line">        Unsupported.test(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exercise-7"><a href="#Exercise-7" class="headerlink" title="Exercise 7"></a>Exercise 7</h4><ul>
<li><strong>Exercise 7</strong>: (4) Create both an ArrayList and a LinkedList, and fill each using the Countries.names( ) generator. Print each list using an ordinary Iterator, then insert one list into the other by using a Listlterator, inserting at every other location. Now perform the insertion starting at the end of the first list and moving backward.</li>
</ul>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class Exercise7&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *Step 1</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> printTwoList()&#123;</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; al=<span class="keyword">new</span> ArrayList&lt;<span class="keyword">String</span>&gt;(MyCountries.names());</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; ll=<span class="keyword">new</span> LinkedList&lt;<span class="keyword">String</span>&gt;(MyCountries.names());</span><br><span class="line">        </span><br><span class="line">        Iterator&lt;<span class="keyword">String</span>&gt; iteAl=al.iterator();</span><br><span class="line">        Iterator&lt;<span class="keyword">String</span>&gt; iteLl=ll.iterator();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(iteAl.hasNext())&#123;</span><br><span class="line">            System.out.<span class="built_in">print</span>(<span class="string">"["</span>+iteAl.next()+<span class="string">"]"</span>);</span><br><span class="line">            <span class="keyword">if</span>(iteAl.hasNext())&#123;</span><br><span class="line">                System.out.<span class="built_in">print</span>(<span class="string">","</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"\n\n"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(iteLl.hasNext())&#123;</span><br><span class="line">            System.out.<span class="built_in">print</span>(<span class="string">"["</span>+iteLl.next()+<span class="string">"]"</span>);</span><br><span class="line">            <span class="keyword">if</span>(iteLl.hasNext())&#123;</span><br><span class="line">                System.out.<span class="built_in">print</span>(<span class="string">","</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *Step 2</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> insertion()&#123;</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; al=<span class="keyword">new</span> ArrayList&lt;<span class="keyword">String</span>&gt;(MyCountries.names());</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; ll=<span class="keyword">new</span> LinkedList&lt;<span class="keyword">String</span>&gt;(MyCountries.names());</span><br><span class="line">        </span><br><span class="line">        ListIterator&lt;<span class="keyword">String</span>&gt; listIteAl=al.listIterator();</span><br><span class="line">        ListIterator&lt;<span class="keyword">String</span>&gt; listIteLl=ll.listIterator();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(listIteAl.hasNext() &amp;&amp; listIteLl.hasNext())&#123;</span><br><span class="line">            listIteLl.<span class="built_in">add</span>(listIteAl.next());</span><br><span class="line">            <span class="keyword">String</span> s=listIteLl.next();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        System.out.<span class="built_in">println</span>(ll);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *Step 3</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> inverseInsertion()&#123;</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; al=<span class="keyword">new</span> ArrayList&lt;<span class="keyword">String</span>&gt;(MyCountries.names());</span><br><span class="line">        List&lt;<span class="keyword">String</span>&gt; ll=<span class="keyword">new</span> LinkedList&lt;<span class="keyword">String</span>&gt;(MyCountries.names());</span><br><span class="line">        </span><br><span class="line">        ListIterator&lt;<span class="keyword">String</span>&gt; listIteAl=al.listIterator(al.<span class="built_in">size</span>());</span><br><span class="line">        ListIterator&lt;<span class="keyword">String</span>&gt; listIteLl=ll.listIterator();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(listIteAl.hasPrevious() &amp;&amp; listIteLl.hasNext())&#123;</span><br><span class="line">            listIteLl.<span class="built_in">add</span>(listIteAl.previous());</span><br><span class="line">            <span class="keyword">String</span> s=listIteLl.next();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        System.out.<span class="built_in">println</span>(ll);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">        printTwoList();</span><br><span class="line">        insertion();</span><br><span class="line">        inverseInsertion();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Exercise-8"><a href="#Exercise-8" class="headerlink" title="Exercise 8"></a>Exercise 8</h4><p>Exercise 8: (7) Create a generic, singly linked list class called SList, which, to keep things simple, does not implement the List interface. Each Link object in the list should contain a reference to the next element in the list, but not the previous one (LinkedList, in contrast, is a doubly linked list, which means it maintains links in both directions). Create your own SListIterator which, again for simplicity, does not implement ListIterator. The only method in SList other than toString( ) should be iterator( ), which produces an SListIterator. The only way to insert and remove elements from an SList is through SListIterator. Write code to demonstrate SList.</p>
<p>关于LinkedList头节点的总结：</p>
<ol>
<li>头节点是不储存元素信息的纯功能性节点。用来停放指针。</li>
<li>单纯从功能上讲，单个头节点head就够了。不需要尾节点。</li>
<li>没有head头节点的话，大部分操作对第一个元素和后续元素，实现都不同。导致逻辑复杂。容易出bug。编程目标是不出错，不是为了挑战脑力。</li>
<li>不需要专门的桩子尾节点。但需要一个tail指针，指向末尾元素，方便从末尾插入新元素。</li>
<li>双头节点版本：一个头节点head，一个尾节点tail。也没什么不好。反而逻辑清楚。</li>
<li>JDK里的官方LinkedList是没有头节点的版本。不知道为什么。难道是节约内存？</li>
</ol>
<h5 id="单头节点版本"><a href="#单头节点版本" class="headerlink" title="单头节点版本"></a>单头节点版本</h5><ol>
<li>单向列表</li>
<li>单头节点。只有前头节点head，无尾节点tail。</li>
<li>tail只是一个指向最后一个元素的指针。</li>
<li>前中后2个光标：previous,cursor。cursor指向上一个next()返回的元素。previous指向cursor的前一个元素。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@SuppressWarnings</span>(value=&#123;<span class="string">"unchecked"</span>, <span class="string">"rawtypes"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SListV2</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; head;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; tail;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SListV2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        head=<span class="keyword">new</span> Node();</span><br><span class="line">        tail=head;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> T item;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; next;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span></span>&#123;item=<span class="keyword">null</span>;next=<span class="keyword">null</span>;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(T t)</span></span>&#123;item=t;next=<span class="keyword">null</span>;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> item.toString();&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">SListIterator</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; cursor=head;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; previous=cursor;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//在cursor后面插入新元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">            Node&lt;T&gt; n=<span class="keyword">new</span> Node&lt;T&gt;(t);</span><br><span class="line">            n.next=tail.next;</span><br><span class="line">            tail.next=n;</span><br><span class="line">            tail=n;</span><br><span class="line">            size++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//替换cursor位置元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==head)&#123;</span><br><span class="line">                System.out.println(<span class="string">"Not Begun!"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                Node&lt;T&gt; n=<span class="keyword">new</span> Node&lt;T&gt;(t);</span><br><span class="line">                cursor.item=t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//从cursor位置开始往后删除</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==previous)&#123;</span><br><span class="line">                System.out.println(<span class="string">"Can't remove!"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(cursor==tail)&#123;</span><br><span class="line">                    tail=previous;</span><br><span class="line">                &#125;</span><br><span class="line">                previous.next=cursor.next;</span><br><span class="line">                cursor=previous;</span><br><span class="line">                index--;</span><br><span class="line">                size--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//current还没到tail</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor.next!=<span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//返回cursor的下一个元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Node&lt;T&gt; <span class="title">next</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(hasNext())&#123;</span><br><span class="line">                previous=cursor;</span><br><span class="line">                cursor=cursor.next;</span><br><span class="line">                index++;</span><br><span class="line">                <span class="keyword">return</span> cursor;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"Reach the end!"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> index;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;</span><br><span class="line">            cursor=head;</span><br><span class="line">            previous=cursor;</span><br><span class="line">            index=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> SListIterator <span class="title">iterator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SListIterator();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        SListIterator ite=iterator();</span><br><span class="line">        <span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">            sb.append(<span class="string">"["</span>+ite.next()+<span class="string">"]"</span>);</span><br><span class="line">            <span class="keyword">if</span>(ite.hasNext())&#123;</span><br><span class="line">                sb.append(<span class="string">","</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  测试</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        String[] s=<span class="string">"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z"</span>.split(<span class="string">" "</span>);</span><br><span class="line">        SListV2&lt;String&gt; list=<span class="keyword">new</span> SListV2&lt;String&gt;();</span><br><span class="line">        SListV2.SListIterator ite=list.iterator();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length;i++)&#123;</span><br><span class="line">            ite.add(s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;ite.size();i++)&#123;</span><br><span class="line">            System.out.println(ite.next());</span><br><span class="line">        &#125;</span><br><span class="line">        ite.reset();</span><br><span class="line">        <span class="keyword">int</span> length=ite.size();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">            Node&lt;String&gt; n=ite.next();</span><br><span class="line">            ite.remove();</span><br><span class="line">            ite.remove();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="双头节点版本"><a href="#双头节点版本" class="headerlink" title="双头节点版本"></a>双头节点版本</h5><ol>
<li>单向列表</li>
<li>双头节点。前头节点head，后尾节点tail。两个节点永远不存放元素。尾节点的next指向最后一个元素。空链表时指向head。</li>
<li>两个光标：previous,cursor。主要是cursor。previous只负责盯住cursor，并在remove的时候提供前一节点的next指针。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@SuppressWarnings</span>(value=&#123;<span class="string">"unchecked"</span>, <span class="string">"rawtypes"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SListV3</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; head;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; tail;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SListV3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        head=<span class="keyword">new</span> Node();</span><br><span class="line">        tail=<span class="keyword">new</span> Node();</span><br><span class="line">        head.next=tail;</span><br><span class="line">        tail.next=head;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> T item;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; next;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span></span>&#123;item=<span class="keyword">null</span>;next=<span class="keyword">null</span>;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(T t)</span></span>&#123;item=t;next=<span class="keyword">null</span>;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> item.toString();&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">SListIterator</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; cursor=head;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; previous=cursor;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> index=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//在tail栓塞前插入新元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">            Node&lt;T&gt; n=<span class="keyword">new</span> Node&lt;T&gt;(t);</span><br><span class="line">            tail.next.next=n;</span><br><span class="line">            n.next=tail;</span><br><span class="line">            tail.next=n;</span><br><span class="line">            size++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//替换当前cursor元素（若当前元素被删，也不能set。）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==previous)&#123;</span><br><span class="line">                System.out.println(<span class="string">"Cannot set!"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                cursor.item=t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//只删除上一次next()返回的元素。每次next()只能删除一次。</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==previous)&#123;</span><br><span class="line">                System.out.println(<span class="string">"Can't remove!"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(tail.next==cursor)&#123;</span><br><span class="line">                    tail.next=previous;</span><br><span class="line">                &#125;</span><br><span class="line">                previous.next=cursor.next;</span><br><span class="line">                cursor=previous;</span><br><span class="line">                index--;</span><br><span class="line">                size--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//current还没到tail</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor.next!=tail;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//返回cursor的下一个元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Node&lt;T&gt; <span class="title">next</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(hasNext())&#123;</span><br><span class="line">                previous=cursor;</span><br><span class="line">                cursor=cursor.next;</span><br><span class="line">                index++;</span><br><span class="line">                <span class="keyword">return</span> cursor;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"Reach the end!"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> index;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;</span><br><span class="line">            cursor=head;</span><br><span class="line">            previous=cursor;</span><br><span class="line">            index=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> SListIterator <span class="title">iterator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SListIterator();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        SListIterator ite=iterator();</span><br><span class="line">        <span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">            sb.append(<span class="string">"["</span>+ite.next()+<span class="string">"]"</span>);</span><br><span class="line">            <span class="keyword">if</span>(ite.hasNext())&#123;</span><br><span class="line">                sb.append(<span class="string">","</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  测试</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        String[] s=<span class="string">"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z"</span>.split(<span class="string">" "</span>);</span><br><span class="line">        SListV3&lt;String&gt; list=<span class="keyword">new</span> SListV3&lt;String&gt;();</span><br><span class="line">        SListV3.SListIterator ite=list.iterator();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length;i++)&#123;</span><br><span class="line">            ite.add(s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;ite.size();i++)&#123;</span><br><span class="line">            System.out.println(ite.next());</span><br><span class="line">        &#125;</span><br><span class="line">        ite.reset();</span><br><span class="line">        <span class="keyword">int</span> length=ite.size();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">            Node&lt;String&gt; n=ite.next();</span><br><span class="line">            ite.remove();</span><br><span class="line">            ite.remove();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="无头节点版本"><a href="#无头节点版本" class="headerlink" title="无头节点版本"></a>无头节点版本</h5><ol>
<li>单向列表</li>
<li>没有栓塞头</li>
<li>head和tail只是两个指针，指向第一个和最后一个元素。</li>
<li>当链表为空：维持一个空节点。head和tail都指向这个空节点。只有一个元素的时候，head和tail也都指向唯一的这个节点。</li>
<li>两个光标：previous,cursor。cursor指向上一个next()返回的元素。previous指向cursor的前一个元素。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter17;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="annotation">@SuppressWarnings</span>(value=&#123;<span class="string">"unchecked"</span>, <span class="string">"rawtypes"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SListV4</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; head;</span><br><span class="line">    <span class="keyword">private</span> Node&lt;T&gt; tail;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SListV4</span><span class="params">()</span></span>&#123;</span><br><span class="line">        head=<span class="keyword">new</span> Node();</span><br><span class="line">        tail=head;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> T item;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; next;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">()</span></span>&#123;item=<span class="keyword">null</span>;next=<span class="keyword">null</span>;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(T t)</span></span>&#123;item=t;next=<span class="keyword">null</span>;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(T t, Node&lt;T&gt; n)</span></span>&#123;item=t;next=n;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> item.toString();&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">SListIterator</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; cursor=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">private</span> Node&lt;T&gt; previous=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> index=-<span class="number">1</span>;</span><br><span class="line">        <span class="comment">//在tail栓塞前插入新元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">            <span class="comment">//空链表</span></span><br><span class="line">            <span class="keyword">if</span>(head.item==<span class="keyword">null</span>)&#123;</span><br><span class="line">                head.item=t;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                Node&lt;T&gt; n=<span class="keyword">new</span> Node&lt;T&gt;(t);</span><br><span class="line">                tail.next=n;</span><br><span class="line">                tail=n;</span><br><span class="line">            &#125;</span><br><span class="line">            size++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//替换当前cursor元素（若当前元素被删，也不能set。）</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(T t)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==previous)&#123;</span><br><span class="line">                System.out.println(<span class="string">"Cannot set!"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                cursor.item=t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//只删除上一次next()返回的元素。每次next()只能删除一次。</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==previous)&#123;</span><br><span class="line">                System.out.println(<span class="string">"Can't remove!"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(cursor==head)&#123;</span><br><span class="line">                    cursor.item=<span class="keyword">null</span>;</span><br><span class="line">                    cursor=<span class="keyword">null</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    previous.next=cursor.next;</span><br><span class="line">                    cursor=previous;</span><br><span class="line">                &#125;</span><br><span class="line">                index--;</span><br><span class="line">                size--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//current还没到tail</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(cursor==<span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> (head.item==<span class="keyword">null</span> &amp;&amp; head.next==<span class="keyword">null</span>)? <span class="keyword">false</span>:<span class="keyword">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> (cursor.next==<span class="keyword">null</span>)? <span class="keyword">false</span>:<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//返回cursor的下一个元素</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Node&lt;T&gt; <span class="title">next</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(hasNext())&#123;</span><br><span class="line">                <span class="keyword">if</span>(cursor==<span class="keyword">null</span> &amp;&amp; head.item==<span class="keyword">null</span>)&#123;</span><br><span class="line">                    cursor=head.next;</span><br><span class="line">                    previous=head;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(cursor==<span class="keyword">null</span> &amp;&amp; head.item!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                    cursor=head;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    previous=cursor;</span><br><span class="line">                    cursor=cursor.next;</span><br><span class="line">                &#125;</span><br><span class="line">                index++;</span><br><span class="line">                <span class="keyword">return</span> cursor;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"Reach the end!"</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> index;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> size;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>&#123;</span><br><span class="line">            cursor=previous=<span class="keyword">null</span>;</span><br><span class="line">            index=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> SListIterator <span class="title">iterator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SListIterator();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        SListIterator ite=iterator();</span><br><span class="line">        <span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">            sb.append(<span class="string">"["</span>+ite.next()+<span class="string">"]"</span>);</span><br><span class="line">            <span class="keyword">if</span>(ite.hasNext())&#123;</span><br><span class="line">                sb.append(<span class="string">","</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  测试</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        String[] s=<span class="string">"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z"</span>.split(<span class="string">" "</span>);</span><br><span class="line">        SListV4&lt;String&gt; list=<span class="keyword">new</span> SListV4&lt;String&gt;();</span><br><span class="line">        SListV4.SListIterator ite=list.iterator();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length;i++)&#123;</span><br><span class="line">            ite.add(s[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;ite.size();i++)&#123;</span><br><span class="line">            System.out.println(ite.next());</span><br><span class="line">        &#125;</span><br><span class="line">        ite.reset();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">            Node&lt;String&gt; n=ite.next();</span><br><span class="line">            ite.set(<span class="string">"XXX"</span>);</span><br><span class="line">            System.out.println(list);</span><br><span class="line">            ite.remove();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Container/" rel="tag">#Container</a>
          
            <a href="/tags/容器/" rel="tag">#容器</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/08/convariat/" rel="next" title="Java中，数组为什么要设计为协变？">
                <i class="fa fa-chevron-left"></i> Java中，数组为什么要设计为协变？
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/09/anonymous/" rel="prev" title="Anonymous Inner Class (匿名内部类) 是否可以extends(继承)其它类,是否可以implements(实现)interface(接口)?">
                Anonymous Inner Class (匿名内部类) 是否可以extends(继承)其它类,是否可以implements(实现)interface(接口)? <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/09/09/tij4-17/"
           data-title="（草稿中）" data-url="www.ciaoshen.com/2016/09/09/tij4-17/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/shenAvatar.jpg"
               alt="沈玮 | Wei SHEN" />
          <p class="site-author-name" itemprop="name">沈玮 | Wei SHEN</p>
          <p class="site-description motion-element" itemprop="description">Coder & Designer</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">47</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">149</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/helloShen" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.douban.com/people/72441576/" target="_blank">
                  
                    <i class="fa fa-globe"></i> DouBan
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/pang-pang-37-37" target="_blank">
                  
                    <i class="fa fa-globe"></i> ZhiHu
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#容器的填充"><span class="nav-number">1.</span> <span class="nav-text">容器的填充</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#实现容器抽象类"><span class="nav-number">1.1.</span> <span class="nav-text">实现容器抽象类</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#看看keySet-方法的源代码，看它是怎么实现的"><span class="nav-number">1.1.1.</span> <span class="nav-text">看看keySet( )方法的源代码，看它是怎么实现的</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#用匿名内部类覆盖某方法，有奇效"><span class="nav-number">1.1.2.</span> <span class="nav-text">用匿名内部类覆盖某方法，有奇效</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Collection接口"><span class="nav-number">2.</span> <span class="nav-text">Collection接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可选操作"><span class="nav-number">3.</span> <span class="nav-text">可选操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#可选操作是坑？还是良好的设计？"><span class="nav-number">3.1.</span> <span class="nav-text">可选操作是坑？还是良好的设计？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AbstractCollection抽象类"><span class="nav-number">4.</span> <span class="nav-text">AbstractCollection抽象类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#List"><span class="nav-number">5.</span> <span class="nav-text">List</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#单向链表设计思路"><span class="nav-number">5.1.</span> <span class="nav-text">单向链表设计思路</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise"><span class="nav-number">6.</span> <span class="nav-text">Exercise</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MyCountries-java"><span class="nav-number">6.1.</span> <span class="nav-text">MyCountries.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-1"><span class="nav-number">6.2.</span> <span class="nav-text">Exercise 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-2"><span class="nav-number">6.3.</span> <span class="nav-text">Exercise 2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#MyCountries-java-1"><span class="nav-number">6.3.1.</span> <span class="nav-text">MyCountries.java</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Exercise2-java"><span class="nav-number">6.3.2.</span> <span class="nav-text">Exercise2.java</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-3"><span class="nav-number">6.4.</span> <span class="nav-text">Exercise 3</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Exercise3-java"><span class="nav-number">6.4.1.</span> <span class="nav-text">Exercise3.java</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MyCountries-java-2"><span class="nav-number">6.4.2.</span> <span class="nav-text">MyCountries.java</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-4"><span class="nav-number">6.5.</span> <span class="nav-text">Exercise 4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-5"><span class="nav-number">6.6.</span> <span class="nav-text">Exercise 5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-6"><span class="nav-number">6.7.</span> <span class="nav-text">Exercise 6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-7"><span class="nav-number">6.8.</span> <span class="nav-text">Exercise 7</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exercise-8"><span class="nav-number">6.9.</span> <span class="nav-text">Exercise 8</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#单头节点版本"><span class="nav-number">6.9.1.</span> <span class="nav-text">单头节点版本</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#双头节点版本"><span class="nav-number">6.9.2.</span> <span class="nav-text">双头节点版本</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#无头节点版本"><span class="nav-number">6.9.3.</span> <span class="nav-text">无头节点版本</span></a></li></ol></li></ol></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">沈玮 | Wei SHEN</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io" rel="external nofollow">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>

</br>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div>
  <span id="busuanzi_container_site_pv">
  Visited  <span id="busuanzi_value_site_pv"></span>  times
  </span>

<span id="busuanzi_container_site_pv">&nbsp; &nbsp; | &nbsp; &nbsp;</span>

  <span id="busuanzi_container_site_uv">
  <span id="busuanzi_value_site_uv"></span>  Visitors
  </span>
<div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  
<script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>

<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = NexT.utils.escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    NexT.motion.middleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');

      if (CONFIG.sidebar.display === 'post' || CONFIG.sidebar.display === 'always') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          NexT.utils.displaySidebar();
        }
      }
    };
  });
</script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"ciaoshen"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  





  
  

  
  


</body>
</html>
