<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="abstract factory,builder,compose,factory method,inherit,reuse,复用类,工厂方法,建造者,组合,继承,虚拟工厂," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="前言从考法语的状态回来，整个过程虽说很煎熬很虐心，但说实在的法语水平真的是有长进，我一直是相信煎熬对人性是一种试炼的。这么多年一直以为自己已经不用练法语了，但显然一门语言是没有止境的。练口语的过程中，认识了不少本地的魁瓜，竟然有人工作之余的兴趣爱好就是帮助新移民提高法语水平你能信？我一直不是一个成功主义者，这些默默无闻的人，是不是很像遍地的野花，其实也很可爱呢？但在一些人人追逐成功的地方，你很难找">
<meta property="og:type" content="article">
<meta property="og:title" content="重构小练习：小游戏-氏族战争">
<meta property="og:url" content="www.ciaoshen.com/2016/06/12/reuseExercise/index.html">
<meta property="og:site_name" content="沈玮 | Wei SHEN">
<meta property="og:description" content="前言从考法语的状态回来，整个过程虽说很煎熬很虐心，但说实在的法语水平真的是有长进，我一直是相信煎熬对人性是一种试炼的。这么多年一直以为自己已经不用练法语了，但显然一门语言是没有止境的。练口语的过程中，认识了不少本地的魁瓜，竟然有人工作之余的兴趣爱好就是帮助新移民提高法语水平你能信？我一直不是一个成功主义者，这些默默无闻的人，是不是很像遍地的野花，其实也很可爱呢？但在一些人人追逐成功的地方，你很难找">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/rose.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/banker.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/ranger.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/skaven.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/playboy.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/barbarian.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/nobody.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/human.jpg">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/clan_1.jpg">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/world.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/result_1.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/result_2.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/clanWar/result_3.png">
<meta property="og:updated_time" content="2016-08-02T00:54:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="重构小练习：小游戏-氏族战争">
<meta name="twitter:description" content="前言从考法语的状态回来，整个过程虽说很煎熬很虐心，但说实在的法语水平真的是有长进，我一直是相信煎熬对人性是一种试炼的。这么多年一直以为自己已经不用练法语了，但显然一门语言是没有止境的。练口语的过程中，认识了不少本地的魁瓜，竟然有人工作之余的兴趣爱好就是帮助新移民提高法语水平你能信？我一直不是一个成功主义者，这些默默无闻的人，是不是很像遍地的野花，其实也很可爱呢？但在一些人人追逐成功的地方，你很难找">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: 'Author'
    }
  };
</script>



  <meta name="baidu-site-verification" content="3iRy3UFlpa" />


<script>
  (function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>


  <title> 重构小练习：小游戏-氏族战争 | 沈玮 | Wei SHEN </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-74473715-1', 'auto');
  ga('send', 'pageview');
</script>







  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">沈玮 | Wei SHEN</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Coder & Designer</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
      
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'hDG3wYskg4CYKGSXw8x7','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                重构小练习：小游戏-氏族战争
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-06-12T12:44:46+08:00" content="2016-06-12">
              2016-06-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Exercise/" itemprop="url" rel="index">
                    <span itemprop="name">Exercise</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/12/reuseExercise/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/06/12/reuseExercise/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
            <span id="busuanzi_container_page_pv">&nbsp; |  &nbsp; &nbsp; Viewed <span id="busuanzi_value_page_pv"></span> times</span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>从考法语的状态回来，整个过程虽说很煎熬很虐心，但说实在的法语水平真的是有长进，我一直是相信煎熬对人性是一种试炼的。这么多年一直以为自己已经不用练法语了，但显然一门语言是没有止境的。练口语的过程中，认识了不少本地的魁瓜，竟然有人工作之余的兴趣爱好就是帮助新移民提高法语水平你能信？我一直不是一个成功主义者，这些默默无闻的人，是不是很像遍地的野花，其实也很可爱呢？但在一些人人追逐成功的地方，你很难找到这样的人。总之，加拿大这个国家还是很可爱的，每个故事都会有一只呆萌的胖子，很明显加拿大就是我们这个世界里的那只胖子。</p>
<p>回到编程，之前Think in Java看到组合，继承，代理。中断了这么久，继续之前，周末先做个小练习，重温一下书里说的一些编程风格。最初的动机只是想做一个最简单的”人类-家族-世界”的模型。但因为之前喝了KK的毒奶《失控》，看完我彻底被洗脑了呀。上帝模式下，想象在一片远古大陆上，各种拥有不同特长能力的种族，相互竞争，繁衍生息，最后会不会有某一种族统治这片大陆？如果有，那到底什么样的特长是最强的？能帮助一个种族最后生存下来？带着这个傻X的想法我就写了这个叫《氏族战争》的小游戏。</p>
<p>稍微剧透一下，结局略狗血，最后的胜利者竟然是这货！！！完全刷新了朕的三观。在一个看颜值的世界，高颜值的玫瑰家族差不多垫底，简直不能忍啊！所以我在想，什么时候能再写一个《氏族战争2》，能不能不要让上面这货赢？</p>
<h3 id="游戏规则"><a href="#游戏规则" class="headerlink" title="游戏规则"></a>游戏规则</h3><p>这片大陆的名字叫艾泽拉斯。</p>
<p>每年的春季，大陆上的未婚妹纸都会向她们周围最帅的未婚小鲜肉表白。但帅哥的心上人是他社交圈内最美那个妹纸，如果正巧就是表白的那妹纸的话，他们就会相爱，并结婚生子。人均生育率为2。婚后妻子加入丈夫的氏族，孩子也跟老爸姓，遗传老爸的能力。</p>
<p>但世界上还有一种好东西叫钱。妹子也会仰慕周围最有钱的富豪，如果这妹子正好是这位富豪的心上人的话，她就会被包养成为情妇（等同于结婚）。</p>
<p>婚后妻子有可能出轨，具体情况根据夫妇俩的忠诚度以及小三的诱惑值决定。妻子出轨以后怀的孩子都是小三的，跟小三姓。</p>
<p>每年夏天，求偶失败的男孩会到周边的地方重新求偶，直到成功或者挂掉为止。</p>
<p>人的颜值会随着年龄的增长衰减。</p>
<p>大陆上有七个奇怪的种族：</p>
<ul>
<li><p><img src="/uploads/clanWar/rose.png" width="100" height="100/"><strong>玫瑰家族(Rose)</strong>:    高颜值。家族成员的平均颜值80分。其他家族平均颜值只有50分。</p>
</li>
<li><p><img src="/uploads/clanWar/banker.png" width="100" height="100/"><strong>银行家家族(Banker)</strong>:    有经济头脑，更会赚钱。银行家人均年收入100刀。其他家族年收入只有50刀。</p>
</li>
<li><p><img src="/uploads/clanWar/ranger.png" width="100" height="100/"><strong>巡游者家族(Ranger)</strong>:    爱好冒险和旅游。巡游者每年在地图上平均移动70公里，其他家族只移动30公里。</p>
</li>
<li><p><img src="/uploads/clanWar/skaven.png" width="100" height="100/"><strong>鼠人族(Skaven)</strong>:    更强的生育能力。鼠人人均生育率=2.1。其他家族=2.0。</p>
</li>
<li><p><img src="/uploads/clanWar/playboy.png" width="100" height="100/"><strong>花花公子家族(Playboy)</strong>:    对婚姻不忠诚，专门勾引有妇之夫（别人老婆怀的是他的孩子！）。其他家族婚姻忠诚度50，诱惑能力20。花花公子忠诚度45，诱惑能力25。</p>
</li>
<li><p><img src="/uploads/clanWar/barbarian.png" width="100" height="100/"><strong>兽人族(Barbarian)</strong>:    对配偶颜值没有任何要求，再丑都无所谓。其他家族男性成员只接受他们社交范围内最漂亮女生的表白，兽人会接受任（饥）何（不）妹（择）纸（食）的表白。</p>
</li>
<li><p><img src="/uploads/clanWar/nobody.png" width="100" height="100/"><strong>白板族(Nobody)</strong>:    苦逼的白板，没有任何特殊能力，人艰不拆。</p>
</li>
</ul>
<p>300年后人口最多的种族成为世界的霸主！最后的胜利者只有一个，会是哪个种族呢？</p>
<h3 id="代码设计"><a href="#代码设计" class="headerlink" title="代码设计"></a>代码设计</h3><p>设计类的基本原则：</p>
<ul>
<li>最小化代码冗余</li>
<li>松耦合模块化，降低维护难度</li>
<li>运用虚拟工厂设计模式，对用户隐藏不同氏族成员实例化的细节。</li>
<li>提高扩展性，尤其是将来扩展更多的种族，甚至允许玩家自己设计扩展种族参与乱斗。</li>
<li>集中游戏的参数，方便初始化游戏</li>
<li>实践Think in Java中谨慎的访问权限风格，私有参数，私有构造函数，公开方法，包内权限类。</li>
</ul>
<h4 id="人类（Human-java）"><a href="#人类（Human-java）" class="headerlink" title="人类（Human.java）"></a>人类（Human.java）</h4><p><img src="/uploads/clanWar/human.jpg" alt="result"><br>是最基本的游戏单位。包含每个个体的基本参数和行为方法。最主要的有恋爱系统girlFlirt()，loveMe()，出轨系统havingAffair()，寿命系统randomDeath()，人物移动系统move()等等。另外还提供两种工厂方法接口：</p>
<ul>
<li>开放性的万能工厂createNewMan()，方便其他类灵活地定制人类实例。</li>
<li>封闭的特殊工厂babyBirth()，婴儿所有参数根据其父母参数随机产生，用户无法控制参数。</li>
</ul>
<h4 id="氏族（Clan-java）"><a href="#氏族（Clan-java）" class="headerlink" title="氏族（Clan.java）"></a>氏族（Clan.java）</h4><p><img src="/uploads/clanWar/clan_1.jpg" alt="result"><br>是人类的虚拟工厂(abstract factory)类。主要包含生产标准人类的各种必要参数，以及工厂方法ClanMemberFactory()，专门用来生产人类的实例。chargeClan()方法调用ClanMemberFactory()方法批量生产氏族成员。氏族类作为基类提供了一个白板人类的标准模板(白板族的工厂类Nobody.java就是直接继承Clan.java，没有做任何改动)，等待其子类具体各个不同的氏族进一步异化人类实例。</p>
<h4 id="七大种族"><a href="#七大种族" class="headerlink" title="七大种族"></a>七大种族</h4><p><img src="/uploads/clanWar/world.png" alt="result"><br>（ClanRose.java, ClanBanker.java, ClanRanger.java, ClanSkaven.java, ClanPlayboy.java, ClanBarbarian.java, ClanNobody.java）继承Clan.java。但分别包含每个氏族的特殊参数。Clan只是个虚拟工厂，并不直接生产人类实例。而是将实例化的过程推迟到了其子类各个具体的氏族来完成。生产出人类实例自带此氏族特殊能力。但因为多态性，对用户而言，不需要关心底层哪怕是100个氏族具体是什么，调用的始终是Clan类的chargeClan()方法，但多态性确保每次都会调用某个种族特有的chargeClan()方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Clan theClan=Clan.createTheClan(clanName);</span><br><span class="line">theClan.chargeClan(memberNum,world);</span><br></pre></td></tr></table></figure></p>
<p>虚拟工厂这样与底层无关，低依赖，松耦合的特性，非常有利于代码的扩展，哪怕将来氏族数量从7个扩展到100个，也完全不用修改客户端的代码。</p>
<h4 id="大陆（TheWorld-java）"><a href="#大陆（TheWorld-java）" class="headerlink" title="大陆（TheWorld.java）"></a>大陆（TheWorld.java）</h4><p>包含世界的一些基本设定参数，以及两个人类的容器：ArrayList<human> humanList和ArrayList<human> heaven，分别包含所有活着的和死去的人类。TheWorld类最主要的两个方法：passOneYear()和spring()，来推动历史的发展，人类的生老病死。</human></human></p>
<h4 id="氏族战争（WarOfClan-java）"><a href="#氏族战争（WarOfClan-java）" class="headerlink" title="氏族战争（WarOfClan.java）"></a>氏族战争（WarOfClan.java）</h4><p>是游戏的主程序。runTheGame()方法首先创建一个TheWorld实例，然后调用Clan工厂在世界中创造人类实例。然后再调用世界的passOneYear()方法，完成推演。其中，还包括一个统计方法collectResult()用来统计每一年世界人口的分布。</p>
<h4 id="图形板（GraphPanel-java）"><a href="#图形板（GraphPanel-java）" class="headerlink" title="图形板（GraphPanel.java）"></a>图形板（GraphPanel.java）</h4><p>负责把统计结果，以曲线图的形式直观地显示出来。利用了awt和swing库。</p>
<h3 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h3><p>实验初始设置如下：</p>
<ul>
<li>世界大小：1000*1000</li>
<li>初始人口密度：每个种族1000人</li>
<li>平均生育率：2</li>
</ul>
<p><img src="/uploads/clanWar/result_1.png" alt="result"></p>
<p>没想到人类在300年不到就灭亡了，这里平均生育率是个很敏感的值，一旦超过2，人口就会爆炸，低于2就会以非常快的速度灭亡。</p>
<p>最后的胜利者是花花公子家族！抢别人老婆的技能变相提高了生育率，果然生育率才是王道！但其实我只是稍微把他的诱惑值提高了5点。普通家族平均50点，他才55点，也不知道这区区5点为什么效果这么好。</p>
<p>第二名的优势家族竟然是兽族，看来在这个世界，不能太挑，再丑的妹子也是妹子啊！现在剩男剩女这么多，天天非诚勿扰，大妈满大街替儿子约会，就是要求太高，太挑了嘛。</p>
<p>最出乎意料的是高颜值的玫瑰家族，竟然垫底了！从结果上看，也就刚开始的几年他稍微领先，他优先把最漂亮的妹子选走了，但后来其他种族也都和颜值一般的姑娘结婚了，所以其实高颜值族没什么优势。但娶高颜值老婆却有一个明显的副作用：潘金莲！玫瑰家族净帮别人养娃了！同样的悲剧也发生在银行家和巡游者的身上，这证明在小三面前颜值，金钱，知识，努力，一切都是浮云！</p>
<p>最后一个比较特殊的鼠人！其实他才是隐藏的大Boss。刚开始天真的我是把他的生育率设成3的。然后我就发现他的人口爆炸了！100年之后，电脑都跑不动了！！！哪怕我只是稍微把鼠人的生育率调到2.5，也就是50%的雄性鼠人繁殖3个后代，50%还是繁殖2个后代。在去掉花花公子家族抢老婆的效果以后，150年后的霸主就是鼠人族！</p>
<p><img src="/uploads/clanWar/result_2.png" alt="result"></p>
<p>当然如果再加上花花公子大Boss的话，结果就变成了这样，鼠人也只有替人打工的命。小三技能果然逆天。</p>
<p><img src="/uploads/clanWar/result_3.png" alt="result"></p>
<p>所以这个实验告诉我们，优生优育什么的都是鬼扯！培养两个哈佛法学院博士不如实实在在生3个娃。现代社会推行普世价值，每个人生存的权利都被充分地尊重，高智商，高颜值已经不能为个人赢得生存的优势，反而降低了他们的生殖意愿。广大的劳动人民不要气馁，社会精英们其实都在为你们的后代打工。ISIS其实也不用再搞什么恐怖袭击，伤害到花花草草多不好。只要接着一窝一窝地生（我一个伊斯兰国家的兄弟，老妈生了17个娃），再来几波难民潮，欧洲直接就是你们的了。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><h4 id="人类（Human-java）-1"><a href="#人类（Human-java）-1" class="headerlink" title="人类（Human.java）"></a>人类（Human.java）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  The unit in the WarOfClan</span><br><span class="line"> *  Human class provide a simple model of human. (features and constructor)</span><br><span class="line"> *  <span class="doctag">@author</span> wei.shen<span class="doctag">@iro</span>.umontreal.ca</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.clanWar;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.Math.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  Only package access to this class</span><br><span class="line"> *  players do not need to know the details</span><br><span class="line"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  public access to the private fields</span><br><span class="line">     *  we cannot change these parameter, but only to show their value</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.name;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.age;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> SEX <span class="title">getSex</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.sex;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getClanName</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.clanName;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Human <span class="title">getSpouse</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.spouse;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] getPosition()&#123;<span class="keyword">return</span> <span class="keyword">this</span>.position;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBeauty</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.beauty;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMoney</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.money;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAlive</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.alive;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAvgLife</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.avgLife;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">isBornAt</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.bornAt;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">isDeadAt</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.deadAt;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRange</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.range;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getView</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.view;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMonyAbility</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.moneyAbility;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBabyNum</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.babyNum;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBabyAbility</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.babyAbility;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getChildFather</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.childFather;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">geLoyalty</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.loyalty;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getFlirt</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.flirt;&#125;</span><br><span class="line">    <span class="comment">//check spouse before marriage</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasSpouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.spouse==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  some special accesses to adjust some arguments</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addAge</span><span class="params">(<span class="keyword">int</span> age)</span></span>&#123;<span class="keyword">this</span>.age+=age;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toDeath</span><span class="params">()</span></span>&#123;<span class="keyword">this</span>.alive=<span class="keyword">false</span>;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">earnMoney</span><span class="params">(<span class="keyword">int</span> earn)</span></span>&#123;<span class="keyword">this</span>.money+=earn;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lostMoney</span><span class="params">(<span class="keyword">int</span> lost)</span></span>&#123;<span class="keyword">this</span>.money-=lost;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bornAt</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;<span class="keyword">this</span>.bornAt=year;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deadAt</span><span class="params">(<span class="keyword">int</span> year)</span></span>&#123;<span class="keyword">this</span>.deadAt=year;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changeView</span><span class="params">(<span class="keyword">int</span> view)</span></span>&#123;<span class="keyword">this</span>.view=view;&#125;</span><br><span class="line">    <span class="comment">//human beauty system</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">growth</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.beauty+=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.beauty&gt;<span class="number">100</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.beauty=<span class="number">100</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fading</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.beauty-=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.beauty&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.beauty=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Two different Human constructors</span><br><span class="line">     *  based on the private universal constructor</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//A closed proxy for a particular purpose</span></span><br><span class="line">    <span class="comment">//mother give birth with random sex, random name</span></span><br><span class="line">    <span class="comment">//baby inherit mothers avgLife and fathers clanName, beauty, range and moneyAbility</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Human <span class="title">babyBirth</span><span class="params">(TheWorld world)</span></span>&#123;</span><br><span class="line">        Random myRander=<span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> x=myRander.nextInt(world.getWidth());</span><br><span class="line">        <span class="keyword">int</span> y=myRander.nextInt(world.getHeight());</span><br><span class="line">        <span class="keyword">int</span>[] babyPosition=&#123;x,y&#125;;</span><br><span class="line">        <span class="keyword">int</span> babyBeauty=<span class="keyword">this</span>.getSpouse().beauty;</span><br><span class="line">        <span class="comment">//int babyBeauty=(this.beauty+this.getSpouse().beauty)/2;</span></span><br><span class="line">        <span class="keyword">int</span> babyRange=<span class="keyword">this</span>.getSpouse().range;</span><br><span class="line">        <span class="keyword">int</span> babyView=<span class="keyword">this</span>.getSpouse().view;</span><br><span class="line">        <span class="keyword">int</span> babyMoneyAbility=<span class="keyword">this</span>.getSpouse().moneyAbility;</span><br><span class="line">        <span class="keyword">int</span> babyBabyAbility=<span class="keyword">this</span>.getSpouse().babyAbility;</span><br><span class="line">        Human newBaby = <span class="keyword">new</span> Human(Name.randomName(), <span class="keyword">this</span>.childFather, <span class="number">0</span>, SEX.randomSex(), babyPosition, babyBeauty, <span class="number">0</span>, <span class="keyword">true</span>, <span class="keyword">this</span>.avgLife, world.getYear(), <span class="number">0</span>, babyRange, babyView, babyMoneyAbility, <span class="number">0</span>, babyBabyAbility, <span class="keyword">null</span>, <span class="keyword">this</span>.spouse.loyalty, <span class="keyword">this</span>.spouse.flirt);</span><br><span class="line">        <span class="keyword">this</span>.babyNum-=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> newBaby;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//A highly flexible proxy of private construcor</span></span><br><span class="line">    <span class="comment">//each clan generate their new members with their features</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Human <span class="title">createNewMan</span><span class="params">(String inputName, String inputClanName, <span class="keyword">int</span> inputAge, SEX inputSex, <span class="keyword">int</span>[] inputPosition, <span class="keyword">int</span> inputBeauty, <span class="keyword">int</span> inputMoney, <span class="keyword">boolean</span> inputAlive, <span class="keyword">int</span> inputAvgLife, <span class="keyword">int</span> inputBorn, <span class="keyword">int</span> inputDeath, <span class="keyword">int</span> inputRange, <span class="keyword">int</span> inputView, <span class="keyword">int</span> inputAbility, <span class="keyword">int</span> inputBabyNum, <span class="keyword">int</span> inputBabyAbility, String inputChildFather, <span class="keyword">int</span> inputLoyalty, <span class="keyword">int</span> inputFlirt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Human(inputName, inputClanName, inputAge, inputSex, inputPosition, inputBeauty, inputMoney, inputAlive, inputAvgLife, inputBorn, inputDeath, inputRange, inputView, inputAbility, inputBabyNum, inputBabyAbility, inputChildFather, inputLoyalty, inputFlirt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  lifetime system</span><br><span class="line">     *  with different mortality rate</span><br><span class="line">     *  older people has more chance to die</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">randomDeath</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> toDeath=<span class="keyword">false</span>;</span><br><span class="line">        Random deathRander=<span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">if</span>(age&gt;(avgLife-<span class="number">20</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> deathSeed=deathRander.nextInt(<span class="number">200</span>);</span><br><span class="line">            <span class="keyword">if</span>(deathSeed==<span class="number">0</span>)&#123;</span><br><span class="line">                toDeath=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(age&gt;(avgLife-<span class="number">10</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> deathSeed=deathRander.nextInt(<span class="number">200</span>);</span><br><span class="line">            <span class="keyword">if</span>(deathSeed==<span class="number">0</span>)&#123;</span><br><span class="line">                toDeath=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(age&gt;(avgLife))&#123;</span><br><span class="line">            <span class="keyword">int</span> deathSeed=deathRander.nextInt(<span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span>(deathSeed==<span class="number">0</span>)&#123;</span><br><span class="line">                toDeath=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(age&gt;(avgLife+<span class="number">10</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> deathSeed=deathRander.nextInt(<span class="number">50</span>);</span><br><span class="line">            <span class="keyword">if</span>(deathSeed==<span class="number">0</span>)&#123;</span><br><span class="line">                toDeath=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(age&gt;(avgLife+<span class="number">20</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> deathSeed=deathRander.nextInt(<span class="number">35</span>);</span><br><span class="line">            <span class="keyword">if</span>(deathSeed==<span class="number">0</span>)&#123;</span><br><span class="line">                toDeath=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(age&gt;(avgLife+<span class="number">30</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> deathSeed=deathRander.nextInt(<span class="number">15</span>);</span><br><span class="line">            <span class="keyword">if</span>(deathSeed==<span class="number">0</span>)&#123;</span><br><span class="line">                toDeath=<span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> toDeath;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  flirt system</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">girlFlirt</span><span class="params">(TheWorld world)</span></span>&#123;</span><br><span class="line">        Human beautifulOne=<span class="keyword">null</span>;</span><br><span class="line">        Human richOne=<span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//girl chose the most beautiful one and the richest one in her range.</span></span><br><span class="line">        <span class="keyword">for</span>(Iterator&lt;Human&gt; it=world.getHumanList().iterator();it.hasNext();)&#123;</span><br><span class="line">            Human hm=it.next();</span><br><span class="line">            <span class="comment">//single man, adult, in her range</span></span><br><span class="line">            <span class="keyword">if</span>(hm.sex.equals(SEX.MALE) &amp;&amp; hm.age&gt;=<span class="number">18</span> &amp;&amp; <span class="keyword">this</span>.inTheView(hm) &amp;&amp; !hm.hasSpouse())&#123;</span><br><span class="line">                <span class="comment">//chose the beautiful one</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(beautifulOne!=<span class="keyword">null</span> &amp;&amp; hm.getBeauty()&gt;beautifulOne.getBeauty())&#123;</span><br><span class="line">                        beautifulOne=hm;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(beautifulOne==<span class="keyword">null</span>)&#123;</span><br><span class="line">                        beautifulOne=hm;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//chose the rich one</span></span><br><span class="line">                <span class="keyword">if</span>(richOne!=<span class="keyword">null</span> &amp;&amp; hm.getMoney()&gt;richOne.getMoney())&#123;</span><br><span class="line">                    richOne=hm;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(richOne==<span class="keyword">null</span>)&#123;</span><br><span class="line">                    richOne=hm;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//System.out.println("@@@"+beauifulOne);</span></span><br><span class="line">        <span class="comment">//System.out.println("$$$"+richOne);</span></span><br><span class="line">        <span class="comment">//girl prefert the richest one than the beautiful one</span></span><br><span class="line">        <span class="keyword">if</span>(richOne!=<span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.payMe(richOne,world))&#123;</span><br><span class="line">            richOne.marriage(<span class="keyword">this</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(beautifulOne!=<span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.loveMe(beautifulOne,world))&#123;</span><br><span class="line">            beautifulOne.marriage(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//the boy answer the girl</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">payMe</span><span class="params">(Human boy, TheWorld world)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.loveMe(boy,world))&#123;</span><br><span class="line">            <span class="comment">//how much</span></span><br><span class="line">            <span class="keyword">int</span> price=<span class="keyword">this</span>.beauty*<span class="number">10</span>;</span><br><span class="line">            <span class="comment">//if the boy has enough money</span></span><br><span class="line">            <span class="keyword">if</span>(boy.money&gt;=price)&#123;</span><br><span class="line">                boy.money-=price;</span><br><span class="line">                <span class="keyword">this</span>.money+=price;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//he will chose the most beautiful girl in his range whose beauty is lower than him</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">loveMe</span><span class="params">(Human boy, TheWorld world)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bestBeauty=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(Iterator&lt;Human&gt; it=world.getHumanList().iterator();it.hasNext();)&#123;</span><br><span class="line">            Human hf=it.next();</span><br><span class="line">            <span class="keyword">if</span>(hf.sex.equals(SEX.FEMALE) &amp;&amp; boy.inTheView(hf) &amp;&amp; hf.beauty&lt;boy.beauty)&#123;</span><br><span class="line">                <span class="keyword">if</span>(hf.beauty&gt;bestBeauty)&#123;</span><br><span class="line">                    bestBeauty=hf.beauty;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(bestBeauty&lt;=<span class="keyword">this</span>.beauty)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//marriaged women looking for playboys</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">havingAffair</span><span class="params">(TheWorld world)</span></span>&#123;</span><br><span class="line">        Human lover=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">for</span>(Iterator&lt;Human&gt; it=world.getHumanList().iterator();it.hasNext();)&#123;</span><br><span class="line">            Human hm=it.next();</span><br><span class="line">            <span class="keyword">if</span>(hm.sex.equals(SEX.MALE) &amp;&amp; hm.age&gt;=<span class="number">18</span> &amp;&amp; <span class="keyword">this</span>.inTheView(hm))&#123;</span><br><span class="line">                <span class="keyword">if</span>(lover==<span class="keyword">null</span>)&#123;</span><br><span class="line">                    lover=hm;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(hm.flirt&gt;lover.flirt)&#123;</span><br><span class="line">                    lover=hm;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//more beaufiful the women are, easier to betray</span></span><br><span class="line">        <span class="keyword">int</span> loyalty=<span class="keyword">this</span>.loyalty+<span class="keyword">this</span>.spouse.loyalty-<span class="keyword">this</span>.beauty;</span><br><span class="line">        <span class="keyword">if</span>(lover!=<span class="keyword">null</span> &amp;&amp; lover.flirt&gt;loyalty)&#123;</span><br><span class="line">            <span class="keyword">this</span>.childFather=lover.clanName;</span><br><span class="line">            <span class="comment">//System.out.println(this.name+" flirted!!!!");</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">inTheView</span><span class="params">(Human another)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> distance=Math.sqrt(Math.pow(<span class="keyword">this</span>.position[<span class="number">0</span>]-another.position[<span class="number">0</span>],<span class="number">2</span>)+Math.pow(<span class="keyword">this</span>.position[<span class="number">1</span>]-another.position[<span class="number">1</span>],<span class="number">2</span>));</span><br><span class="line">        <span class="keyword">if</span>(distance&lt;=(<span class="keyword">double</span>)<span class="keyword">this</span>.view)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//marriage</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">marriage</span><span class="params">(Human girl)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.hasSpouse() &amp;&amp; !girl.hasSpouse())&#123;</span><br><span class="line">            <span class="keyword">this</span>.spouse=girl;</span><br><span class="line">            girl.spouse=<span class="keyword">this</span>;</span><br><span class="line">            girl.clanName=<span class="keyword">this</span>.clanName;</span><br><span class="line">            girl.position=<span class="keyword">this</span>.position;</span><br><span class="line">            girl.childFather=<span class="keyword">this</span>.clanName;</span><br><span class="line">            <span class="comment">//the baby number depends on the father</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.age&lt;<span class="number">50</span>)&#123;</span><br><span class="line">                Random babyRander=<span class="keyword">new</span> Random();</span><br><span class="line">                <span class="keyword">int</span> babyIndice=babyRander.nextInt(<span class="number">2</span>);</span><br><span class="line">                <span class="keyword">switch</span>(babyIndice)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                        Math.max(<span class="number">0</span>,girl.babyNum=<span class="keyword">this</span>.babyAbility-<span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                        girl.babyNum=<span class="keyword">this</span>.babyAbility+<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"Warning! They have already spouse, they can not marry each other!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//single MALE random move in the world (&gt;15 years old)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span><span class="params">(TheWorld world)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.sex.equals(SEX.MALE) &amp;&amp; <span class="keyword">this</span>.age&gt;<span class="number">15</span> &amp;&amp; !<span class="keyword">this</span>.hasSpouse())&#123;</span><br><span class="line">            Random myRander=<span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> distance=myRander.nextInt(<span class="keyword">this</span>.range+<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">int</span> direction=myRander.nextInt(<span class="number">4</span>);</span><br><span class="line">            <span class="keyword">switch</span>(direction)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">0</span>]+=distance;</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">1</span>]+=distance;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">0</span>]&gt;world.getWidth())&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">0</span>]=<span class="keyword">this</span>.position[<span class="number">0</span>]%world.getWidth();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">1</span>]&gt;world.getHeight())&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">1</span>]=<span class="keyword">this</span>.position[<span class="number">1</span>]%world.getHeight();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">0</span>]+=distance;</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">1</span>]-=distance;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">0</span>]&gt;world.getWidth())&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">0</span>]=<span class="keyword">this</span>.position[<span class="number">0</span>]%world.getWidth();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">1</span>]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">1</span>]=<span class="keyword">this</span>.position[<span class="number">1</span>]+world.getHeight();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">0</span>]-=distance;</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">1</span>]+=distance;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">0</span>]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">0</span>]=<span class="keyword">this</span>.position[<span class="number">0</span>]+world.getWidth();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">1</span>]&gt;world.getHeight())&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">1</span>]=<span class="keyword">this</span>.position[<span class="number">1</span>]%world.getHeight();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">0</span>]-=distance;</span><br><span class="line">                    <span class="keyword">this</span>.position[<span class="number">1</span>]-=distance;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">0</span>]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">0</span>]=<span class="keyword">this</span>.position[<span class="number">0</span>]+world.getWidth();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="keyword">this</span>.position[<span class="number">1</span>]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="keyword">this</span>.position[<span class="number">1</span>]=<span class="keyword">this</span>.position[<span class="number">1</span>]+world.getHeight();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  money system</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">earnMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//only audult MALE can earn money</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.sex.equals(SEX.MALE) &amp;&amp; <span class="keyword">this</span>.age&gt;=<span class="number">18</span>)&#123;</span><br><span class="line">            Random moneyRander=<span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> indice=moneyRander.nextInt(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">int</span> bonus=moneyRander.nextInt(<span class="keyword">this</span>.moneyAbility*<span class="number">3</span>);</span><br><span class="line">            <span class="comment">//salary=moneyAbility+random bonus</span></span><br><span class="line">            <span class="keyword">switch</span>(indice)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">this</span>.money=<span class="keyword">this</span>.money+(<span class="keyword">this</span>.moneyAbility/<span class="number">4</span>)+bonus; <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">this</span>.money=Math.max(<span class="number">0</span>,<span class="keyword">this</span>.money+(<span class="keyword">this</span>.moneyAbility/<span class="number">4</span>)-bonus); <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//print</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String outPut=<span class="string">"["</span>+<span class="keyword">this</span>.clanName+<span class="string">"]"</span>+<span class="keyword">this</span>.sex.name()+<span class="string">": "</span>+<span class="keyword">this</span>.name;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.alive==<span class="keyword">false</span>)&#123;</span><br><span class="line">            outPut=outPut+<span class="string">"("</span>+Integer.toString(<span class="keyword">this</span>.isBornAt())+<span class="string">"-"</span>+Integer.toString(<span class="keyword">this</span>.isDeadAt())+<span class="string">")"</span>+<span class="string">", dead at "</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            outPut=outPut+<span class="string">"("</span>+Integer.toString(<span class="keyword">this</span>.isBornAt())+<span class="string">"-?)"</span>+<span class="string">", is now "</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        outPut=outPut+Integer.toString(<span class="keyword">this</span>.age)+<span class="string">" years old."</span>+<span class="string">" [Beauty: "</span>+Integer.toString(<span class="keyword">this</span>.beauty)+<span class="string">"]"</span>+<span class="string">" [Position: "</span>+Integer.toString(<span class="keyword">this</span>.position[<span class="number">0</span>])+<span class="string">":"</span>+Integer.toString(<span class="keyword">this</span>.position[<span class="number">1</span>])+<span class="string">"]"</span>+<span class="string">" [Money: "</span>+Integer.toString(<span class="keyword">this</span>.money)+<span class="string">"]"</span>+<span class="string">" [Loyalty: "</span>+Integer.toString(<span class="keyword">this</span>.loyalty)+<span class="string">"]"</span>+<span class="string">" [Flirt: "</span>+Integer.toString(<span class="keyword">this</span>.flirt)+<span class="string">"]"</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.hasSpouse())&#123;</span><br><span class="line">            outPut=outPut+<span class="string">" (Spouse: "</span>+<span class="keyword">this</span>.spouse.getName()+<span class="string">" "</span>+<span class="keyword">this</span>.spouse.clanName+<span class="string">")"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> outPut;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  simplest private constructor</span><br><span class="line">     *  the other users can not use it.</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Human</span><span class="params">(String inputName, String inputClanName, <span class="keyword">int</span> inputAge, SEX inputSex, <span class="keyword">int</span>[] inputPosition, <span class="keyword">int</span> inputBeauty, <span class="keyword">int</span> inputMoney, <span class="keyword">boolean</span> inputAlive, <span class="keyword">int</span> inputAvgLife, <span class="keyword">int</span> inputBorn, <span class="keyword">int</span> inputDeath, <span class="keyword">int</span> inputRange, <span class="keyword">int</span> inputView, <span class="keyword">int</span> inputAbility, <span class="keyword">int</span> inputBabyNum, <span class="keyword">int</span> inputBabyAbility, String inputChildFather, <span class="keyword">int</span> inputLoyalty, <span class="keyword">int</span> inputFlirt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=inputName;</span><br><span class="line">        <span class="keyword">this</span>.clanName=inputClanName;</span><br><span class="line">        <span class="keyword">this</span>.age=inputAge;</span><br><span class="line">        <span class="keyword">this</span>.sex=inputSex;</span><br><span class="line">        <span class="keyword">this</span>.position=inputPosition;</span><br><span class="line">        <span class="keyword">this</span>.beauty=inputBeauty;</span><br><span class="line">        <span class="keyword">this</span>.money=inputMoney;</span><br><span class="line">        <span class="keyword">this</span>.alive=inputAlive;</span><br><span class="line">        <span class="keyword">this</span>.avgLife=inputAvgLife;</span><br><span class="line">        <span class="keyword">this</span>.bornAt=inputBorn;</span><br><span class="line">        <span class="keyword">this</span>.deadAt=inputDeath;</span><br><span class="line">        <span class="keyword">this</span>.range=inputRange;</span><br><span class="line">        <span class="keyword">this</span>.view=inputView;</span><br><span class="line">        <span class="keyword">this</span>.moneyAbility=inputAbility;</span><br><span class="line">        <span class="keyword">this</span>.babyNum=inputBabyNum;</span><br><span class="line">        <span class="keyword">this</span>.babyAbility=inputBabyAbility;</span><br><span class="line">        <span class="keyword">this</span>.childFather=inputChildFather;</span><br><span class="line">        <span class="keyword">this</span>.loyalty=inputLoyalty;</span><br><span class="line">        <span class="keyword">this</span>.flirt=inputFlirt;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Human</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  private fields</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//person arguments</span></span><br><span class="line">    <span class="keyword">private</span> String name=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> SEX sex=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> Human spouse=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] position=&#123;<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> beauty=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> alive=<span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> bornAt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> deadAt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> babyNum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> String childFather=<span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//clan arguments</span></span><br><span class="line">    <span class="keyword">private</span> String clanName=<span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> range=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> view=<span class="number">0</span>; <span class="comment">//</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> avgLife=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> money=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> moneyAbility=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> babyAbility=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> loyalty=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> flirt=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  MAIN</span><br><span class="line">     *  to test the method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="氏族（Clan-java）-1"><a href="#氏族（Clan-java）-1" class="headerlink" title="氏族（Clan.java）"></a>氏族（Clan.java）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  Clan.java is a abstract factory of human.</span><br><span class="line"> *  Asign to human some basic capabilities.</span><br><span class="line"> *  7 clans are pre-built</span><br><span class="line"> *      -&gt;1.Rose:       high beauty</span><br><span class="line"> *      -&gt;2.Banker:     rich</span><br><span class="line"> *      -&gt;3.Ranger:     love travel</span><br><span class="line"> *      -&gt;4.Skaven:     higher birth rate</span><br><span class="line"> *      -&gt;5.Playboy:    flirt married women</span><br><span class="line"> *      -&gt;6.Barbarian:  don't care ugly women</span><br><span class="line"> *      -&gt;7.Nobody:     no extra skill</span><br><span class="line"> *  <span class="doctag">@author</span> wei.shen<span class="doctag">@iro</span>.umontreal.ca</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.clanWar;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  -&gt;All the methods are realized</span><br><span class="line"> *  -&gt;All the clans will inherit the same method to  genetate their members</span><br><span class="line"> *  -&gt;Also package access</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Clan</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  STATIC FIELDS</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;String&gt; CLAN_NAMES=<span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  CONSTRUCTOR: static initialisation block</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Rose"</span>);</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Banker"</span>);</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Ranger"</span>);</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Skaven"</span>);</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Playboy"</span>);</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Barbarian"</span>);</span><br><span class="line">        CLAN_NAMES.add(<span class="string">"Nobody"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  STATIC PROXY OF CONSTRUCTOR</span><br><span class="line">     *  the only public factory method to create clan by their name</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Clan <span class="title">createTheClan</span><span class="params">(String clanName)</span></span>&#123;</span><br><span class="line">        Clan theClan=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span>(clanName)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Rose"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanRose(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Banker"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanBanker(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Ranger"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanRanger(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Skaven"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanSkaven(<span class="number">1</span>); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Playboy"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanPlayboy(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Barbarian"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanBarbarian(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"Nobody"</span>:</span><br><span class="line">                theClan = <span class="keyword">new</span> ClanNobody(); <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> theClan;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  The only public access to Human Facorty to creat humans (different clan members)</span><br><span class="line">     *  World charge clans, and clan create humans</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//use the factory method clanMemberFactory() to decorate humans and insert them to this world</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">chargeClan</span><span class="params">(<span class="keyword">int</span> number, TheWorld world)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;number; i++)&#123;</span><br><span class="line">            Human XMan=<span class="keyword">this</span>.clanMemberFactory(world);</span><br><span class="line">            XMan.bornAt(world.getYear());</span><br><span class="line">            world.getHumanList().add(XMan);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Clan "</span>+clanName+<span class="string">" are charged!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  package access tool methods</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//builder method to adjust clan's default parameters before calling human factory method to creat humans</span></span><br><span class="line">    <span class="function">Clan <span class="title">setAverageBeauty</span><span class="params">(<span class="keyword">int</span> averageBeauty)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.averageBeauty=averageBeauty;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Clan <span class="title">setBeautyFloat</span><span class="params">(<span class="keyword">int</span> beautyFloat)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.beautyFloat=beautyFloat;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Clan <span class="title">setMoney</span><span class="params">(<span class="keyword">int</span> money)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.money=money;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Clan <span class="title">setMoneyAbility</span><span class="params">(<span class="keyword">int</span> moneyAbility)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.moneyAbility=moneyAbility;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setClanAvgLife</span><span class="params">(<span class="keyword">int</span> clanAvgLife)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.clanAvgLife=clanAvgLife;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setInitialRange</span><span class="params">(<span class="keyword">int</span> initialRange)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.initialRange=initialRange;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setInitialView</span><span class="params">(<span class="keyword">int</span> initialView)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.initialView=initialView;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setBabyAbility</span><span class="params">(<span class="keyword">int</span> babyAbility)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.babyAbility=babyAbility;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setInitialLoyalty</span><span class="params">(<span class="keyword">int</span> initialLoyalty)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.initialLoyalty=initialLoyalty;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setLoyaltyFloat</span><span class="params">(<span class="keyword">int</span> loyaltyFloat)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.loyaltyFloat=loyaltyFloat;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setInitialFlirt</span><span class="params">(<span class="keyword">int</span> initialFlirt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.initialFlirt=initialFlirt;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setFlirtFloat</span><span class="params">(<span class="keyword">int</span> flirtFloat)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.flirtFloat=flirtFloat;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">Clan <span class="title">setClanName</span><span class="params">(String clanName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.clanName=clanName;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//The factory method of human with different characteristics</span></span><br><span class="line">    <span class="function">Human <span class="title">clanMemberFactory</span><span class="params">(TheWorld world)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Human.createNewMan(Name.randomName(), <span class="keyword">this</span>.clanName, <span class="number">0</span>, SEX.randomSex(), randomPosition(world.getWidth(),world.getHeight()), randomBeauty(<span class="keyword">this</span>.beautyFloat), <span class="keyword">this</span>.money, <span class="keyword">true</span>, <span class="keyword">this</span>.clanAvgLife, world.getYear(), <span class="number">0</span>, <span class="keyword">this</span>.initialRange, <span class="keyword">this</span>.initialView, <span class="keyword">this</span>.moneyAbility, <span class="number">0</span>, <span class="keyword">this</span>.babyAbility, <span class="keyword">null</span>, randomLoyalty(<span class="keyword">this</span>.loyaltyFloat), <span class="keyword">this</span>.randomFlirt(<span class="keyword">this</span>.flirtFloat));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//get a random beauty acording to the average beauty</span></span><br><span class="line">    <span class="comment">//we can set the floating range</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">randomBeauty</span><span class="params">(<span class="keyword">int</span> floatingBeauty)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> beauty=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//more or less beauty?</span></span><br><span class="line">        Random myRander = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> luck=myRander.nextInt(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">int</span> offset=myRander.nextInt(floatingBeauty+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">switch</span> (luck)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: beauty=Math.max(<span class="number">0</span>,<span class="keyword">this</span>.averageBeauty-offset); <span class="keyword">break</span>;  <span class="comment">//ugly</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: beauty=Math.min(<span class="number">100</span>,<span class="keyword">this</span>.averageBeauty+offset); <span class="keyword">break</span>;  <span class="comment">//beautiful</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> beauty;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//give each person a random position</span></span><br><span class="line">    <span class="keyword">int</span>[] randomPosition(<span class="keyword">int</span> height, <span class="keyword">int</span> width)&#123;</span><br><span class="line">        Random myRander = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> x=myRander.nextInt(width+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> y=myRander.nextInt(height+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span>[] position = &#123;x,y&#125;;</span><br><span class="line">        <span class="keyword">return</span> position;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//give each person a random flirt value</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">randomFlirt</span><span class="params">(<span class="keyword">int</span> flirtFloat)</span></span>&#123;</span><br><span class="line">        Random flirtRander=<span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> floatFlirt=flirtRander.nextInt(flirtFloat+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> Math.min(<span class="number">100</span>,<span class="keyword">this</span>.initialFlirt+floatFlirt);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//give each person a random flirt value</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">randomLoyalty</span><span class="params">(<span class="keyword">int</span> loyaltyFloat)</span></span>&#123;</span><br><span class="line">        Random loyaltyRander=<span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> floatLoyalty=loyaltyRander.nextInt(loyaltyFloat+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> Math.min(<span class="number">100</span>,<span class="keyword">this</span>.initialLoyalty+floatLoyalty);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Package access constructor</span><br><span class="line">     *  Need to be inherited in the package</span><br><span class="line">     */</span></span><br><span class="line">    Clan()&#123;&#125;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Package access fields</span><br><span class="line">     *  Need to be inherited in the package</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">int</span> averageBeauty=<span class="number">50</span>;</span><br><span class="line">    <span class="keyword">int</span> beautyFloat=<span class="number">50</span>;</span><br><span class="line">    <span class="keyword">int</span> money=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> moneyAbility=<span class="number">50</span>;</span><br><span class="line">    <span class="keyword">int</span> clanAvgLife=<span class="number">60</span>;</span><br><span class="line">    <span class="keyword">int</span> initialRange=<span class="number">20</span>;</span><br><span class="line">    <span class="keyword">int</span> initialView=<span class="number">50</span>;</span><br><span class="line">    <span class="keyword">int</span> babyAbility=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> initialLoyalty=<span class="number">40</span>;</span><br><span class="line">    <span class="keyword">int</span> loyaltyFloat=<span class="number">20</span>;</span><br><span class="line">    <span class="keyword">int</span> initialFlirt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flirtFloat=<span class="number">40</span>;</span><br><span class="line">    String clanName=<span class="string">"Nobody"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="七大种族-1"><a href="#七大种族-1" class="headerlink" title="七大种族"></a>七大种族</h4><p>ClanRose.java, ClanBanker.java, ClanRanger.java, ClanSkaven.java, ClanPlayboy.java, ClanBarbarian.java, ClanNobody.java</p>
<p>这里只以Rose族为例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  Clan Beautiful is the most beautiful clan in the world.</span><br><span class="line"> *  Each member has 20 beauty points as bonus: Average beauty = 70</span><br><span class="line"> *  <span class="doctag">@author</span> wei.shen<span class="doctag">@iro</span>.umontreal.ca</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.clanWar;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  Only package access</span><br><span class="line"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClanRose</span> <span class="keyword">extends</span> <span class="title">Clan</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  public constructor</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">//default sets</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClanRose</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.clanName=<span class="string">"Rose"</span>;</span><br><span class="line">        <span class="keyword">this</span>.averageBeauty=<span class="number">80</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//special sets</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClanRose</span><span class="params">(<span class="keyword">int</span> beauty)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.clanName=<span class="string">"Rose"</span>;</span><br><span class="line">        <span class="keyword">this</span>.averageBeauty=beauty;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  MAIN</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="大陆（TheWorld-java）-1"><a href="#大陆（TheWorld-java）-1" class="headerlink" title="大陆（TheWorld.java）"></a>大陆（TheWorld.java）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  The clan war take place in this world.</span><br><span class="line"> *  <span class="doctag">@author</span> wei.shen<span class="doctag">@iro</span>.umontreal.ca</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.clanWar;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">//used to control the time pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TheWorld</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  public interface of constructor</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TheWorld <span class="title">createNewWorld</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TheWorld();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TheWorld <span class="title">createNewWorld</span><span class="params">(<span class="keyword">int</span> width, <span class="keyword">int</span> height)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TheWorld(<span class="number">0</span>, width, height);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Calendar system</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">passOneYear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//begin to flirt</span></span><br><span class="line">        <span class="keyword">this</span>.spring();</span><br><span class="line">        <span class="comment">//then pass the rest of the year</span></span><br><span class="line">        <span class="keyword">this</span>.year+=<span class="number">1</span>;</span><br><span class="line">        System.out.print(<span class="keyword">this</span>.year+<span class="string">"    "</span>);</span><br><span class="line">        ArrayList&lt;Human&gt; newBorn=<span class="keyword">new</span> ArrayList&lt;Human&gt;();</span><br><span class="line">        <span class="keyword">for</span>(Iterator&lt;Human&gt; it = <span class="keyword">this</span>.humanList.iterator();it.hasNext();)&#123;</span><br><span class="line">            Human h=it.next();</span><br><span class="line">            <span class="comment">//beauty system</span></span><br><span class="line">            <span class="keyword">if</span>(h.getAge()&gt;<span class="number">15</span> &amp;&amp; h.getAge()&lt;<span class="number">40</span>)&#123;</span><br><span class="line">                h.growth();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(h.getAge()&gt;=<span class="number">40</span>)&#123;</span><br><span class="line">                h.fading();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//money system</span></span><br><span class="line">            h.earnMoney();</span><br><span class="line">            <span class="comment">//mother give birth</span></span><br><span class="line">            <span class="keyword">if</span>(h.getSex().equals(SEX.FEMALE) &amp;&amp; h.getBabyNum()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                Human newBaby=h.babyBirth(<span class="keyword">this</span>);</span><br><span class="line">                newBorn.add(newBaby); <span class="comment">//world is blocked during the iteration</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//age and death system</span></span><br><span class="line">            h.addAge(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(h.randomDeath())&#123;</span><br><span class="line">                h.toDeath();</span><br><span class="line">                h.deadAt(<span class="keyword">this</span>.year);</span><br><span class="line">                <span class="keyword">this</span>.heaven.add(h);</span><br><span class="line">                it.remove();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(Human nh : newBorn)&#123;</span><br><span class="line">            <span class="keyword">this</span>.humanList.add(nh);</span><br><span class="line">            <span class="comment">//System.out.println(h.toString());</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  flirt system</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spring</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Human h : <span class="keyword">this</span>.humanList)&#123;</span><br><span class="line">            <span class="comment">//male move</span></span><br><span class="line">            h.move(<span class="keyword">this</span>);</span><br><span class="line">            <span class="comment">//female flirt</span></span><br><span class="line">            <span class="keyword">if</span>(h.getSex().equals(SEX.FEMALE))&#123;</span><br><span class="line">                <span class="keyword">if</span>(!h.hasSpouse())&#123;</span><br><span class="line">                    h.girlFlirt(<span class="keyword">this</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    h.havingAffair(<span class="keyword">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//allow us to add human to the world</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBaby</span><span class="params">(Human baby)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.humanList.add(baby);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Print the world</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printSurvivors</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Human h : <span class="keyword">this</span>.humanList)&#123;</span><br><span class="line">            System.out.println(h.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printGhosts</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Human h : <span class="keyword">this</span>.heaven)&#123;</span><br><span class="line">            System.out.println(h.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printWorld</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Human h : <span class="keyword">this</span>.humanList)&#123;</span><br><span class="line">            System.out.println(h.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Human h : <span class="keyword">this</span>.heaven)&#123;</span><br><span class="line">            System.out.println(h.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  show arguments</span><br><span class="line">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getYear</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.year;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWidth</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.width;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHeight</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.height;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Human&gt; <span class="title">getHumanList</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.humanList;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList&lt;Human&gt; <span class="title">getHeaven</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="keyword">this</span>.heaven;&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  private constructor</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">TheWorld</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">TheWorld</span><span class="params">(<span class="keyword">int</span> year, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.year=year;</span><br><span class="line">        <span class="keyword">this</span>.width=width;</span><br><span class="line">        <span class="keyword">this</span>.height=height;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  private fields</span><br><span class="line">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> year=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width=<span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> height=<span class="number">1000</span>;</span><br><span class="line">    <span class="comment">//the world is a container of human</span></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Human&gt; humanList=<span class="keyword">new</span> ArrayList&lt;Human&gt;();</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Human&gt; heaven=<span class="keyword">new</span> ArrayList&lt;Human&gt;();</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  MAIN</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="氏族战争（WarOfClan-java）-1"><a href="#氏族战争（WarOfClan-java）-1" class="headerlink" title="氏族战争（WarOfClan.java）"></a>氏族战争（WarOfClan.java）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  A cruel natural selection game</span><br><span class="line"> *  7 clans are pre-built</span><br><span class="line"> *      -&gt;1.Rose:       high beauty</span><br><span class="line"> *      -&gt;2.Banker:     rich</span><br><span class="line"> *      -&gt;3.Ranger:     love travel</span><br><span class="line"> *      -&gt;4.Skaven:     higher birth rate</span><br><span class="line"> *      -&gt;5.Playboy:    flirt married women</span><br><span class="line"> *      -&gt;6.Barbarian:  don't care ugly women</span><br><span class="line"> *      -&gt;7.Nobody:     no extra skill</span><br><span class="line"> *  <span class="doctag">@author</span> wei.shen<span class="doctag">@iro</span>.umontreal.ca</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.clanWar;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  This is a factory class to create the hole world and human, and then pass several years.</span><br><span class="line"> *  It use the factory class "Clan" to generate humans.</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarOfClan</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Main fonction</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">//automaticly run the game and return the statistic result</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;ArrayList&lt;Double&gt;&gt; runTheGame(<span class="keyword">int</span> years, ArrayList&lt;Integer&gt; iniPopulations)&#123;</span><br><span class="line">        <span class="comment">//initialize the container of the result</span></span><br><span class="line">        ArrayList&lt;ArrayList&lt;Double&gt;&gt; result=<span class="keyword">new</span> ArrayList&lt;ArrayList&lt;Double&gt;&gt;();</span><br><span class="line">        <span class="comment">//create world</span></span><br><span class="line">        TheWorld newWorld = TheWorld.createNewWorld();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//create the factories of humans: Clans</span></span><br><span class="line">        <span class="keyword">int</span> clanNumber=<span class="number">0</span>;   <span class="comment">//total number of clans</span></span><br><span class="line">        <span class="keyword">for</span>(String clanName : Clan.CLAN_NAMES)&#123;</span><br><span class="line">            Clan theClan=Clan.createTheClan(clanName);</span><br><span class="line">            <span class="comment">//each clan create their members(human)</span></span><br><span class="line">            <span class="keyword">if</span>(iniPopulations.size()&gt;clanNumber)&#123;</span><br><span class="line">                theClan.chargeClan(iniPopulations.get(clanNumber),newWorld);</span><br><span class="line">                <span class="comment">//create the result container</span></span><br><span class="line">                result.add(<span class="keyword">new</span> ArrayList&lt;Double&gt;());</span><br><span class="line">                clanNumber++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//<span class="label">XXX years later</span></span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;years;i++)&#123;</span><br><span class="line">            newWorld.passOneYear();</span><br><span class="line">            <span class="comment">//statistic results: population of each clan at the end of each year</span></span><br><span class="line">            ArrayList&lt;Double&gt; oneYearResult=collectResult(newWorld,clanNumber);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;clanNumber;j++)&#123;</span><br><span class="line">                result.get(j).add(oneYearResult.get(j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Statistic</span><br><span class="line">     */</span></span><br><span class="line">    <span class="comment">//return the statistic results: population of each clan at the end of each year</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList&lt;Double&gt; <span class="title">collectResult</span><span class="params">(TheWorld world, <span class="keyword">int</span> clanNumber)</span></span>&#123;</span><br><span class="line">        <span class="comment">//collect the result</span></span><br><span class="line">        ArrayList&lt;Double&gt; result=<span class="keyword">new</span> ArrayList&lt;Double&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;clanNumber;i++)&#123;</span><br><span class="line">            result.add(<span class="number">0.0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//statistic</span></span><br><span class="line">        <span class="keyword">for</span> (Human h : world.getHumanList())&#123;</span><br><span class="line">            <span class="comment">//clan population plus 1</span></span><br><span class="line">            <span class="keyword">if</span>(Clan.CLAN_NAMES.indexOf(h.getClanName())!=-<span class="number">1</span>)&#123;</span><br><span class="line">                result.set(Clan.CLAN_NAMES.indexOf(h.getClanName()),result.get(Clan.CLAN_NAMES.indexOf(h.getClanName()))+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  MAIN</span><br><span class="line">     *  to test the method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="图形板（GraphPanel-java）-1"><a href="#图形板（GraphPanel-java）-1" class="headerlink" title="图形板（GraphPanel.java）"></a>图形板（GraphPanel.java）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  Help me to draw a graph to show the statistic result</span><br><span class="line"> *  GraphPanel is a data package</span><br><span class="line"> *  paintComponent() methods records all the rules to draw the graph</span><br><span class="line"> *  createAndShowGui() use JFrame to call paintComponent() to draw the graph</span><br><span class="line"> *  <span class="doctag">@author</span> Rodrigo Castro</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.clanWar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.Math;</span><br><span class="line"><span class="keyword">import</span> java.awt.BasicStroke;</span><br><span class="line"><span class="keyword">import</span> java.awt.Color;</span><br><span class="line"><span class="keyword">import</span> java.awt.Dimension;</span><br><span class="line"><span class="keyword">import</span> java.awt.FontMetrics;</span><br><span class="line"><span class="keyword">import</span> java.awt.Graphics;</span><br><span class="line"><span class="keyword">import</span> java.awt.Graphics2D;</span><br><span class="line"><span class="keyword">import</span> java.awt.Point;</span><br><span class="line"><span class="keyword">import</span> java.awt.RenderingHints;</span><br><span class="line"><span class="keyword">import</span> java.awt.Stroke;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JFrame;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JPanel;</span><br><span class="line"><span class="keyword">import</span> javax.swing.SwingUtilities;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraphPanel</span> <span class="keyword">extends</span> <span class="title">JPanel</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> width = <span class="number">800</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> heigth = <span class="number">400</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> padding = <span class="number">35</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> labelPadding = <span class="number">25</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> referenceZone = <span class="number">100</span>;    <span class="comment">//show the title of each line</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> referencePadding = <span class="number">50</span>;</span><br><span class="line">    <span class="comment">/*we random the line and point color for each line*/</span></span><br><span class="line">    <span class="comment">//private Color lineColor = new Color(44, 102, 230, 180);</span></span><br><span class="line">    <span class="comment">//private Color pointColor = new Color(100, 100, 100, 180);</span></span><br><span class="line">    <span class="keyword">private</span> Color gridColor = <span class="keyword">new</span> Color(<span class="number">200</span>, <span class="number">200</span>, <span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Stroke GRAPH_STROKE = <span class="keyword">new</span> BasicStroke(<span class="number">2f</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> pointWidth = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> numberYDivisions = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;ArrayList&lt;Double&gt;&gt; result;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;String&gt; ticket;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">0L</span>; <span class="comment">//useless, just because JPanel implements the serializable interface</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GraphPanel</span><span class="params">(ArrayList&lt;ArrayList&lt;Double&gt;&gt; result, ArrayList&lt;String&gt; ticket)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.result = result;</span><br><span class="line">        <span class="keyword">this</span>.ticket = ticket;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">paintComponent</span><span class="params">(Graphics g)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.paintComponent(g);</span><br><span class="line">        Graphics2D g2 = (Graphics2D) g;</span><br><span class="line">        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);</span><br><span class="line">        </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//get the length of the tickets</span></span><br><span class="line">        <span class="keyword">int</span> colonWidth = getMaxTicket(g2, ticket);</span><br><span class="line">        <span class="comment">//calculate the number of colone needed</span></span><br><span class="line">        <span class="keyword">int</span> colonNum=<span class="number">1</span>; <span class="comment">//more than one colon with too much lines references</span></span><br><span class="line">        <span class="keyword">int</span> maxRefEachColon = (<span class="keyword">int</span>)Math.floor((<span class="keyword">double</span>)(getHeight() - <span class="number">2</span> * padding - labelPadding) / referencePadding);</span><br><span class="line">        colonNum = (<span class="keyword">int</span>)Math.ceil(result.size()/(<span class="keyword">double</span>)maxRefEachColon);</span><br><span class="line">        <span class="comment">//get the height of the reference zone</span></span><br><span class="line">        <span class="keyword">int</span> colonHeight=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(colonNum==<span class="number">1</span>)&#123;</span><br><span class="line">            colonHeight=padding + referencePadding + result.size() * referencePadding;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(colonNum&gt;<span class="number">1</span>)&#123;</span><br><span class="line">            colonHeight=getHeight()-padding*<span class="number">2</span>-labelPadding;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//calculate the width of reference zone</span></span><br><span class="line">        <span class="keyword">this</span>.referenceZone=(colonNum*colonWidth+(colonNum-<span class="number">1</span>)*padding/<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//calculate the size of each small cell</span></span><br><span class="line">        <span class="keyword">double</span> xScale = ((<span class="keyword">double</span>) getWidth() - padding - labelPadding - padding - referenceZone - padding) / (result.get(<span class="number">0</span>).size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">double</span> yScale = ((<span class="keyword">double</span>) getHeight() - <span class="number">2</span> * padding - labelPadding) / (getMaxScore() - getMinScore());</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// draw the main white background</span></span><br><span class="line">        g2.setColor(Color.WHITE);</span><br><span class="line">        g2.fillRect(padding + labelPadding, padding, getWidth() - (<span class="number">2</span> * padding) - labelPadding - referenceZone - padding, getHeight() - <span class="number">2</span> * padding - labelPadding);</span><br><span class="line">        <span class="comment">// draw the small white background for the reference zone</span></span><br><span class="line">        g2.fillRect(getWidth() - padding - referenceZone - padding/<span class="number">2</span>, padding, referenceZone + padding, colonHeight);</span><br><span class="line">        g2.setColor(Color.BLACK);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// create hatch marks and grid lines for y axis.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numberYDivisions + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x0 = padding + labelPadding;</span><br><span class="line">            <span class="keyword">int</span> x1 = pointWidth + padding + labelPadding;</span><br><span class="line">            <span class="keyword">int</span> y0 = getHeight() - ((i * (getHeight() - padding * <span class="number">2</span> - labelPadding)) / numberYDivisions + padding + labelPadding);</span><br><span class="line">            <span class="keyword">int</span> y1 = y0;</span><br><span class="line">            <span class="keyword">if</span> (result.get(<span class="number">0</span>).size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                g2.setColor(gridColor);</span><br><span class="line">                g2.drawLine(padding + labelPadding + <span class="number">1</span> + pointWidth, y0, getWidth() - padding -referenceZone - padding, y1);</span><br><span class="line">                g2.setColor(Color.BLACK);</span><br><span class="line">                String yLabel = ((<span class="keyword">int</span>) ((getMinScore() + (getMaxScore() - getMinScore()) * ((i * <span class="number">1.0</span>) / numberYDivisions)) * <span class="number">100</span>)) / <span class="number">100.0</span> + <span class="string">""</span>;</span><br><span class="line">                FontMetrics metrics = g2.getFontMetrics();</span><br><span class="line">                <span class="keyword">int</span> labelWidth = metrics.stringWidth(yLabel);</span><br><span class="line">                g2.drawString(yLabel, x0 - labelWidth - <span class="number">5</span>, y0 + (metrics.getHeight() / <span class="number">2</span>) - <span class="number">3</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            g2.drawLine(x0, y0, x1, y1);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// and for x axis</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.get(<span class="number">0</span>).size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (result.get(<span class="number">0</span>).size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> x0 = i * (getWidth() - padding * <span class="number">2</span> - labelPadding - referenceZone -padding) / (result.get(<span class="number">0</span>).size() - <span class="number">1</span>) + padding + labelPadding;</span><br><span class="line">                <span class="keyword">int</span> x1 = x0;</span><br><span class="line">                <span class="keyword">int</span> y0 = getHeight() - padding - labelPadding;</span><br><span class="line">                <span class="keyword">int</span> y1 = y0 - pointWidth;</span><br><span class="line">                <span class="keyword">if</span> ((i % ((<span class="keyword">int</span>) (result.get(<span class="number">0</span>).size() / <span class="number">20.0</span>) + <span class="number">1</span>)) == <span class="number">0</span>) &#123;</span><br><span class="line">                    g2.setColor(gridColor);</span><br><span class="line">                    g2.drawLine(x0, getHeight() - padding - labelPadding - <span class="number">1</span> - pointWidth, x1, padding);</span><br><span class="line">                    g2.setColor(Color.BLACK);</span><br><span class="line">                    String xLabel = i + <span class="string">""</span>;</span><br><span class="line">                    FontMetrics metrics = g2.getFontMetrics();</span><br><span class="line">                    <span class="keyword">int</span> labelWidth = metrics.stringWidth(xLabel);</span><br><span class="line">                    g2.drawString(xLabel, x0 - labelWidth / <span class="number">2</span>, y0 + metrics.getHeight() + <span class="number">3</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                g2.drawLine(x0, y0, x1, y1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// create x and y axes</span></span><br><span class="line">        g2.drawLine(padding + labelPadding, getHeight() - padding - labelPadding, padding + labelPadding, padding);</span><br><span class="line">        g2.drawLine(padding + labelPadding, getHeight() - padding - labelPadding, getWidth() - padding -referenceZone - padding, getHeight() - padding - labelPadding);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> index=<span class="number">0</span>; <span class="comment">//my own List index</span></span><br><span class="line">        <span class="keyword">for</span>(ArrayList&lt;Double&gt; scores : result)&#123;</span><br><span class="line">            <span class="comment">//collect the points of one line</span></span><br><span class="line">            List&lt;Point&gt; graphPoints = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; scores.size(); i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> x1 = (<span class="keyword">int</span>) (i * xScale + padding + labelPadding);</span><br><span class="line">                <span class="keyword">int</span> y1 = (<span class="keyword">int</span>) ((getMaxScore() - scores.get(i)) * yScale + padding);</span><br><span class="line">                graphPoints.add(<span class="keyword">new</span> Point(x1, y1));</span><br><span class="line">            &#125;</span><br><span class="line">        </span><br><span class="line">            <span class="comment">//draw each line</span></span><br><span class="line">            Stroke oldStroke = g2.getStroke();</span><br><span class="line">            Random colorRander=<span class="keyword">new</span> Random();</span><br><span class="line">            <span class="keyword">int</span> color1=colorRander.nextInt(<span class="number">256</span>);</span><br><span class="line">            <span class="keyword">int</span> color2=colorRander.nextInt(<span class="number">256</span>);</span><br><span class="line">            <span class="keyword">int</span> color3=colorRander.nextInt(<span class="number">256</span>);</span><br><span class="line">            <span class="comment">//alpha value = 255 (no transparent)</span></span><br><span class="line">            Color lineColor = <span class="keyword">new</span> Color(color1,color2,color3,<span class="number">255</span>);</span><br><span class="line">            g2.setColor(lineColor);</span><br><span class="line">            g2.setStroke(GRAPH_STROKE);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; graphPoints.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> x1 = graphPoints.get(i).x;</span><br><span class="line">                <span class="keyword">int</span> y1 = graphPoints.get(i).y;</span><br><span class="line">                <span class="keyword">int</span> x2 = graphPoints.get(i + <span class="number">1</span>).x;</span><br><span class="line">                <span class="keyword">int</span> y2 = graphPoints.get(i + <span class="number">1</span>).y;</span><br><span class="line">                g2.drawLine(x1, y1, x2, y2);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//draw the reference of the line to the panel</span></span><br><span class="line">            <span class="keyword">int</span> colonId=(<span class="keyword">int</span>)Math.ceil((<span class="keyword">double</span>)(index+<span class="number">1</span>)/maxRefEachColon);</span><br><span class="line">            <span class="keyword">int</span> x0 = getWidth() - padding/<span class="number">2</span> - (colonNum-colonId+<span class="number">1</span>)*(colonWidth+padding/<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">int</span> x1 = x0+colonWidth;</span><br><span class="line">            <span class="keyword">int</span> y0 = padding + referencePadding * (index%maxRefEachColon) + referencePadding;</span><br><span class="line">            <span class="keyword">int</span> y1 = y0;</span><br><span class="line">            g2.drawLine(x0, y0 - pointWidth, x0, y0);</span><br><span class="line">            g2.drawLine(x0, y0, x1, y1);</span><br><span class="line">            g2.drawLine(x1, y0 - pointWidth, x1, y0);</span><br><span class="line">            g2.drawString(ticket.get(index),x0,y0 +referencePadding/<span class="number">3</span>);</span><br><span class="line">        </span><br><span class="line">            </span><br><span class="line">            <span class="comment">//draw the point?? smoothing?? color??</span></span><br><span class="line">            g2.setStroke(oldStroke);</span><br><span class="line">            g2.setColor(lineColor); <span class="comment">//we use lineColor to set pointColor</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; graphPoints.size(); i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> x = graphPoints.get(i).x - pointWidth / <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">int</span> y = graphPoints.get(i).y - pointWidth / <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">int</span> ovalW = pointWidth;</span><br><span class="line">                <span class="keyword">int</span> ovalH = pointWidth;</span><br><span class="line">                g2.fillOval(x, y, ovalW, ovalH);</span><br><span class="line">            &#125;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//    @Override</span></span><br><span class="line">    <span class="comment">//    public Dimension getPreferredSize() &#123;</span></span><br><span class="line">    <span class="comment">//        return new Dimension(width, heigth);</span></span><br><span class="line">    <span class="comment">//    &#125;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//get the longest ticket to set the width of reference zone</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getMaxTicket</span><span class="params">(Graphics2D g2, ArrayList&lt;String&gt; ticket)</span></span>&#123;</span><br><span class="line">        FontMetrics metrics = g2.getFontMetrics();</span><br><span class="line">        <span class="keyword">int</span> maxTicket=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(String t : ticket)&#123;</span><br><span class="line">            <span class="keyword">int</span> ticketWidth=metrics.stringWidth(t);</span><br><span class="line">            maxTicket=Math.max(maxTicket,ticketWidth);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxTicket;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getMinScore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> minScore = Double.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span>(ArrayList&lt;Double&gt; oneSerie : result)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Double score : oneSerie) &#123;</span><br><span class="line">                minScore = Math.min(minScore, score);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> minScore;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getMaxScore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> maxScore = Double.MIN_VALUE;</span><br><span class="line">        <span class="keyword">for</span>(ArrayList&lt;Double&gt; oneSerie : result)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Double score : oneSerie) &#123;</span><br><span class="line">                maxScore = Math.max(maxScore, score);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxScore;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScores</span><span class="params">(ArrayList&lt;ArrayList&lt;Double&gt;&gt; result)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.result = result;</span><br><span class="line">        invalidate();</span><br><span class="line">        <span class="keyword">this</span>.repaint();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt;ArrayList&lt;Double&gt;&gt; getScores() &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createAndShowGui</span><span class="params">(ArrayList&lt;ArrayList&lt;Double&gt;&gt; result, ArrayList&lt;String&gt; ticket)</span> </span>&#123;</span><br><span class="line">        GraphPanel mainPanel = <span class="keyword">new</span> GraphPanel(result,ticket);</span><br><span class="line">        mainPanel.setPreferredSize(<span class="keyword">new</span> Dimension(<span class="number">1400</span>, <span class="number">800</span>));</span><br><span class="line">        JFrame frame = <span class="keyword">new</span> JFrame(<span class="string">"DrawGraph"</span>);</span><br><span class="line">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        frame.getContentPane().add(mainPanel);</span><br><span class="line">        frame.pack();</span><br><span class="line">        frame.setLocationRelativeTo(<span class="keyword">null</span>);</span><br><span class="line">        frame.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//configurate the game</span></span><br><span class="line">        <span class="keyword">int</span> years=<span class="number">500</span>;</span><br><span class="line">        ArrayList&lt;Integer&gt; iniPopulations=<span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//rose</span></span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//banker</span></span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//ranger</span></span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//skaven</span></span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//playboy</span></span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//barbarian</span></span><br><span class="line">        iniPopulations.add(<span class="keyword">new</span> Integer(<span class="number">2000</span>));  <span class="comment">//nobody</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//run the WarOfClan game</span></span><br><span class="line">        ArrayList&lt;ArrayList&lt;Double&gt;&gt; result=WarOfClan.runTheGame(years,iniPopulations);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//draw the statistic graph of the game</span></span><br><span class="line">        SwingUtilities.invokeLater(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                createAndShowGui(result,Clan.CLAN_NAMES);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/abstract-factory/" rel="tag">#abstract factory</a>
          
            <a href="/tags/builder/" rel="tag">#builder</a>
          
            <a href="/tags/compose/" rel="tag">#compose</a>
          
            <a href="/tags/factory-method/" rel="tag">#factory method</a>
          
            <a href="/tags/inherit/" rel="tag">#inherit</a>
          
            <a href="/tags/reuse/" rel="tag">#reuse</a>
          
            <a href="/tags/复用类/" rel="tag">#复用类</a>
          
            <a href="/tags/工厂方法/" rel="tag">#工厂方法</a>
          
            <a href="/tags/建造者/" rel="tag">#建造者</a>
          
            <a href="/tags/组合/" rel="tag">#组合</a>
          
            <a href="/tags/继承/" rel="tag">#继承</a>
          
            <a href="/tags/虚拟工厂/" rel="tag">#虚拟工厂</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/04/16/unePose/" rel="next" title="魁省移民法语考试，刷Think in Java暂停了两个月">
                <i class="fa fa-chevron-left"></i> 魁省移民法语考试，刷Think in Java暂停了两个月
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/06/23/tij4-8/" rel="prev" title="Think in Java 读书笔记：第八章 - 多态">
                Think in Java 读书笔记：第八章 - 多态 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/06/12/reuseExercise/"
           data-title="重构小练习：小游戏-氏族战争" data-url="www.ciaoshen.com/2016/06/12/reuseExercise/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/shenAvatar.jpg"
               alt="沈玮 | Wei SHEN" />
          <p class="site-author-name" itemprop="name">沈玮 | Wei SHEN</p>
          <p class="site-description motion-element" itemprop="description">Coder & Designer</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">47</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">149</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/helloShen" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.douban.com/people/72441576/" target="_blank">
                  
                    <i class="fa fa-globe"></i> DouBan
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/pang-pang-37-37" target="_blank">
                  
                    <i class="fa fa-globe"></i> ZhiHu
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#游戏规则"><span class="nav-number">2.</span> <span class="nav-text">游戏规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码设计"><span class="nav-number">3.</span> <span class="nav-text">代码设计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#人类（Human-java）"><span class="nav-number">3.1.</span> <span class="nav-text">人类（Human.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#氏族（Clan-java）"><span class="nav-number">3.2.</span> <span class="nav-text">氏族（Clan.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#七大种族"><span class="nav-number">3.3.</span> <span class="nav-text">七大种族</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大陆（TheWorld-java）"><span class="nav-number">3.4.</span> <span class="nav-text">大陆（TheWorld.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#氏族战争（WarOfClan-java）"><span class="nav-number">3.5.</span> <span class="nav-text">氏族战争（WarOfClan.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#图形板（GraphPanel-java）"><span class="nav-number">3.6.</span> <span class="nav-text">图形板（GraphPanel.java）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实验结果"><span class="nav-number">4.</span> <span class="nav-text">实验结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码"><span class="nav-number">5.</span> <span class="nav-text">代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#人类（Human-java）-1"><span class="nav-number">5.1.</span> <span class="nav-text">人类（Human.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#氏族（Clan-java）-1"><span class="nav-number">5.2.</span> <span class="nav-text">氏族（Clan.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#七大种族-1"><span class="nav-number">5.3.</span> <span class="nav-text">七大种族</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大陆（TheWorld-java）-1"><span class="nav-number">5.4.</span> <span class="nav-text">大陆（TheWorld.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#氏族战争（WarOfClan-java）-1"><span class="nav-number">5.5.</span> <span class="nav-text">氏族战争（WarOfClan.java）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#图形板（GraphPanel-java）-1"><span class="nav-number">5.6.</span> <span class="nav-text">图形板（GraphPanel.java）</span></a></li></ol></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">沈玮 | Wei SHEN</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io" rel="external nofollow">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>

</br>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div>
  <span id="busuanzi_container_site_pv">
  Visited  <span id="busuanzi_value_site_pv"></span>  times
  </span>

<span id="busuanzi_container_site_pv">&nbsp; &nbsp; | &nbsp; &nbsp;</span>

  <span id="busuanzi_container_site_uv">
  <span id="busuanzi_value_site_uv"></span>  Visitors
  </span>
<div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  
<script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>

<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = NexT.utils.escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    NexT.motion.middleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');

      if (CONFIG.sidebar.display === 'post' || CONFIG.sidebar.display === 'always') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          NexT.utils.displaySidebar();
        }
      }
    };
  });
</script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"ciaoshen"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  





  
  

  
  


</body>
</html>
