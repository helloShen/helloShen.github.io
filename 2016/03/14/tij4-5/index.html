<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Development, Algorithm" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="摘要构造函数对象初始化，包括构造函数在之前《Think in Java 读书笔记：第三章 - 操作符》这一章已经分析过。直接练习题。
对于无参数的默认构造函数，以及以参数类型区分的重载构造函数，设计上说不上完美，我完全可以需要好几个有相同参数类型，但完全不同的构造函数，这在java里就无法实现。但实际用起来，这样的设定还挺实用，目前为止，我没遇到过构造函数打架的问题。
练习1，2Exercise">
<meta property="og:type" content="article">
<meta property="og:title" content="Think in Java 读书笔记：第五章 - 初始化与清理">
<meta property="og:url" content="www.ciaoshen.com/2016/03/14/tij4-5/index.html">
<meta property="og:site_name" content="沈玮 | Wei SHEN">
<meta property="og:description" content="摘要构造函数对象初始化，包括构造函数在之前《Think in Java 读书笔记：第三章 - 操作符》这一章已经分析过。直接练习题。
对于无参数的默认构造函数，以及以参数类型区分的重载构造函数，设计上说不上完美，我完全可以需要好几个有相同参数类型，但完全不同的构造函数，这在java里就无法实现。但实际用起来，这样的设定还挺实用，目前为止，我没遇到过构造函数打架的问题。
练习1，2Exercise">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-5/oop_5.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-5/enumDifficulty.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-5/enum1.png">
<meta property="og:image" content="www.ciaoshen.com/uploads/tij4-5/enum2.png">
<meta property="og:updated_time" content="2016-03-16T22:49:31.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Think in Java 读书笔记：第五章 - 初始化与清理">
<meta name="twitter:description" content="摘要构造函数对象初始化，包括构造函数在之前《Think in Java 读书笔记：第三章 - 操作符》这一章已经分析过。直接练习题。
对于无参数的默认构造函数，以及以参数类型区分的重载构造函数，设计上说不上完美，我完全可以需要好几个有相同参数类型，但完全不同的构造函数，这在java里就无法实现。但实际用起来，这样的设定还挺实用，目前为止，我没遇到过构造函数打架的问题。
练习1，2Exercise">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: 'Author'
    }
  };
</script>



  <meta name="baidu-site-verification" content="3iRy3UFlpa" />


<script>
  (function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>


  <title> Think in Java 读书笔记：第五章 - 初始化与清理 | 沈玮 | Wei SHEN </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-74473715-1', 'auto');
  ga('send', 'pageview');
</script>







  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">沈玮 | Wei SHEN</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Coder & Designer</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
      
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'hDG3wYskg4CYKGSXw8x7','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Think in Java 读书笔记：第五章 - 初始化与清理
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-14T11:46:29-04:00" content="2016-03-14">
              2016-03-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Note/" itemprop="url" rel="index">
                    <span itemprop="name">Note</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
            <span id="busuanzi_container_page_pv">&nbsp; |  &nbsp; &nbsp; Viewed <span id="busuanzi_value_page_pv"></span> times</span>
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="/uploads/tij4-5/oop_5.png" alt="oop_5"></p>
<h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>对象初始化，包括构造函数在之前<a href="http://www.ciaoshen.com/2016/03/09/tij4-3/"><strong>《Think in Java 读书笔记：第三章 - 操作符》</strong></a>这一章已经分析过。直接练习题。</p>
<p>对于无参数的默认构造函数，以及以参数类型区分的重载构造函数，设计上说不上完美，我完全可以需要好几个有相同参数类型，但完全不同的构造函数，这在java里就无法实现。但实际用起来，这样的设定还挺实用，目前为止，我没遇到过构造函数打架的问题。</p>
<h4 id="练习1，2"><a href="#练习1，2" class="headerlink" title="练习1，2"></a>练习1，2</h4><p>Exercise 1: (1) Create a class containing an uninitialized String reference. Demonstrate that this reference is initialized by Java to null.<br>Exercise 2: (2) Create a class with a String field that is initialized at the point of definition, and another one that is initialized by the constructor. What is the difference between the two approaches?</p>
<p>指出一点，如果这里的构造函数是空的：<strong><code>public Initialize (){}</code></strong>，那不必显式的写出来。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter5;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Initialize</span> </span>&#123;</span><br><span class="line">    <span class="comment">//fields</span></span><br><span class="line">    <span class="comment">//exercise 1,2</span></span><br><span class="line">    <span class="keyword">public</span> String nonInitialized = <span class="keyword">new</span> String();</span><br><span class="line">    <span class="keyword">public</span> String initialized  = <span class="string">"I am auto-initialized!"</span>;</span><br><span class="line">    <span class="keyword">public</span> String constructorInitialized = <span class="keyword">new</span> String();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//default constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Initialize</span> <span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.constructorInitialized = <span class="string">"Constructor initialize me now!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  Our main method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        Initialize myObject = <span class="keyword">new</span> Initialize();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//exercise 1,2</span></span><br><span class="line">        System.out.println(myObject.nonInitialized);</span><br><span class="line">        System.out.println(myObject.initialized);</span><br><span class="line">        System.out.println(myObject.constructorInitialized);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line"><span class="comment">//	</span></span><br><span class="line"><span class="comment">//	I am auto-initialized!</span></span><br><span class="line"><span class="comment">//	Constructor initialize me now!</span></span><br></pre></td></tr></table></figure>
<h3 id="方法的重载"><a href="#方法的重载" class="headerlink" title="方法的重载"></a>方法的重载</h3><p>成员方法可以重名，只要参数类型不一样，或者返回值不一样，就以不同的方法。甚至参数放的顺序不一样，也能区分方法。比如<strong><code>method(int i, String s)</code></strong>和<strong><code>method(String s, int i)</code></strong>是不同的两个方法。但写代码的时候别这么干。会把自己搞糊涂。</p>
<h4 id="参数的“自动提升”和“窄化转型”"><a href="#参数的“自动提升”和“窄化转型”" class="headerlink" title="参数的“自动提升”和“窄化转型”"></a>参数的“自动提升”和“窄化转型”</h4><p>java函数传递参数的时候不是一定需要完全符合的类型。对基本型参数，我们传入的参数基本型在我们定义的另一个基本型里放得下，java会做基本型的“自动提升”。比如只有这一个构造函数setI(int inputInt)，如果我构造时传入的是short，系统会自动找到setI(int inputInt)。但如果我构造是传入long型，因为int里放不下long，我必须显式地把long先“窄化转型”成int，再调用构造函数setI(int inputInt)，不然系统会抛出异常。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Initialize</span> </span>&#123;</span><br><span class="line">    <span class="comment">//primitive type field</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> i;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//成员方法参数int型</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setI</span> <span class="params">(<span class="keyword">int</span> inputInt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.i=inputInt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;  </span><br><span class="line">        Initialize myObject = <span class="keyword">new</span> Initialize();</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">short</span> s = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">long</span> l = <span class="number">10L</span>;</span><br><span class="line">        mObject.setI(i);   <span class="comment">//函数参数就是int，int当然没问题。</span></span><br><span class="line">        myObject.setI(s);   <span class="comment">//传short，java会自动调用带int参数的函数，因为int放得下short。</span></span><br><span class="line">        myObject.setI(l);  <span class="comment">//传long就不行了。必须显式地窄化转型成int。</span></span><br><span class="line">        System.out.println(intObject.i);</span><br><span class="line">        System.out.println(shortObject.i);</span><br><span class="line">        System.out.println(longObject.i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="练习-3-4"><a href="#练习-3-4" class="headerlink" title="练习 3,4"></a>练习 3,4</h4><p>Exercise 3: (1) Create a class with a default constructor (one that takes no arguments) that prints a message. Create an object of this class.<br>Exercise 4: (1) Add an overloaded constructor to the previous exercise that takes a String argument and prints it along with your message.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//default constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Initialize</span> <span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.constructorInitialized = <span class="string">"Hello World!"</span>;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.constructorInitialized);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//constructor with param String</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Initialize</span> <span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.constructorInitialized = <span class="string">"Hello "</span>+name+<span class="string">"!"</span>;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.constructorInitialized);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        <span class="comment">//exercise 3</span></span><br><span class="line">        Initialize defaulObject = <span class="keyword">new</span> Initialize();</span><br><span class="line">        Initialize shenObject = <span class="keyword">new</span> Initialize(<span class="string">"shen"</span>);      </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line"><span class="comment">//Hello World!</span></span><br><span class="line"><span class="comment">//Hello shen!</span></span><br></pre></td></tr></table></figure>
<h4 id="练习-5-6"><a href="#练习-5-6" class="headerlink" title="练习 5,6"></a>练习 5,6</h4><p>Exercise 5: (2) Create a class called Dog with an overloaded bark( ) method. This method should be overloaded based on various primitive data types, and print different types of barking, howling, etc., depending on which overloaded version is called. Write a main( ) that calls all the different versions.<br>Exercise 6: (1) Modify the previous exercise so that two of the overloaded methods have two arguments (of two different types), but in reversed order relative to each other. Verify that this works.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> com.ciaoshen.thinkinjava.chapter3.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  Inherit the Dog class in Chapter 3</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HowlingDog</span> <span class="keyword">extends</span> <span class="title">com</span>.<span class="title">ciaoshen</span>.<span class="title">thinkinjava</span>.<span class="title">chapter3</span>.<span class="title">Dog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"barking"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">(String who)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"howling to "</span>+who);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">(String who, <span class="keyword">int</span> times)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;times;i++)&#123;</span><br><span class="line">            System.out.println(<span class="string">"howling to "</span>+who);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">(<span class="keyword">int</span> times, String who)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;times;i++)&#123;</span><br><span class="line">            System.out.print(<span class="string">"howling "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"to "</span>+who);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        HowlingDog puppy = <span class="keyword">new</span> HowlingDog();</span><br><span class="line">        puppy.bark();</span><br><span class="line">        puppy.bark(<span class="string">"shen"</span>);</span><br><span class="line">        System.out.println(<span class="string">""</span>);</span><br><span class="line">        puppy.bark(<span class="string">"shen"</span>,<span class="number">5</span>);</span><br><span class="line">        puppy.bark(<span class="number">5</span>,<span class="string">"shen"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//	output:</span></span><br><span class="line">barking</span><br><span class="line">howling to shen</span><br><span class="line"></span><br><span class="line">howling to shen</span><br><span class="line">howling to shen</span><br><span class="line">howling to shen</span><br><span class="line">howling to shen</span><br><span class="line">howling to shen</span><br><span class="line">howling howling howling howling howling to shen</span><br></pre></td></tr></table></figure>
<h4 id="练习-7"><a href="#练习-7" class="headerlink" title="练习 7"></a>练习 7</h4><p>Exercise 7: (1) Create a class without a constructor, and then create an object of that class in main( ) to verify that the default constructor is automatically synthesized.</p>
<p>把第5，6题答案中HowlingDog类对com.ciaoshen.thinkinjava.chapter3.Dog类的继承去掉，就没有构造函数了。但程序照样能跑。</p>
<h3 id="this关键字"><a href="#this关键字" class="headerlink" title="this关键字"></a>this关键字</h3><p>this关键字，代表在类的内部，对当前对象的引用。static静态类是没有this的。</p>
<h4 id="把this当参数传递"><a href="#把this当参数传递" class="headerlink" title="把this当参数传递"></a>把this当参数传递</h4><p>this关键字我以前没试过的一种用法：当参数传递给别的方法。下面的代码从设计的角度说还不错，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">(Apple apple)</span> </span>&#123;    Apple peeled = apple.getPeeled();    System.out.println(<span class="string">"Yummy"</span>);  &#125;&#125;<span class="class"><span class="keyword">class</span> <span class="title">Peeler</span> </span>&#123;  <span class="function"><span class="keyword">static</span> Apple <span class="title">peel</span><span class="params">(Apple apple)</span> </span>&#123;    <span class="comment">// ... remove peel</span>    <span class="keyword">return</span> apple; <span class="comment">// Peeled</span>  &#125;&#125;<span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;  <span class="function">Apple <span class="title">getPeeled</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> Peeler.peel(<span class="keyword">this</span>); &#125;&#125;<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PassingThis</span> </span>&#123;  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;    <span class="keyword">new</span> Person().eat(<span class="keyword">new</span> Apple());  &#125;&#125; <span class="comment">/* Output:Yummy</span></span><br></pre></td></tr></table></figure>
<h4 id="在构造器中调用另一个构造器"><a href="#在构造器中调用另一个构造器" class="headerlink" title="在构造器中调用另一个构造器"></a>在构造器中调用另一个构造器</h4><p>在构造函数里，用this关键字，调用另一个构造器，java也能认识。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> Flower(String ss) &#123;    print(<span class="string">"Red"</span>);s = ss; &#125;  Flower(String s, <span class="keyword">int</span> petals) &#123;    <span class="keyword">this</span>(petals);	<span class="comment">//!    this(s); // Can’t call two!</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="编程风格：-不必到处用this"><a href="#编程风格：-不必到处用this" class="headerlink" title="编程风格： 不必到处用this"></a>编程风格： 不必到处用this</h4><blockquote>
<p>Some people will obsessively put this in front of every method call and field reference, arguing that it makes it “clearer and more explicit.” Don’t do it. There’s a reason that we use high-level languages: They do things for us. If you put this in when it’s not necessary, you will confuse and annoy everyone who reads your code, since all the rest of the code they’ve read won’t use this everywhere. People expect this to be used only when it is necessary. Following a consistent and straightforward coding style saves time and money.</p>
</blockquote>
<p>关于编程风格，这段注脚让我们避免在不必要的时候也全加上this关键字。我一般在字段前面加this，但调用类中成员方法就不用。</p>
<h3 id="finalize-函数"><a href="#finalize-函数" class="headerlink" title="finalize()函数"></a>finalize()函数</h3><p>C++需要手动释放内存，Java有垃圾回收器。我们不能决定什么东西在什么时候被清理。但Java还是给了我们一些工具，一定程度上控制垃圾的回收。</p>
<p>首先就是<strong><code>System.gc()</code></strong>，强制现在执行一次垃圾回收。</p>
<p>然后就是这个<strong><code>finalize()</code></strong>函数。他用来定义当对象被回收的时候所需要做的操作。我们可以通过对基类finalize函数的重载，达到这个目的。</p>
<p>但Java仍然不保证当前对象一定会被回收，因为回收对象的扫描过程的控制权不在我们手上。由Java垃圾回收器决定哪些垃圾需要被回收。</p>
<h4 id="练习-10，11"><a href="#练习-10，11" class="headerlink" title="练习 10，11"></a>练习 10，11</h4><p>Exercise 10: (2) Create a class with a finalize( ) method that prints a message. In main( ), create an object of your class. Explain the behavior of your program.<br>Exercise 11: (4) Modify the previous exercise so that your finalize( ) will always be called.</p>
<p>还是利用前面几题的的HowlingDog类，在垃圾回收处理的时候，在finalize()里检查小狗是否狂吠。如果不狂吠，提醒我它不是恶犬，不要清除。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter5;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> com.ciaoshen.thinkinjava.chapter3.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  Inherit the Dog class in Chapter 3</span><br><span class="line"> *  they have name and says</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HowlingDog</span> <span class="keyword">extends</span> <span class="title">com</span>.<span class="title">ciaoshen</span>.<span class="title">thinkinjava</span>.<span class="title">chapter3</span>.<span class="title">Dog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//tag to notice if the dog howls</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">boolean</span> itHowls = <span class="keyword">false</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//constructor inherit from Dog class in Chapter3</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HowlingDog</span><span class="params">(String inName, String inSays)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(inName,inSays);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.name+<span class="string">" is only barking"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bark</span><span class="params">(<span class="keyword">int</span> times, String who)</span></span>&#123;</span><br><span class="line">        System.out.print(<span class="keyword">this</span>.name+<span class="string">" "</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;times;i++)&#123;</span><br><span class="line">            System.out.print(<span class="keyword">this</span>.says);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">" to "</span>+who);</span><br><span class="line">        <span class="keyword">this</span>.itHowls=<span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// only clean the howling dogs</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(! <span class="keyword">this</span>.itHowls)&#123;</span><br><span class="line">            System.out.println(<span class="string">"Error, please do not kill "</span>+<span class="keyword">this</span>.name+<span class="string">", it doesn't howl!"</span>);</span><br><span class="line">            <span class="comment">//super.finalize();     //在基类finalize()中加入一些异常处理流程。在异常处理的一章专门练习。</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  main</span><br><span class="line">     *  <span class="doctag">@param</span> args void.</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        HowlingDog puppy = <span class="keyword">new</span> HowlingDog(<span class="string">"spots"</span>,<span class="string">"Ruff!"</span>);	<span class="comment">//恶犬</span></span><br><span class="line">        puppy.bark(<span class="number">5</span>,<span class="string">"shen"</span>);</span><br><span class="line">        puppy = <span class="keyword">new</span> HowlingDog(<span class="string">"titi"</span>,<span class="string">"JOJOJO"</span>);</span><br><span class="line">        System.gc();</span><br><span class="line">        </span><br><span class="line">        HowlingDog nicePuppy = <span class="keyword">new</span> HowlingDog(<span class="string">"cruffy"</span>,<span class="string">"Wurf!"</span>);	<span class="comment">//小受犬</span></span><br><span class="line">        nicePuppy.bark();</span><br><span class="line">        nicePuppy = <span class="keyword">new</span> HowlingDog(<span class="string">"tata"</span>,<span class="string">"BiuBiu"</span>);</span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>output:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spots Ruff!Ruff!Ruff!Ruff!Ruff! to shen</span><br><span class="line">cruffy is only barking</span><br><span class="line">Error, please do not kill cruffy, it doesn<span class="string">'t howl!</span></span><br></pre></td></tr></table></figure></p>
<h4 id="练习-12"><a href="#练习-12" class="headerlink" title="练习 12"></a>练习 12</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter5;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tank</span> </span>&#123;</span><br><span class="line">    <span class="comment">//check field</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> isEmpty = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> bullet = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">protected</span> String name = <span class="keyword">new</span> String();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//default constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tank</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//shot one bullet</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shot</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bullet --;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.bullet==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.isEmpty=<span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//finish the bullet</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showHand</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.bullet=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.isEmpty=<span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//check if the tank is empty</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">finalize</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">this</span>.isEmpty)&#123;</span><br><span class="line">            System.out.println(<span class="string">"Error! "</span>+<span class="keyword">this</span>.name+<span class="string">" still has bullet!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//super.finalize();</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  main method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        Tank tank1 = <span class="keyword">new</span> Tank(<span class="string">"Tank1"</span>);</span><br><span class="line">        Tank tank2 = <span class="keyword">new</span> Tank(<span class="string">"Tank2"</span>);</span><br><span class="line">        </span><br><span class="line">        tank1.shot();</span><br><span class="line">        tank2.showHand();</span><br><span class="line">        <span class="comment">//free the reference</span></span><br><span class="line">        tank1 = <span class="keyword">new</span> Tank(<span class="string">"Tank3"</span>);</span><br><span class="line">        tank2 = <span class="keyword">new</span> Tank(<span class="string">"Tank4"</span>);</span><br><span class="line">        <span class="comment">//force to run garbage collection</span></span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Output:	Error! Tank1 still has bullet!!</span></span><br></pre></td></tr></table></figure>
<h3 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h3><p>本章的垃圾回收内容，为了方便查阅，独立出来成一篇<a href="http://www.ciaoshen.com/2016/03/15/javaGC/"><strong>《Java垃圾回收初探》</strong></a>。作为一个系统的了解。</p>
<h3 id="成员变量初始化"><a href="#成员变量初始化" class="headerlink" title="成员变量初始化"></a>成员变量初始化</h3><p>成员变量初始化的方法，主要有</p>
<ol>
<li>直接声明</li>
<li>构造函数</li>
<li>block</li>
<li>调用函数<br>这四种方法，在第三章的时候已经做过总结，当时没想到这是在第五章讲的内容。这里我就不重复了。传送门 - <a href="http://www.ciaoshen.com/2016/03/09/tij4-3/"><strong>《Think in Java 读书笔记：第三章 - 操作符》（一开始就总结了对象初始化）</strong></a></li>
</ol>
<h4 id="练习-14-15"><a href="#练习-14-15" class="headerlink" title="练习 14,15"></a>练习 14,15</h4><p>Exercise 14: (1) Create a class with a static String field that is initialized at the point of definition, and another one that is initialized by the static block. Add a static method that prints both fields and demonstrates that they are both initialized before they are used.</p>
<p>Exercise 15: (1) Create a class with a String that is initialized using instance initialization.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Initialize</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String constructorInitialized = <span class="keyword">new</span> String();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//exercise 14</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">int</span> autoIni;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> String staticBlockIni;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"Hey autoIni!  "</span>+<span class="string">"autoIni="</span>+autoIni);</span><br><span class="line">        staticBlockIni=<span class="string">"I was born!"</span>;</span><br><span class="line">        System.out.println(<span class="string">"Hello staticBlockIni!  staticBlockIni:"</span>+staticBlockIni);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//exercise 15</span></span><br><span class="line">    <span class="keyword">protected</span> String exercise15;</span><br><span class="line">    <span class="comment">//ini block</span></span><br><span class="line">    &#123;</span><br><span class="line">        exercise15=<span class="string">"ini block gives me life"</span>;</span><br><span class="line">        System.out.println(exercise15);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//default constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Initialize</span> <span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.constructorInitialized = <span class="string">"constructor gives me life"</span>;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>.constructorInitialized);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123; </span><br><span class="line">        <span class="comment">//exercise 14</span></span><br><span class="line">        Initialize.salutStatic();</span><br><span class="line">      </span><br><span class="line">        <span class="comment">//exercise 15</span></span><br><span class="line">        Initialize exercise15=<span class="keyword">new</span> Initialize();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>output:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hey autoIni!  autoIni=<span class="number">0</span></span><br><span class="line">Hello staticBlockIni!  staticBlockIni:I was born!</span><br><span class="line">ini block gives me life</span><br><span class="line">constructor gives me life</span><br></pre></td></tr></table></figure></p>
<h3 id="数组的初始化"><a href="#数组的初始化" class="headerlink" title="数组的初始化"></a>数组的初始化</h3><p>关于数组，有两点我以前的误区，</p>
<ol>
<li>练习16为了说明，除了在声明数组的时候，Java不允许像<strong><code>Initialize.fiveStrArray = {&quot;one&quot;,&quot;two&quot;,&quot;three&quot;,&quot;four&quot;,&quot;five&quot;};</code></strong>这样直接为数组赋值。而是必须显式地重新创建对象<strong><code>Initialize.fiveStrArray = new String[] {&quot;one&quot;,&quot;two&quot;,&quot;three&quot;,&quot;four&quot;,&quot;five&quot;};</code></strong>。或者一个一个赋值，像这样<strong><code>Initialize.fiveStrArray[0]=new ArrayNode(&quot;one&quot;);</code></strong>。Java的这个特性并不怎么合理。</li>
<li>练习17，18点出了另一个误区。当我们创建一个新数组的时候，比如<strong><code>ArrayNode[] nodeArray = new ArrayNode[10];</code></strong>。实际JAVA逻辑堆区什么对象也没有创建。只是JVM Stack里创建了一个包含10个<strong><code>null</code></strong>引用的数组：<strong><code>{null,null,null,null,null,null,null,null,null,null}</code></strong>。</li>
</ol>
<h4 id="练习-16"><a href="#练习-16" class="headerlink" title="练习 16"></a>练习 16</h4><p>Create an array of String objects and assign a String to each element. Print the array by using a for loop.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayIni</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//for exercise 16</span></span><br><span class="line">    <span class="comment">//this form is only allowed in initializing block</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> String[] fiveStrArray = &#123;<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//exercise 16</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">exercise16</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(String ele : Initialize.fiveStrArray)&#123;</span><br><span class="line">            System.out.println(ele);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//the following line is wrong, we can not asign an array like that</span></span><br><span class="line">        <span class="comment">//Initialize.fiveStrArray = &#123;"one","two","three","four","five"&#125;;</span></span><br><span class="line">        Initialize.fiveStrArray = <span class="keyword">new</span> String[] &#123;<span class="string">"one"</span>,<span class="string">"two"</span>,<span class="string">"three"</span>,<span class="string">"four"</span>,<span class="string">"five"</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(String ele : Initialize.fiveStrArray)&#123;</span><br><span class="line">            System.out.println(ele);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  main method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        ArrayIni.exercise16();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>output:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">one</span><br><span class="line">two</span><br><span class="line">three</span><br><span class="line">four</span><br><span class="line">five</span><br></pre></td></tr></table></figure></p>
<h4 id="练习-17，18"><a href="#练习-17，18" class="headerlink" title="练习 17，18"></a>练习 17，18</h4><p>Exercise 17: (2) Create a class with a constructor that takes a String argument. During construction, print the argument. Create an array of object references to this class, but don’t actually create objects to assign into the array. When you run the program, notice whether the initialization messages from the constructor calls are printed.</p>
<p>Exercise 18: (1) Complete the previous exercise by creating objects to attach to the array of references.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayNode</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//nothing in fields</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//constructor only print the parameter</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ArrayNode</span><span class="params">(String inParam)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"I am "</span>+inParam+<span class="string">"!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  main method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        ArrayNode[] nodeArray = <span class="keyword">new</span> ArrayNode[<span class="number">10</span>];  <span class="comment">//nothing happend here</span></span><br><span class="line">        nodeArray[<span class="number">0</span>]=<span class="keyword">new</span> ArrayNode(<span class="string">"toto"</span>);     <span class="comment">//output-&gt;toto</span></span><br><span class="line">        nodeArray[<span class="number">1</span>]=<span class="keyword">new</span> ArrayNode(<span class="string">"titi"</span>);     <span class="comment">//output-&gt;titi</span></span><br><span class="line">        nodeArray[<span class="number">2</span>]=<span class="keyword">new</span> ArrayNode(<span class="string">"tata"</span>);     <span class="comment">//output-&gt;tata</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="可变参数列表"><a href="#可变参数列表" class="headerlink" title="可变参数列表"></a>可变参数列表</h3><p>因为Java所有类都继承自一个Object基类。所以，要是我们为函数传递一个Object数组<strong><code>Object[]</code></strong>，就可以接受所有类型的参数。这就是所谓的<strong>可变参数列表</strong>。看下面这个例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VarArgs</span> </span>&#123;</span><br><span class="line">  <span class="comment">//Object[] args 基类数组，由于泛型，可以接受任何类型参数</span>  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(Object[] args)</span> </span>&#123;    <span class="keyword">for</span>(Object obj : args)      System.out.print(obj + <span class="string">" "</span>);    System.out.println();  &#125;  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//任何类型参数，都游刃有余。甚至基本型，也会触发Auto boxing</span>    printArray(<span class="keyword">new</span> Object[]&#123;      <span class="keyword">new</span> Integer(<span class="number">47</span>), <span class="keyword">new</span> Float(<span class="number">3.14</span>), <span class="keyword">new</span> Double(<span class="number">11.11</span>)    &#125;);    printArray(<span class="keyword">new</span> Object[]&#123;<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span> &#125;);    printArray(<span class="keyword">new</span> Object[]&#123;<span class="keyword">new</span> A(), <span class="keyword">new</span> A(), <span class="keyword">new</span> A()&#125;);  &#125;&#125; </span><br><span class="line"><span class="comment">// Output: </span><span class="comment">//	47 3.14 11.11</span><span class="comment">//	one two three</span><span class="comment">//	A@1a46e30 A@3e25a5 A@19821f		//空对象，print()只打印方法名，后跟@他的地址。</span></span><br></pre></td></tr></table></figure></p>
<p>但可变参数列表可能的一个问题是：会导致重载的麻烦。因为可变参数列表会覆盖其他所有特定参数类型的重载方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">float</span> i, Character... args)</span> </span>&#123;  System.out.println(<span class="string">"first"</span>);&#125;</span><br><span class="line"><span class="comment">//可变参数列表会覆盖其他所有特定参数类型的重载方法</span><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">(Character... args)</span> </span>&#123;  System.out.print(<span class="string">"second"</span>);&#125;</span><br></pre></td></tr></table></figure></p>
<p>解决的办法是，只在需要的特定参数类型后面附加可变参数类型。千万不要愣头愣脑直接一个可变参数类型贴上去。</p>
<p>```java<br>  static void f(float i, Character… args) {<br>    System.out.println(“first”);<br>  }<br>  static void f(char c, Character… args) {<br>    System.out.println(“second”);<br>  }<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">J2SE5以后引入一个新特性，可以更简便地使用可变参数列表：</span><br><span class="line">```java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> NewVarArgs &#123;</span><br><span class="line">  <span class="comment">//定义参数的时候这样写Object... args</span>  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(Object... args)</span> </span>&#123;    <span class="keyword">for</span>(Object obj : args)      System.out.print(obj + <span class="string">" "</span>);    System.out.println();  &#125;  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;    <span class="comment">//后面调用方法的时候就不用显式地声明基类数组**`new Object[]`**了。可以直接给参数。</span>    printArray(<span class="keyword">new</span> Integer(<span class="number">47</span>), <span class="keyword">new</span> Float(<span class="number">3.14</span>),      <span class="keyword">new</span> Double(<span class="number">11.11</span>));    printArray(<span class="number">47</span>, <span class="number">3.14F</span>, <span class="number">11.11</span>);    printArray(<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span>);    printArray(<span class="keyword">new</span> A(), <span class="keyword">new</span> A(), <span class="keyword">new</span> A());    <span class="comment">// Or an array:</span>                                      Initialization &amp; Cleanup <span class="number">137</span></span><br><span class="line">     printArray((Object[])<span class="keyword">new</span> Integer[]&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;);    printArray(); <span class="comment">// Empty list is OK</span>  &#125;&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//Output: </span><span class="comment">//	47 3.14 11.11</span><span class="comment">//	47 3.14 11.11</span><span class="comment">//	one two three</span><span class="comment">//	A@1bab50a A@c3c749 A@150bd4d 1234</span></span><br></pre></td></tr></table></figure></p>
<p>我认为这个特性多此一举，原来声明数组不是很清楚吗，现在反而容易引起混乱。不知道老程序猿怎么看。</p>
<h4 id="练习-19"><a href="#练习-19" class="headerlink" title="练习 19"></a>练习 19</h4><p> Write a method that takes a vararg String array. Verify that you can pass either a comma-separated list of Strings or a String[] into this method.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayIni</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//exercise 19: Variable arguments list</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">exercise19</span><span class="params">(Object[] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(Object ele : args)&#123;</span><br><span class="line">            System.out.print(ele+<span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  main method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(Object[] args)</span></span>&#123;</span><br><span class="line">        ArrayIni.exercise19(<span class="keyword">new</span> String[] &#123;<span class="string">"one"</span>,<span class="string">"two"</span>,<span class="string">"three"</span>,<span class="string">"four"</span>&#125;);		<span class="comment">//output: one two three four</span></span><br><span class="line">        String[] myStr = <span class="keyword">new</span> String[] &#123;<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>&#125;;</span><br><span class="line">        ArrayIni.exercise19(myStr);		<span class="comment">//output: a b c d</span></span><br><span class="line">        <span class="comment">//exercise 20</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="枚举型"><a href="#枚举型" class="headerlink" title="枚举型"></a>枚举型</h3><p>定义枚举类型：用enum关键字开始，不同的枚举在大括号里用逗号隔开。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> RainbowColor &#123; RED, ORANGE, YELLOW, GREEN, CYAN, BLUE, PURPLE &#125;</span><br></pre></td></tr></table></figure></p>
<p>例子中定义了一个名为<strong><code>RainbowColor</code></strong>的枚举型，他是由赤橙黄绿青蓝紫，七个具名值组成的有限集合。要使用<strong><code>RainbowColor</code></strong>这个枚举型，需要创建指向它具体值的一个引用：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RainbowColor firstColor = RainbowColor.RED;</span><br><span class="line">RainbowColor secondColor = RainbowColor.ORANGE;</span><br><span class="line"></span><br><span class="line">System.out.println(firstColor);</span><br><span class="line">System.out.println(secondColor);</span><br></pre></td></tr></table></figure></p>
<p>枚举型和switch语句是绝配，它的有限常量集合可以用在switch语句里。解决了switch语句只接受基本型数据的尴尬。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一周七天的枚举类型			</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> WeekDayEnum &#123; Mon, Tue, Wed, Thu, Fri, Sat, Sun &#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取当天的信息</span></span><br><span class="line">WeekDayEnum today = readToday(); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据日期来选择进行活动</span></span><br><span class="line"><span class="keyword">switch</span>(today) &#123; </span><br><span class="line"> Mon: do something; <span class="keyword">break</span>; </span><br><span class="line"> Tue: do something; <span class="keyword">break</span>; </span><br><span class="line"> Wed: do something; <span class="keyword">break</span>; </span><br><span class="line"> Thu: do something; <span class="keyword">break</span>; </span><br><span class="line"> Fri: do something; <span class="keyword">break</span>; </span><br><span class="line"> Sat: play sports game; <span class="keyword">break</span>; </span><br><span class="line"> Sun: have a rest; <span class="keyword">break</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="练习-21，22"><a href="#练习-21，22" class="headerlink" title="练习 21，22"></a>练习 21，22</h4><p>这题因为不知道钞票的面值是多少，我稍微改了下，改成游戏的难度等级。<br>Exercise 21: (1) Create an enum of the least-valuable six types of paper currency. Loop through the values( ) and print each value and its ordinal( ).<br>Exercise 22: (2) Write a switch statement for the enum in the previous example. For each case, output a description of that particular currency.</p>
<p>从这道题能看出，<strong>枚举型本身就是一个类</strong>。比如我创建了一个包含<strong><code>EASY</code></strong>, <strong><code>NORMAL</code></strong>, <strong><code>HARD</code></strong>, <strong><code>VERYHARD</code></strong>四个常量的枚举型，名叫<strong><code>Difficulty</code></strong>。声明的语句，完全不用放在class Enum的大括号里。而是可以独立地放在外面。编译完成以后，会在Java包里多出一个<strong><code>Difficulty.class</code></strong>的类文件。<br><img src="/uploads/tij4-5/enumDifficulty.png" alt="enumDifficulty"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//由Difficulty.class反向编译生成的代码</span></span><br><span class="line">Compiled from <span class="string">"Enum.java"</span></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">ciaoshen</span>.<span class="title">thinkinjava</span>.<span class="title">chapter5</span>.<span class="title">Difficulty</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Enum</span>&lt;<span class="title">com</span>.<span class="title">ciaoshen</span>.<span class="title">thinkinjava</span>.<span class="title">chapter5</span>.<span class="title">Difficulty</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.ciaoshen.thinkinjava.chapter5.Difficulty EASY;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.ciaoshen.thinkinjava.chapter5.Difficulty NORMAL;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.ciaoshen.thinkinjava.chapter5.Difficulty HARD;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.ciaoshen.thinkinjava.chapter5.Difficulty VERYHARD;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> com.ciaoshen.thinkinjava.chapter5.Difficulty[] $VALUES;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> com.ciaoshen.thinkinjava.chapter5.Difficulty[] values();</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> com.ciaoshen.thinkinjava.chapter5.<span class="function">Difficulty <span class="title">valueOf</span><span class="params">(java.lang.String)</span></span>;</span><br><span class="line">  <span class="keyword">private</span> com.ciaoshen.thinkinjava.chapter5.Difficulty();</span><br><span class="line">  <span class="keyword">static</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>包里的<strong><code>Enum.java</code></strong>是我写的源代码文件，<strong><code>Enum.class</code></strong>是生成的字节码文件。多出来的两个东西，一个<strong><code>Difficulty.class</code></strong>就是我们关心的枚举型Difficulty的字节码，还有一个<strong><code>Enum$1.class</code></strong>是switch语句产生的另一个字节码文件。用<strong><code>javap -private</code></strong>反向编译，可以看到<strong><code>java.lang.Enum&lt;T&gt;</code></strong>实际是个泛型集合，Difficulty类型实际是从<strong><code>java.lang.Enum&lt;Difficulty&gt;</code></strong>继承下来的子类。这是一个套嵌的结构。Difficulty型本身就是Difficulty型组成的枚举集合的子类。也就是它自己的集合就是他本身。有点像LinkedList每个节点都包含一个指向另一个节点的指针的感觉。下图是Java Doc里Enum的说明，<strong><code>Class Enum&lt;E extends Enum&lt;E&gt;&gt;</code></strong>很明显是个套嵌结构。21题用到的<strong><code>ordinal()</code></strong>就是其中一个成员方法。<br><img src="/uploads/tij4-5/enum1.png" alt="enum1"><br><img src="/uploads/tij4-5/enum2.png" alt="enum2"></p>
<p>下面是21，22题的代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line"> *  Enum type</span><br><span class="line"> *  <span class="doctag">@author</span> wei.shen<span class="doctag">@iro</span>.umontreal.ca</span><br><span class="line"> *  <span class="doctag">@version</span> 1.0</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.ciaoshen.thinkinjava.chapter5;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">//enum class</span></span><br><span class="line"><span class="keyword">enum</span> Difficulty &#123;EASY, NORMAL, HARD, VERYHARD&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> *  our class</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Enum</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//exercise 22</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">interpreter</span><span class="params">(Difficulty diff)</span></span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(diff)&#123;</span><br><span class="line">            <span class="keyword">case</span> EASY:</span><br><span class="line">                System.out.println(<span class="string">"Easy is for the beginner！"</span>); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> NORMAL:</span><br><span class="line">                System.out.println(<span class="string">"Normal is for those who have some experience！"</span>); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> HARD:</span><br><span class="line">                System.out.println(<span class="string">"Hard is for good players！"</span>); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> VERYHARD:</span><br><span class="line">                System.out.println(<span class="string">"Very hard is for the super master！"</span>); <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//exercise 21</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printEnumValue</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(Difficulty d : Difficulty.values())&#123;</span><br><span class="line">            System.out.println(<span class="string">"Value: "</span>+d+<span class="string">";   Order: "</span>+d.ordinal());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line">     *  main method</span><br><span class="line">     *  <span class="doctag">@param</span> args void</span><br><span class="line">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    	<span class="comment">//exercise 22</span></span><br><span class="line">        Enum.interpreter(Difficulty.EASY);</span><br><span class="line">        Enum.interpreter(Difficulty.NORMAL);</span><br><span class="line">        Enum.interpreter(Difficulty.HARD);</span><br><span class="line">        Enum.interpreter(Difficulty.VERYHARD);</span><br><span class="line">        <span class="comment">//exercise 21</span></span><br><span class="line">        Enum.printEnumValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>output:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//exercise 22</span></span><br><span class="line">Easy is <span class="keyword">for</span> the beginner！</span><br><span class="line">Normal is <span class="keyword">for</span> those who have some experience！</span><br><span class="line">Hard is <span class="keyword">for</span> good players！</span><br><span class="line">Very hard is <span class="keyword">for</span> the <span class="keyword">super</span> master！</span><br><span class="line"></span><br><span class="line"><span class="comment">//exercise 21</span></span><br><span class="line">Value: EASY;   Order: <span class="number">0</span></span><br><span class="line">Value: NORMAL;   Order: <span class="number">1</span></span><br><span class="line">Value: HARD;   Order: <span class="number">2</span></span><br><span class="line">Value: VERYHARD;   Order: <span class="number">3</span></span><br></pre></td></tr></table></figure></p>

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/03/14/justForJoke/" rel="next" title="总会有的疑惑">
                <i class="fa fa-chevron-left"></i> 总会有的疑惑
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/03/15/javaGC/" rel="prev" title="Java垃圾回收初探">
                Java垃圾回收初探 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/shenAvatar.jpg"
               alt="沈玮 | Wei SHEN" />
          <p class="site-author-name" itemprop="name">沈玮 | Wei SHEN</p>
          <p class="site-description motion-element" itemprop="description">Coder & Designer</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">13</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">43</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/helloShen" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.douban.com/people/72441576/" target="_blank">
                  
                    <i class="fa fa-globe"></i> DouBan
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/pang-pang-37-37" target="_blank">
                  
                    <i class="fa fa-globe"></i> ZhiHu
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#摘要"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#构造函数"><span class="nav-number">2.</span> <span class="nav-text">构造函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习1，2"><span class="nav-number">2.1.</span> <span class="nav-text">练习1，2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法的重载"><span class="nav-number">3.</span> <span class="nav-text">方法的重载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#参数的“自动提升”和“窄化转型”"><span class="nav-number">3.1.</span> <span class="nav-text">参数的“自动提升”和“窄化转型”</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-3-4"><span class="nav-number">3.2.</span> <span class="nav-text">练习 3,4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-5-6"><span class="nav-number">3.3.</span> <span class="nav-text">练习 5,6</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-7"><span class="nav-number">3.4.</span> <span class="nav-text">练习 7</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#this关键字"><span class="nav-number">4.</span> <span class="nav-text">this关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#把this当参数传递"><span class="nav-number">4.1.</span> <span class="nav-text">把this当参数传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在构造器中调用另一个构造器"><span class="nav-number">4.2.</span> <span class="nav-text">在构造器中调用另一个构造器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编程风格：-不必到处用this"><span class="nav-number">4.3.</span> <span class="nav-text">编程风格： 不必到处用this</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#finalize-函数"><span class="nav-number">5.</span> <span class="nav-text">finalize()函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-10，11"><span class="nav-number">5.1.</span> <span class="nav-text">练习 10，11</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-12"><span class="nav-number">5.2.</span> <span class="nav-text">练习 12</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#垃圾回收"><span class="nav-number">6.</span> <span class="nav-text">垃圾回收</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#成员变量初始化"><span class="nav-number">7.</span> <span class="nav-text">成员变量初始化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-14-15"><span class="nav-number">7.1.</span> <span class="nav-text">练习 14,15</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组的初始化"><span class="nav-number">8.</span> <span class="nav-text">数组的初始化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-16"><span class="nav-number">8.1.</span> <span class="nav-text">练习 16</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-17，18"><span class="nav-number">8.2.</span> <span class="nav-text">练习 17，18</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可变参数列表"><span class="nav-number">9.</span> <span class="nav-text">可变参数列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-19"><span class="nav-number">9.1.</span> <span class="nav-text">练习 19</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#枚举型"><span class="nav-number">10.</span> <span class="nav-text">枚举型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-21，22"><span class="nav-number">10.1.</span> <span class="nav-text">练习 21，22</span></a></li></ol></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">沈玮 | Wei SHEN</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io" rel="external nofollow">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>

</br>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<div>
  <span id="busuanzi_container_site_pv">
  Visited  <span id="busuanzi_value_site_pv"></span>  times
  </span>

<span id="busuanzi_container_site_pv">&nbsp; &nbsp; | &nbsp; &nbsp;</span>

  <span id="busuanzi_container_site_uv">
  <span id="busuanzi_value_site_uv"></span>  Visitors
  </span>
<div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  
  
<script type="text/javascript" src="/js/src/scrollspy.js?v=0.5.0"></script>

<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = NexT.utils.escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    NexT.motion.middleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');

      if (CONFIG.sidebar.display === 'post' || CONFIG.sidebar.display === 'always') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          NexT.utils.displaySidebar();
        }
      }
    };
  });
</script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  

  
  


</body>
</html>
