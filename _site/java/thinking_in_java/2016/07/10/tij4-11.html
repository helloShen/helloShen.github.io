<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Thinking {SHEN}</title>

    <!-- Bootstrap Core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Blog Template CSS -->
    <link href="/assets/css/blog.css" rel="stylesheet">
    <!-- jQuery Version 1.11.1 -->
    <script src="/assets/js/jquery.js"></script>
    <!-- footer bar -->
    <link href="/assets/css/footer.css" rel="stylesheet">
    <!-- code highlight. I also have other options. But this one looks good! -->
    <link href="/assets/css/jekyll-github.css" rel="stylesheet">
    <!-- Sidebar -->
    <!--<link href="/assets/css/sidebar.css" rel="stylesheet">-->


    <!-- Custom CSS -->
    <style>
        body {
            padding-top: 70px;
            /* Required padding for .navbar-fixed-top. Remove if using .navbar-static-top. Change if height of navigation changes. */
        }
        .container {
            width: 80%;
        }
    </style>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="">Thinking {SHEN}</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="/resume/">Resume</a>
                    </li>
                    <li>
                        <a href="/thinkinginjava/">Thinking in Java</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Container -->
    <div class="container">

        <!-- Page Title -->
        <div class="text-center">
      <!-- page-header是Bootstrap内置页头组件 -->
      <div class="page-header">
          <h1>[Thinking in Java] Note: Chapter 11 - Container</h1>
      </div>
      <h5 class="blog-post-meta">
                <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span> &nbsp
                2016-07-10 10:32:36 -0400
                &nbsp | &nbsp
                <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> &nbsp
            
                <a href="/categories/Java.html"><span class="label label-primary"><b>Java</b></span></a>
                &nbsp
            
                <a href="/categories/Thinking_in_Java.html"><span class="label label-primary"><b>Thinking_in_Java</b></span></a>
                &nbsp
            
                &nbsp | &nbsp
                <span class="glyphicon glyphicon-comment" aria-hidden="true"></span> &nbsp
                <a href="#disqus_thread "></a>
      </h5>
      <h5 class="blog-post-meta">
          <span class="glyphicon glyphicon-tags" aria-hidden="true"></span> &nbsp
          
              <a href="/tags/Container.html"><span class="label label-default">Container</span></a>
              &nbsp
          
              <a href="/tags/Array.html"><span class="label label-default">Array</span></a>
              &nbsp
          
      </h5>
</div>


        <!-- Page Content -->
        <h3 id="array不是一般意义上的容器">Array不是一般意义上的“容器”</h3>
<p>讲容器之前，请允许我先把Array和其他所有的容器区分开来。它是Java语言内置(compiler-supported type)的数据类型，它是<strong>唯一可以存放基本型的容器</strong>。而且Array非常地高效。
这里有一篇好文章：<a href="http://www.ibm.com/developerworks/cn/java/j-arrays/"><strong>《历史上的 Collection 类 ― 数组》</strong></a>，可以帮助我们了解Array的基本情况。</p>

<p>Array为什么效率高呢？这要从Array本身在内存中的结构说起（下图）：
<img src="/images/tij4-11/ArrayMemory1.jpg" alt="ArrayMemory1" />
对于Array的具体实现，有下面几个重要事实：</p>
<ul>
  <li>Array是一个对象<strong>Object</strong></li>
  <li>Array在Stack栈区只占一个“<strong>long</strong>”型，储存指向在Heap堆区的实际数据首地址的<strong>引用</strong></li>
  <li>Array在Heap堆区的具体数据，所占的是“<strong>连续空间</strong>”</li>
</ul>

<p><img src="/images/tij4-11/ArrayMemory2.jpg" alt="ArrayMemory2" />
如上图，多维数组的实现方式，是靠一个“引用的数组”来过度的。第一层数组的每一个地址，只储存指向具体数据数组的一个引用。</p>

<p>Array效率高的秘密，就在于它在内存中占据的空间是连续的。因此如下图，只要掌握了在内存中的首地址，以及数组的长度，对于任意想要的元素，数组只要在首地址基础上加上偏移值，就能找到该元素。而对内存的操作，seek偏移值的开销是非常小的。
<img src="/images/tij4-11/ArrayMemory3.gif" alt="ArrayMemory2" /></p>

<p>但连续空间是把双刃剑，副作用是Array<strong>声明的时候必须固定长度，之后不能修改</strong>。这极大地限制了Array的使用，因为大多数的使用场景，声明数据的时候，并不知道我们需要多大的容器。这才导致了后面其他容器的出现。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kt">int</span><span class="o">[]</span> <span class="n">myArray</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
</code></pre>
</div>

<p>由于Java类库已经经历了近20年的改进和打磨，java容器的效率已经有了明显的提升，尤其随着应用场景的复杂化，说Array的效率完胜容器已经不合时宜了。对一些常用的操作，比如说批量插入，或者遍历，容器提供的现成方法的效率，已经可以完胜我们自己用Array慢慢瞎捣鼓的代码了。更不用说对于更复杂的比如说并发应用。自己动手造轮子的时代已经过去了。</p>

<h3 id="javautil类库中的容器">java.util类库中的容器</h3>
<p>先声明，这一章只负责告诉读者一些关于util类库定义的容器的一些有用的结论，来帮助我们在编程的时候尽量选择正确合适的容器。至于容器内部的一些算法细节，会在之后的《容器深谈》这一章中探讨。</p>

<p>Java类库java.util提供的容器到底有哪些？下面这张图略简陋，但有助于整理思路。
<img src="/images/tij4-11/container.png" alt="container" /></p>

<h4 id="容器两大分支collection和map">容器两大分支：Collection和Map</h4>
<p>uitl类库容器的共同特征是：<strong>动态调节长度</strong>。为了弥补Array固定长度的遗憾。
但鱼和熊掌不可兼得。实现动态扩展数组长度，必然就要牺牲效率，为它们的弹性付出代价。因此它们的效率都不如Array。但它们之所以存在，除了动态长度外，都具备各自特色的功能，各有所长。</p>

<p>总的来说，容器分为两大类，都以接口形式存在，</p>
<ol>
  <li><strong>Collection</strong> 指的是一组元素的集合。强调的是元素本身。</li>
  <li><strong>Map</strong> 的特殊功用在于它为每个元素维护的一组“KEY-VALUE”对。Key用来搜索value值。典型的应用就是“词典”。</li>
</ol>

<h4 id="collection的三大将">Collection的三大将</h4>
<p>它们也都是接口，而且各有所长，</p>
<ol>
  <li><strong>List</strong>：最正统。强调“<strong>一组元素的序列</strong>”。通常是元素插入集合时候的顺序。</li>
  <li><strong>Set</strong>：的特点是其中<strong>元素的唯一性</strong>。插入新元素前会检查已有列表，如果已经有了，就不会再插入。</li>
  <li><strong>Queue</strong>：虽然也强调的是序列，但更主要的是“<strong>获取下一个元素的顺序</strong>”。最简单的一种就是“FIFO(First In First Out)”先进先出。</li>
</ol>

<h4 id="关于list">关于List</h4>
<p>事实上最常用的List只需要记住两种，</p>
<ol>
  <li>ArrayList</li>
  <li>LinkedList</li>
</ol>

<p>剩下一个<strong>Vector</strong>被作者说成是过时的容器，不推荐使用。而另一个<strong>CopyOnWriteList</strong>是用于并发系统，确保多线程访问时数据同步安全性的，不属于常规使用。</p>

<p>ArrayList和LinkedList它们俩个经常被拿来比较性能。互为对方一生的羁绊。关于它们俩，需要记住的重要事实是，</p>
<ol>
  <li>ArrayList的实现基于Array。<strong>精髓在于：随机访问get(int index)方法。复杂度是常数</strong>O(1)。** 但缺点是:add(int index, <E> element)，remove(int index)的时候要逐个前移或后移操作位后面的所有元素，所以复杂度是O(n)。</E></li>
  <li><strong>LinkedList的精髓在于同时实现了Queue的接口。</strong> 在Queue只是个接口，以及Java官方枪毙Stack的情况下，无论是FIFO还是LIFO，都要靠LinkedList来扛起大旗。</li>
  <li><strong>总体性能ArrayList完胜。</strong> 并不像传说的LinkedList更善于插入和删除动作。LinkedList的add(int index, <E> element)和remove(int index)方法，复杂度要实现O(1)的前提是，你必须提前获得操作元素的引用。不然LinkedList还是需要遍历到那个元素，最坏的情况下仍然是O(n)复杂度。StackOverFlow上关于这个问题的回答：[**《How is LinkedList's add(int, E) of O(1) complexity?》**](http://stackoverflow.com/questions/15732334/how-is-linkedlists-addint-e-of-o1-complexity)</E></li>
</ol>

<p>这里附上1. ArrayList和LinkedList的几个重要操作的复杂度对比：
<img src="/images/tij4-11/ll_al.png" alt="ll_al" /></p>

<h4 id="arraylist的实现">ArrayList的实现</h4>
<p>虽然说好了这章不细究具体实现。但还是忍不住看了一眼java.util.ArrayList的源代码。贴几个重要的片段上来，共赏。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">AbstractList</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span>  <span class="kd">implements</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;,</span> <span class="n">RandomAccess</span><span class="o">,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">io</span><span class="o">.</span><span class="na">Serializable</span> <span class="o">{}</span>
</code></pre>
</div>
<p>英雄先问出处，ArrayList继承自AbstractList<E>，是对List接口的一个通用实现。后面实现了4种接口，除了最重要的List<E>之外，Cloneable接口为了调用Object.clone()方法。其他两个RandomAccess和Serializable都是标记型接口，只为了语义功能，并没有定义任何内容。</E></E></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>     <span class="cm">/**
      * The array buffer into which the elements of the ArrayList are stored.
      * The capacity of the ArrayList is the length of this array buffer.
      */</span>
     <span class="kd">private</span> <span class="kd">transient</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">elementData</span><span class="o">;</span>	<span class="c1">//ArrayList基于Array实现</span>

     <span class="cm">/**
      * The size of the ArrayList (the number of elements it contains).
      *
      * @serial
      */</span>
     <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>
</code></pre>
</div>
<p>接下来看成员字段。关键看到<strong>Object[] elementData</strong>，就知道ArrayList和传说中一样，是基于Array实现的。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>	<span class="cm">/**
     * Constructs an empty list with the specified initial capacity.
     */</span>
    <span class="kd">public</span> <span class="nf">ArrayList</span><span class="o">(</span><span class="kt">int</span> <span class="n">initialCapacity</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">initialCapacity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Illegal Capacity: "</span><span class="o">+</span>
                                               <span class="n">initialCapacity</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">elementData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">initialCapacity</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Constructs an empty list with an initial capacity of ten.
     */</span>
    <span class="kd">public</span> <span class="nf">ArrayList</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>	<span class="c1">//默认长度10</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Constructs a list containing the elements of the specified
     * collection, in the order they are returned by the collection's
     * iterator.
     */</span>
    <span class="kd">public</span> <span class="nf">ArrayList</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">E</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">elementData</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">toArray</span><span class="o">();</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">elementData</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="c1">// c.toArray might (incorrectly) not return Object[] (see 6260652)</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">elementData</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">!=</span> <span class="n">Object</span><span class="o">[].</span><span class="na">class</span><span class="o">)</span>
        <span class="n">elementData</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">elementData</span><span class="o">,</span> <span class="n">size</span><span class="o">,</span> <span class="n">Object</span><span class="o">[].</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre>
</div>
<p>3种构造函数，对应于3种不同的声明方式。可以看到，ArrayList的默认初始大小是10。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">E</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">ensureCapacity</span><span class="o">(</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>  <span class="c1">// Increments modCount!! 可变长度由这个方法实现</span>
    <span class="n">elementData</span><span class="o">[</span><span class="n">size</span><span class="o">++]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
</div>
<p>这一段是add()方法。看到ensureCapacity(size + 1)这里，ArrayList的可变长度的功能就在这个方法里了。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
     * Increases the capacity of this &lt;tt&gt;ArrayList&lt;/tt&gt; instance, if
     * necessary, to ensure that it can hold at least the number of elements
     * specified by the minimum capacity argument.
     *
     * @param   minCapacity   the desired minimum capacity
     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensureCapacity</span><span class="o">(</span><span class="kt">int</span> <span class="n">minCapacity</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">modCount</span><span class="o">++;</span>
    <span class="kt">int</span> <span class="n">oldCapacity</span> <span class="o">=</span> <span class="n">elementData</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">minCapacity</span> <span class="o">&gt;</span> <span class="n">oldCapacity</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">oldData</span><span class="o">[]</span> <span class="o">=</span> <span class="n">elementData</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">newCapacity</span> <span class="o">=</span> <span class="o">(</span><span class="n">oldCapacity</span> <span class="o">*</span> <span class="mi">3</span><span class="o">)/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>	<span class="c1">//关键算法：不够了长度就乘以1.5</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">newCapacity</span> <span class="o">&lt;</span> <span class="n">minCapacity</span><span class="o">)</span>
        <span class="n">newCapacity</span> <span class="o">=</span> <span class="n">minCapacity</span><span class="o">;</span>
            <span class="c1">// minCapacity is usually close to size, so this is a win:</span>
            <span class="n">elementData</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">copyOf</span><span class="o">(</span><span class="n">elementData</span><span class="o">,</span> <span class="n">newCapacity</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="o">}</span>
</code></pre>
</div>
<p>可变长度ensureCapacity()方法长这样，代码里一行关键的算法，透露了ArrayList的动态控制长度功能，是在长度不够的时候扩展为原来的1.5倍。不要小看这个简单的1.5倍。肯定是无数次实验的最优配置。智慧的结晶啊。</p>

<p>不能再写下去了，这没有底。以后专门写一个读JDK源代码的笔记吧。</p>

<h5 id="linkedlist的实现">LinkedList的实现</h5>
<p>java.util.LinkedList的源代码也只贴几个重要的片段上来，共赏。先看一个LinkedList数据结构的简单图解，</p>

<p><img src="/images/tij4-11/linkedlist.jpg" alt="linkedlist" />
双链LinkedList的数据结构很简单，由一系列节点组成。每个节点包含一个数据储存单元，和两个指针，分别指向序列中的前一个节点，以及下一个节点。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">// 链表的表头，表头不包含任何数据。Entry是个链表类数据结构。</span>
<span class="kd">private</span> <span class="kd">transient</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">header</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>

<span class="c1">// LinkedList中元素个数</span>
<span class="kd">private</span> <span class="kd">transient</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</code></pre>
</div>
<p>上面两行就能看出，LinkedList里的节点名叫Entry<E>。初始化的时候只有一个header节点。下面再看节点的数据结构，</E></p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">// 双向链表的节点所对应的数据结构。</span>
<span class="c1">// 包含3部分：上一节点，下一节点，当前节点值。</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="c1">// 当前节点所包含的值</span>
<span class="n">E</span> <span class="n">element</span><span class="o">;</span>
<span class="c1">// 下一个节点</span>
<span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>
<span class="c1">// 上一个节点</span>
<span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">previous</span><span class="o">;</span>

	<span class="cm">/**
	* 链表节点的构造函数。
	* 参数说明：
	*   element  —— 节点所包含的数据
	*   next      —— 下一个节点
	*   previous —— 上一个节点
	*/</span>
	<span class="n">Entry</span><span class="o">(</span><span class="n">E</span> <span class="n">element</span><span class="o">,</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">,</span> <span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">previous</span><span class="o">)</span> <span class="o">{</span>
    	<span class="k">this</span><span class="o">.</span><span class="na">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">;</span>
    	<span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
    	<span class="k">this</span><span class="o">.</span><span class="na">previous</span> <span class="o">=</span> <span class="n">previous</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>也很简单，就像之前说的，中间一个element泛型数据本体，一前一后两个指向前一个和下一个节点的指针。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">// 将节点从链表中删除</span>
<span class="kd">private</span> <span class="n">E</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">==</span> <span class="n">header</span><span class="o">)</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">NoSuchElementException</span><span class="o">();</span>

    <span class="n">E</span> <span class="n">result</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">element</span><span class="o">;</span>	<span class="c1">//复制本体</span>
    <span class="n">e</span><span class="o">.</span><span class="na">previous</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>	<span class="c1">//让前一节点的指针跳过它，直接连到它的下一个节点。</span>
	<span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">.</span><span class="na">previous</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">previous</span><span class="o">;</span>	<span class="c1">//相反操作</span>
	<span class="n">e</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">previous</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>	<span class="c1">//消灭节点</span>
	<span class="n">e</span><span class="o">.</span><span class="na">element</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>	<span class="c1">//消灭节点</span>
	<span class="n">size</span><span class="o">--;</span>
	<span class="n">modCount</span><span class="o">++;</span>
	<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
</div>
<p>LinkedList所谓效率胜过ArrayList的remove()方法，每次删除都分两步走：</p>
<ul>
  <li>给目标节点的前一结点，和后一节点牵线搭桥，架空目标节点</li>
  <li>删除目标节点</li>
</ul>

<h4 id="关于map">关于Map</h4>
<p>已经说过，Map的特殊功用在于它为每个元素维护的一组“KEY-VALUE”对。Key用来搜索value值。选用Map的目的在于用户关心根据元素key搜寻元素value值的速度，而对元素在容器中的顺序不在乎。Map就相当于一个小型的搜索引擎。</p>

<p>Map手下最常用的是HashMap。它的 <strong>get(Object key)</strong> 方法效率最高。大多数情况下，能达到Array的 <strong>O(1)</strong> 的表现。我这里不想太深入，简单讲几点HashMap实现的大致原理，但实际上HashMap实现的每一步都是值得深究的。</p>

<p><img src="/images/tij4-11/hashMap.png" alt="hashMap" />
如上图，</p>
<ul>
  <li>HashMap是由Array和LinkedList共同组成的。(Java 8当链表太长的时候，会自动变成红黑树。)</li>
  <li>先开一个很大的Array数组(size=capacity)。</li>
  <li>元素直接存放在以hash值为下标的Array槽内。</li>
  <li>如果碰撞了，以链表的形式存在Array槽后；</li>
</ul>

<p><strong>put(K key, V value)</strong> 方法的步骤如下，</p>
<ul>
  <li>对key的hashCode()做hash，然后再计算index;（都是简单的位操作，常数复杂度 O(1)）</li>
  <li>直接根据hash值来访问Array的下标。如果没碰撞直接放到bucket里；O(1)；</li>
  <li>如果碰撞了，以链表的形式存在buckets后；往后插的过程是要遍历链表每个节点的。所以碰撞严重的话，对HashMap的性能影响严重。</li>
  <li>如果碰撞导致链表过长(大于等于TREEIFY_THRESHOLD)，就把链表转换成红黑树；O(logn)；</li>
  <li>如果节点已经存在就替换old value(保证key的唯一性)</li>
  <li>如果bucket满了(超过load factor*current capacity)，就要resize。</li>
</ul>

<p>综上所述，Java 8开始改成红黑树以后，一般情况下，put(K key, V value)动作是常数复杂度O(1)。最坏情况碰撞严重，最多O(logn)。还是可以接受的。</p>

<p><strong>get(Object key)</strong> 方法的步骤如下，</p>
<ul>
  <li>bucket里的第一个节点，直接命中，O(1)；</li>
  <li>如果有冲突，则通过key.equals(k)去查找对应的entry</li>
  <li>若为树，则在树中通过key.equals(k)查找，O(logn)；</li>
  <li>若为链表，则在链表中通过key.equals(k)查找，O(n)。</li>
</ul>

<p>综上所述，和插入put()方法一样，Java 8开始改成红黑树以后，一般情况下，搜索get(Object key)动作是常数复杂度O(1)。最坏情况碰撞严重，最多O(logn)。</p>

<p>看下面的HashMap的源码，可以清楚地看到HashMap也是基于Array实现复杂度为O(1)的快速随机访问。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">public</span> <span class="nf">HashMap</span><span class="o">(</span><span class="kt">int</span> <span class="n">initialCapacity</span><span class="o">,</span> <span class="kt">float</span> <span class="n">loadFactor</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">initialCapacity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Illegal initial capacity: "</span> <span class="o">+</span>
                                               <span class="n">initialCapacity</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">initialCapacity</span> <span class="o">&gt;</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">)</span>
            <span class="n">initialCapacity</span> <span class="o">=</span> <span class="n">MAXIMUM_CAPACITY</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">loadFactor</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">Float</span><span class="o">.</span><span class="na">isNaN</span><span class="o">(</span><span class="n">loadFactor</span><span class="o">))</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Illegal load factor: "</span> <span class="o">+</span>
                                               <span class="n">loadFactor</span><span class="o">);</span>

        <span class="c1">// Find a power of 2 &gt;= initialCapacity</span>
        <span class="kt">int</span> <span class="n">capacity</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">capacity</span> <span class="o">&lt;</span> <span class="n">initialCapacity</span><span class="o">)</span>
            <span class="n">capacity</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="o">;</span>

        <span class="k">this</span><span class="o">.</span><span class="na">loadFactor</span> <span class="o">=</span> <span class="n">loadFactor</span><span class="o">;</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">capacity</span> <span class="o">*</span> <span class="n">loadFactor</span><span class="o">,</span> <span class="n">MAXIMUM_CAPACITY</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">table</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Entry</span><span class="o">[</span><span class="n">capacity</span><span class="o">];</span>	<span class="c1">//这一行，证明HashMap也是基于Array实现复杂度为O(1)的快速随机访问</span>
        <span class="n">useAltHashing</span> <span class="o">=</span> <span class="n">sun</span><span class="o">.</span><span class="na">misc</span><span class="o">.</span><span class="na">VM</span><span class="o">.</span><span class="na">isBooted</span><span class="o">()</span> <span class="o">&amp;&amp;</span>
                <span class="o">(</span><span class="n">capacity</span> <span class="o">&gt;=</span> <span class="n">Holder</span><span class="o">.</span><span class="na">ALTERNATIVE_HASHING_THRESHOLD</span><span class="o">);</span>
        <span class="n">init</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre>
</div>

<p>下面这个是HashMap的hash算法。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">final</span> <span class="kt">int</span> <span class="nf">hash</span><span class="o">(</span><span class="n">Object</span> <span class="n">k</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">useAltHashing</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">k</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">sun</span><span class="o">.</span><span class="na">misc</span><span class="o">.</span><span class="na">Hashing</span><span class="o">.</span><span class="na">stringHash32</span><span class="o">((</span><span class="n">String</span><span class="o">)</span> <span class="n">k</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hashSeed</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">h</span> <span class="o">^=</span> <span class="n">k</span><span class="o">.</span><span class="na">hashCode</span><span class="o">();</span>	<span class="c1">//k的哈希值和哈希种子做异或运算（哈希种子为零，就相当于保留哈希值）</span>
							<span class="c1">//异或：相同则结果为0，不同则结果为1</span>

        <span class="c1">// This function ensures that hashCodes that differ only by</span>
        <span class="c1">// constant multiples at each bit position have a bounded</span>
        <span class="c1">// number of collisions (approximately 8 at default load factor).</span>
        <span class="n">h</span> <span class="o">^=</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">20</span><span class="o">)</span> <span class="o">^</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">12</span><span class="o">);</span>	<span class="c1">//h和他自己的右位移20位做异或，再和它的右位移12为做异或。</span>
        <span class="k">return</span> <span class="n">h</span> <span class="o">^</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">7</span><span class="o">)</span> <span class="o">^</span> <span class="o">(</span><span class="n">h</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">4</span><span class="o">);</span>	<span class="c1">//h再和他自己的右位移7位做异或，再和它的右位移4为做异或。</span>
    <span class="o">}</span>
</code></pre>
</div>
<p>HashMap的Hash算法具体过程如下，</p>
<ul>
  <li>前面一个if先不管它。</li>
  <li>通过hashCode()方法获取key的哈希值，和哈希种子做异或运算（哈希种子为零，就相当于保留哈希值）（hashCode()函数先当他黑箱）</li>
  <li>h和他自己的右位移20位做异或，再和它的右位移12为做异或。</li>
  <li>h再和他自己的右位移7位做异或，再和它的右位移4为做异或。</li>
</ul>

<p>我还不太明白这算法背后的数学意义，但一点是肯定的，从java的hash()算法因为只是简单的位操作，复杂度是常数O(1)。</p>

<p>我另外一个好奇的事是这个Java每个对象自带的 <strong>Object.hashCode()</strong> 方法，到底是怎么返回哈希值的。毕竟HashMap的代码也都只是在系统给的哈希值的基础上做文章。StackOverFlow该问题的最高票答案<a href="http://stackoverflow.com/questions/2427631/how-is-hashcode-calculated-in-java"><strong>《How is hashCode() calculated in Java?》</strong></a>是这样说的：</p>
<blockquote>
  <p>hashCode()是每个对象自带的方法。但几乎每个类都会重写这个方法。所以hashCode()的哈希值计算方法每种数据类型都是不同的。</p>
</blockquote>

<p>下面举两个最常用的例子，int整型的哈希值等于它本身。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>   <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
       <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
   <span class="o">}</span>
</code></pre>
</div>
<p>String的哈希值算法稍微复杂一点，基本就是根据它自身的长度迭代，每次都乘以31再加上它的偏移值。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>   <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
       <span class="kt">int</span> <span class="n">h</span> <span class="o">=</span> <span class="n">hash</span><span class="o">;</span>
       <span class="k">if</span> <span class="o">(</span><span class="n">h</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
           <span class="kt">int</span> <span class="n">off</span> <span class="o">=</span> <span class="n">offset</span><span class="o">;</span>
           <span class="kt">char</span> <span class="n">val</span><span class="o">[]</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
           <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">count</span><span class="o">;</span>
		   <span class="c1">//关键算法在这里</span>
           <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
               <span class="n">h</span> <span class="o">=</span> <span class="mi">31</span><span class="o">*</span><span class="n">h</span> <span class="o">+</span> <span class="n">val</span><span class="o">[</span><span class="n">off</span><span class="o">++];</span>
           <span class="o">}</span>
           <span class="n">hash</span> <span class="o">=</span> <span class="n">h</span><span class="o">;</span>
       <span class="o">}</span>
       <span class="k">return</span> <span class="n">h</span><span class="o">;</span>
   <span class="o">}</span>
</code></pre>
</div>

<p>对于HashMap具体的工作原理，会在以后的章节深入研究。下图总结一下HashMap的put(K key, V value)方法和get(Object key)方法的具体复杂度：
<img src="/images/tij4-11/hashMapComplexity.png" alt="hashMapComplexity" /></p>

<p>最后，如果我们希望Map中元素以某种特殊的比较顺序排列，可以用<strong>TreeMap</strong>。如果希望元素保持插入时的顺序，可以用<strong>LinkedHashMap</strong>。但效率方面就要打一点折扣了。</p>

<h5 id="关于set">关于Set</h5>
<p>前文说了Set是为了保持集合中元素的唯一性。和Map一样，同样有三种不同的实现：</p>
<ul>
  <li><strong>HashSet</strong>：非插入顺序，重点是get()搜索的高效。</li>
  <li><strong>TreeSet</strong>：按元素的比较顺序排列。</li>
  <li><strong>LinkedSet</strong>：保持插入顺序。</li>
</ul>

<p>其中最常用的还是HashSet。TreeSet主要用于排序。排序算法取决于给定的<strong>Comparator</strong>。比如<strong>String.CASE_INSENSITIVE_ORDER</strong>.(按字母升序)</p>

<p>#####关于Queue
Queue接口有两个主要实现：</p>
<ul>
  <li><strong>LinkedList</strong>：不算Queue的嫡系，但却是最常用的。经常被用来面向Queue接口编程。</li>
  <li><strong>PriorityQueue</strong>：和TreeSet一样，可以根据给出的Comparator维持特定的排序。</li>
</ul>

<h5 id="关于iterator迭代器和容器接口">关于Iterator迭代器和容器接口</h5>
<p>设计Iterator迭代器的最重要原因不是为了迭代的效率。因为用普通的for语句迭代同样高效。</p>

<p><strong>Iterator的真正目的是为了让使用不同容器的代码之间可以去耦合。</strong></p>

<p>容器根据功能用途的不同，都被统一设计成了接口。Collection，List, Set, Map最常用的四大接口。和Iterator一样，为使用不同容器的代码去耦合才是设计这些接口的真正用意。</p>

<p>实际上，对于程序员自己开发的新容器而言，实现Iterator接口远比实现Collection接口要容易。因为Iterator接口只定义了hasNext()和next()两大方法。而Collection则复杂地多。因此Iterator才是简单去耦合的最佳方法。C++没有Collection接口，只有Iterator。</p>

<p>另外一个关于Iterator，我必须知道的是是：Java的foreach语法是面向Iterable接口的。任何类只要实现了Iterable接口都可以用foreach语法。foreach语法长这样，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">for</span><span class="o">(</span><span class="n">Element</span> <span class="n">e</span> <span class="o">:</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;){</span>
	<span class="c1">//do something</span>
<span class="o">}</span>
</code></pre>
</div>
<p>记住，所有Collection接口都实现了Iterable接口。但Maps和Array没有。</p>

<h5 id="关于过时的容器">关于过时的容器</h5>
<p>书中作者提到的明确过时的容器有三个，这三个好汉分别是：</p>
<ul>
  <li><strong>Vector</strong></li>
  <li><strong>HashTable</strong></li>
  <li><strong>Stack</strong></li>
</ul>

<h4 id="关于utilities">关于Utilities</h4>
<p>Utilities就是对于容器的一组实用静态方法。本身不需要实例化，专门用来操作对应类型的容器实例。
三大Utilities，分别用来专门操作各自的对应容器，</p>
<ul>
  <li><strong>Collections</strong></li>
  <li><strong>Arrays</strong></li>
  <li><strong>Maps</strong></li>
</ul>

<p>里面都是静态的方法。</p>

<h3 id="练习">练习</h3>

<h4 id="exercise-1">Exercise 1</h4>
<ul>
  <li><strong>Exercise 1</strong>: (2) Create a new class called Gerbil with an int gerbilNumber that’s initialized in the constructor. Give it a method called hop( ) that displays which gerbil number this is, and that it’s hopping. Create an ArrayList and add Gerbil objects to the List. Now use the get( ) method to move through the List and call hop( ) for each Gerbil.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise1</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Gerbil</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Gerbil#"</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" is hopping!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Exercise1</span><span class="o">.</span><span class="na">Gerbil</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Exercise1</span><span class="o">.</span><span class="na">Gerbil</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Exercise1</span><span class="o">.</span><span class="na">Gerbil</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Exercise1</span><span class="o">.</span><span class="na">Gerbil</span> <span class="n">gerbil</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">gerbil</span><span class="o">.</span><span class="na">hop</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-2">Exercise 2</h4>
<ul>
  <li><strong>Exercise 2</strong>: (1) Modify SimpleCollection.java to use a Set for c.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise2</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> <span class="c1">// Autoboxing</span>
            <span class="o">}</span>
            <span class="k">for</span><span class="o">(</span><span class="n">Integer</span> <span class="n">i</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="s">", "</span><span class="o">);</span>
            <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-3">Exercise 3</h4>
<ul>
  <li><strong>Exercise 3</strong>: (2) Modify innerclasses/Sequence.java so that you can add any number of elements to it.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise3</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Selector</span> <span class="o">{</span>
        <span class="kt">boolean</span> <span class="nf">end</span><span class="o">();</span>
        <span class="n">Object</span> <span class="nf">current</span><span class="o">();</span>
        <span class="kt">void</span> <span class="nf">next</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Sequence</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Sequence</span><span class="o">()</span> <span class="o">{</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;();</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Object</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SequenceSelector</span> <span class="kd">implements</span> <span class="n">Selector</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">i</span> <span class="o">==</span> <span class="n">items</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">Object</span> <span class="nf">current</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span>
                    <span class="n">i</span><span class="o">++;</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Selector</span> <span class="nf">selector</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">SequenceSelector</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Sequence</span> <span class="n">sequence</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sequence</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">sequence</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">sequence</span><span class="o">.</span><span class="na">selector</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(!</span><span class="n">selector</span><span class="o">.</span><span class="na">end</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">current</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
            <span class="n">selector</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-4">Exercise 4</h4>
<ul>
  <li><strong>Exercise 4</strong>:(3) Create a generator class that produces character names (as String objects) from your favorite movie (you can use Snow White or Star Wars as a fallback) each time you call next( ), and loops around to the beginning of the character list when it runs out of names. Use this generator to fill an array, an ArrayList, a LinkedList, a HashSet, a LinkedHashSet, and a TreeSet, then print each container.</li>
</ul>

<h5 id="generatorjava">Generator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise4</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FilmGenerator</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span><span class="o">[]</span> <span class="n">FILMNAME</span><span class="o">={</span><span class="s">"肖申克的救赎"</span><span class="o">,</span> <span class="s">"这个杀手不太冷"</span><span class="o">,</span> <span class="s">"阿甘正传"</span><span class="o">,</span> <span class="s">"霸王别姬"</span><span class="o">,</span> <span class="s">"美丽人生"</span><span class="o">,</span>
            <span class="s">"千与千寻"</span><span class="o">,</span> <span class="s">"辛德勒的名单"</span><span class="o">,</span> <span class="s">"海上钢琴师"</span><span class="o">,</span> <span class="s">"机器人总动员"</span><span class="o">,</span> <span class="s">"盗梦空间"</span><span class="o">,</span> <span class="s">"泰坦尼克号"</span><span class="o">,</span>
            <span class="s">"三傻大闹宝莱坞"</span><span class="o">,</span> <span class="s">"放牛班的春天"</span><span class="o">,</span> <span class="s">"忠犬八公的故事"</span><span class="o">,</span> <span class="s">"大话西游"</span><span class="o">,</span> <span class="s">"龙猫"</span><span class="o">,</span> <span class="s">"教父"</span><span class="o">,</span>
            <span class="s">"乱世佳人"</span><span class="o">,</span> <span class="s">"天堂电影院"</span><span class="o">,</span> <span class="s">"当幸福来敲门"</span><span class="o">,</span> <span class="s">"搏击俱乐部"</span><span class="o">,</span> <span class="s">"楚门的世界"</span><span class="o">,</span> <span class="s">"触不可及"</span><span class="o">,</span>
            <span class="s">"指环王3"</span><span class="o">,</span><span class="s">"罗马假日"</span><span class="o">};</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">LENGTH</span> <span class="o">=</span> <span class="n">FILMNAME</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">cursor</span> <span class="o">==</span> <span class="n">LENGTH</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">cursor</span> <span class="o">=</span>  <span class="mi">0</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">FILMNAME</span><span class="o">[</span><span class="n">cursor</span><span class="o">++];</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getFilmGenerator</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">FilmGenerator</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">getFilms</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">gen</span> <span class="o">=</span> <span class="n">getFilmGenerator</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">array</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getFilms</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">,</span> <span class="kt">int</span> <span class="n">filmNum</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">gen</span> <span class="o">=</span> <span class="n">getFilmGenerator</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">filmNum</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">"unchecked"</span><span class="o">,</span><span class="s">"rawtypes"</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="c1">//fil array</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&gt;&gt;&gt;Array:  "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">getFilms</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="n">size</span><span class="o">])));</span>
        <span class="c1">//fil arraylist</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&gt;&gt;&gt;ArrayList:  "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getFilms</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">(),</span><span class="n">size</span><span class="o">));</span>
        <span class="c1">//fil lindelist</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&gt;&gt;&gt;LinkedList:  "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getFilms</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedList</span><span class="o">(),</span><span class="n">size</span><span class="o">));</span>
        <span class="c1">//fil hashset</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&gt;&gt;&gt;HashSet:  "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getFilms</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">(),</span><span class="n">size</span><span class="o">));</span>
        <span class="c1">//fil linkedhashset</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&gt;&gt;&gt;LinkedHashSet:  "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getFilms</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">(),</span><span class="n">size</span><span class="o">));</span>
        <span class="c1">//fil treeset</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"&gt;&gt;&gt;TreeSet:  "</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getFilms</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeSet</span><span class="o">(),</span><span class="n">size</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-5">Exercise 5</h4>
<ul>
  <li><strong>Exercise 5</strong>: (3) Modify ListFeatures.java so that it uses Integers (remember autoboxing!) instead of Pets, and explain any difference in results.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise5</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">RAND</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">getIntegerArrayList</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">RAND</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Integer</span> <span class="nf">random</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">RAND</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intList</span><span class="o">=</span> <span class="n">getIntegerArrayList</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"1: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">);</span>
        <span class="n">Integer</span> <span class="n">oneInt</span> <span class="o">=</span> <span class="n">random</span><span class="o">();</span>
        <span class="n">intList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">oneInt</span><span class="o">);</span> <span class="c1">// Automatically resizes</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"2: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"3: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">oneInt</span><span class="o">));</span>
        <span class="n">intList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">oneInt</span><span class="o">);</span> <span class="c1">// Remove by object</span>
        <span class="n">Integer</span> <span class="n">p</span> <span class="o">=</span> <span class="n">intList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"4: "</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">p</span><span class="o">));</span>
        <span class="n">Integer</span> <span class="n">aNewInt</span> <span class="o">=</span> <span class="n">random</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"5: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">aNewInt</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"6: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">aNewInt</span><span class="o">));</span>
        <span class="c1">// Must be the exact object:</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"7: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">p</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"8: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">);</span>
        <span class="n">intList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">random</span><span class="o">());</span> <span class="c1">// Insert at an index</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"9: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">intList</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"10: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span> <span class="c1">// In-place sort</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sorted subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="c1">// Order is not important in containsAll():</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"11: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">sub</span><span class="o">,</span> <span class="n">RAND</span><span class="o">);</span> <span class="c1">// Mix it up</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"shuffled subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"12: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="n">intList</span><span class="o">);</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">intList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">intList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sub: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"13: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="n">intList</span><span class="o">);</span> <span class="c1">// Get a fresh copy</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span> <span class="c1">// Remove by index</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"14: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span> <span class="c1">// Only removes exact objects</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"15: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">random</span><span class="o">());</span> <span class="c1">// Replace an element</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"16: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">sub</span><span class="o">);</span> <span class="c1">// Insert a list in the middle</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"17: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"18: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="n">intList</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">// Remove all elements</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"19: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"20: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="n">intList</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">getIntegerArrayList</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"21: "</span> <span class="o">+</span> <span class="n">intList</span><span class="o">);</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o</span> <span class="o">=</span> <span class="n">intList</span><span class="o">.</span><span class="na">toArray</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"22: "</span> <span class="o">+</span> <span class="n">o</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
        <span class="n">Integer</span><span class="o">[]</span> <span class="n">pa</span> <span class="o">=</span> <span class="n">intList</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"23: "</span> <span class="o">+</span> <span class="n">pa</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-6">Exercise 6</h4>
<ul>
  <li><strong>Exercise 6</strong>: (2) Modify ListFeatures.java so that it uses Strings instead of Pets, and explain any difference in results.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise6</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();</span>
        <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">createList</span><span class="o">(</span><span class="kt">int</span> <span class="n">listSize</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StringGenerator</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">RAND</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>    <span class="c1">//number of characters in each string</span>
        <span class="kd">public</span> <span class="nf">StringGenerator</span><span class="o">()</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="nf">StringGenerator</span><span class="o">(</span><span class="kt">int</span> <span class="n">len</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">len</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">createList</span><span class="o">(</span><span class="kt">int</span> <span class="n">listSize</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">listSize</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">next</span><span class="o">());</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">char</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="n">length</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="kt">char</span> <span class="n">letter</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)(((</span><span class="kt">int</span><span class="o">)</span><span class="sc">'a'</span><span class="o">)</span> <span class="o">+</span> <span class="n">RAND</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">26</span><span class="o">));</span>    <span class="c1">//random a-z</span>
                <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">letter</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testUnitNext</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringGenerator</span> <span class="n">gen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringGenerator</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testUnitCreatList</span><span class="o">(</span><span class="kt">int</span> <span class="n">listSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringGenerator</span> <span class="n">gen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringGenerator</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">createList</span><span class="o">(</span><span class="n">listSize</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="cm">/**
         * Unit Test
         */</span>
        <span class="c1">//int strLength = 7;</span>
        <span class="c1">//testUnitNext(strLength);</span>
        <span class="c1">//int listSize = 20;</span>
        <span class="c1">//testUnitCreatList(listSize);</span>

        <span class="cm">/**
         * Exercise 6
         */</span>
        <span class="kt">int</span> <span class="n">strLength</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">initListSize</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
        <span class="n">StringGenerator</span> <span class="n">gen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringGenerator</span><span class="o">(</span><span class="n">strLength</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="na">createList</span><span class="o">(</span><span class="n">initListSize</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"1: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">str</span><span class="o">);</span> <span class="c1">// Automatically resizes</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"2: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"3: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">str</span><span class="o">));</span>
        <span class="n">list</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">str</span><span class="o">);</span> <span class="c1">// Remove by object</span>
        <span class="n">String</span> <span class="n">second</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"4: "</span> <span class="o">+</span> <span class="n">second</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">second</span><span class="o">));</span>
        <span class="n">String</span> <span class="n">str2</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"5: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">str2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"6: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">str2</span><span class="o">));</span>
        <span class="c1">// Must be the exact object:</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"7: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">second</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"8: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span> <span class="c1">// Insert at an index</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"9: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"10: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span> <span class="c1">// In-place sort</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sorted subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="c1">// Order is not important in containsAll():</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"11: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">sub</span><span class="o">,</span> <span class="n">StringGenerator</span><span class="o">.</span><span class="na">RAND</span><span class="o">);</span> <span class="c1">// Mix it up</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"shuffled subList: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"12: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">containsAll</span><span class="o">(</span><span class="n">sub</span><span class="o">));</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">list</span><span class="o">);</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">),</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"sub: "</span> <span class="o">+</span> <span class="n">sub</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"13: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">list</span><span class="o">);</span> <span class="c1">// Get a fresh copy</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span> <span class="c1">// Remove by index</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"14: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">sub</span><span class="o">);</span> <span class="c1">// Only removes exact objects</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"15: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span> <span class="c1">// Replace an element</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"16: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">copy</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">sub</span><span class="o">);</span> <span class="c1">// Insert a list in the middle</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"17: "</span> <span class="o">+</span> <span class="n">copy</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"18: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="n">list</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span> <span class="c1">// Remove all elements</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"19: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"20: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">());</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">createList</span><span class="o">(</span><span class="mi">4</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"21: "</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
        <span class="n">Object</span><span class="o">[]</span> <span class="n">o</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">toArray</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"22: "</span> <span class="o">+</span> <span class="n">o</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
        <span class="n">String</span><span class="o">[]</span> <span class="n">pa</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"23: "</span> <span class="o">+</span> <span class="n">pa</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-7">Exercise 7</h4>
<ul>
  <li><strong>Exercise 7</strong>: (3) Create a class, then make an initialized array of objects of your class. Fill a List from your array. Create a subset of your List by using subList( ), then remove this subset from your List.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise7</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Table</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Table#"</span> <span class="o">+</span> <span class="n">ID</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">arrayLength</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="n">Table</span><span class="o">[]</span> <span class="n">tableArray</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Table</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tableArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">tableArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Table</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Table Array &gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">tableArray</span><span class="o">));</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Table</span><span class="o">&gt;</span> <span class="n">tableList</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">tableArray</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Table list &gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">tableList</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Table</span><span class="o">&gt;</span> <span class="n">subTableList</span> <span class="o">=</span> <span class="n">tableList</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">tableList</span><span class="o">.</span><span class="na">size</span><span class="o">()/</span><span class="mi">2</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Table sub list &gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">subTableList</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-8">Exercise 8</h4>
<ul>
  <li><strong>Exercise 8</strong>: (1) Modify Exercise 1 so it uses an Iterator to move through the List while calling hop( ).</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise8</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Gerbil</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Gerbil#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">" is hopping!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Gerbil</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Gerbil</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Gerbil</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Gerbil</span><span class="o">&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">().</span><span class="na">hop</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-9">Exercise 9</h4>
<ul>
  <li><strong>Exercise 9</strong>: (4) Modify innerclasses/Sequence.java so that Sequence works with an Iterator instead of a Selector.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise9</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Sequence</span> <span class="kd">implements</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">items</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Sequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">size</span><span class="o">];</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Object</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">next</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">items</span><span class="o">[</span><span class="n">next</span><span class="o">++]</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">SequenceIterator</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SequenceIterator</span> <span class="kd">implements</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">cursor</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">Object</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">hasNext</span><span class="o">())</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">items</span><span class="o">[</span><span class="n">cursor</span><span class="o">++];</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">seqLength</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="n">Sequence</span> <span class="n">sequence</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sequence</span><span class="o">(</span><span class="n">seqLength</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">seqLength</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">sequence</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="c1">//for (Object obj : sequence) {</span>
        <span class="c1">//    System.out.println(obj);</span>
        <span class="c1">//}</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">sequence</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-10">Exercise 10</h4>
<ul>
  <li><strong>Exercise 10</strong>: (2) Change Exercise 9 in the Polymorphism chapter to use an ArrayList to hold the Rodents and an Iterator to move through the sequence of Rodents.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise10</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Rodent</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Mouse</span> <span class="kd">implements</span> <span class="n">Rodent</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s">"Mouse"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">NAME</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">" is hopping!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Gerbil</span> <span class="kd">implements</span> <span class="n">Rodent</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s">"Gerbil"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">NAME</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">" is hopping!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Hamster</span> <span class="kd">implements</span> <span class="n">Rodent</span> <span class="o">{</span>
        <span class="kd">protected</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s">"Hamster"</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">NAME</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">" is hopping!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Rodent</span><span class="o">&gt;</span> <span class="n">rodents</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Rodent</span><span class="o">&gt;();</span>
        <span class="kt">int</span> <span class="n">rodentsNum</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">rodentsNum</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">rodents</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Mouse</span><span class="o">());</span>
            <span class="n">rodents</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Gerbil</span><span class="o">());</span>
            <span class="n">rodents</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Hamster</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Rodent</span><span class="o">&gt;</span> <span class="n">rodentIte</span> <span class="o">=</span> <span class="n">rodents</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">rodentIte</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">rodentIte</span><span class="o">.</span><span class="na">next</span><span class="o">().</span><span class="na">hop</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-11">Exercise 11</h4>
<ul>
  <li><strong>Exercise 11</strong>: (2) Write a method that uses an Iterator to step through a Collection and print the toString( ) of each object in the container. Fill all the different types of Collections with objects and apply your method to each container.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise11</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">fillCollection</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">klass</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">klass</span><span class="o">.</span><span class="na">newInstance</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InstantiationException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">parseCollection</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyObject</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">MyObject</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">MyObject</span><span class="o">()</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"MyObject#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">"!"</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">ID</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">MyObject</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="o">-</span> <span class="n">getId</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">klass</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">klass</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.ciaoshen.thinkinjava.chapter11.Exercise11$MyObject"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="c1">//ArrayList</span>
        <span class="n">parseCollection</span><span class="o">(</span><span class="n">fillCollection</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;(),</span> <span class="n">klass</span><span class="o">,</span> <span class="n">size</span><span class="o">));</span>
        <span class="c1">//LinkedList</span>
        <span class="n">parseCollection</span><span class="o">(</span><span class="n">fillCollection</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;(),</span> <span class="n">klass</span><span class="o">,</span> <span class="n">size</span><span class="o">));</span>
        <span class="c1">//HashSet</span>
        <span class="n">parseCollection</span><span class="o">(</span><span class="n">fillCollection</span><span class="o">(</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;(),</span> <span class="n">klass</span><span class="o">,</span> <span class="n">size</span><span class="o">));</span>
        <span class="c1">//TreeSet</span>
        <span class="n">parseCollection</span><span class="o">(</span><span class="n">fillCollection</span><span class="o">(</span><span class="k">new</span> <span class="n">TreeSet</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;(),</span> <span class="n">klass</span><span class="o">,</span> <span class="n">size</span><span class="o">));</span>
        <span class="c1">//LinkedHashSet</span>
        <span class="n">parseCollection</span><span class="o">(</span><span class="n">fillCollection</span><span class="o">(</span><span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;(),</span> <span class="n">klass</span><span class="o">,</span> <span class="n">size</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-12">Exercise 12</h4>
<ul>
  <li><strong>Exercise 12</strong>: (3) Create and populate a List<Integer>. Create a second List<Integer> of the same size as the first, and use ListIterators to read elements from the first List and insert them into the second in reverse order. (You may want to explore a number of different ways to solve this problem.)</Integer></Integer></li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise12</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="kt">int</span> <span class="n">listSize</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">listSize</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">list1</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">max</span><span class="o">)));</span>
            <span class="n">list2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">max</span><span class="o">)));</span>
        <span class="o">}</span>
        <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">list1</span><span class="o">.</span><span class="na">listIterator</span><span class="o">(</span><span class="n">list1</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasPrevious</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">list2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">previous</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list1</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-13">Exercise 13</h4>
<ul>
  <li><strong>Exercise 13</strong>: (3) In the innerclasses/GreenhouseController.java example, the class Controller uses an ArrayList. Change the code to use a LinkedList instead, and use an Iterator to cycle through the set of events.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise13</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">eventList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;();</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addEvent</span><span class="o">(</span><span class="n">Event</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span> <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">c</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">while</span><span class="o">(</span><span class="n">eventList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// Make a copy so you’re not modifying the list</span>
                <span class="c1">// while you’re selecting the elements in it:</span>
                <span class="k">for</span><span class="o">(</span><span class="n">Event</span> <span class="n">e</span> <span class="o">:</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;(</span><span class="n">eventList</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">if</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">ready</span><span class="o">())</span> <span class="o">{</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
                        <span class="n">e</span><span class="o">.</span><span class="na">action</span><span class="o">();</span>
                        <span class="n">eventList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Event</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">long</span> <span class="n">eventTime</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">delayTime</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Event</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">delayTime</span> <span class="o">=</span> <span class="n">delayTime</span><span class="o">;</span>
            <span class="n">start</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Allows restarting</span>
            <span class="n">eventTime</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">()</span> <span class="o">+</span> <span class="n">delayTime</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">ready</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="n">eventTime</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">GreenhouseControls</span> <span class="kd">extends</span> <span class="n">Controller</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">light</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">LightOn</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">LightOn</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// Put hardware control code here to</span>
                <span class="c1">// physically turn on the light.</span>
                <span class="n">light</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"Light is on"</span><span class="o">;</span> <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">LightOff</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">LightOff</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// Put hardware control code here to</span>
                <span class="c1">// physically turn off the light.</span>
                <span class="n">light</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"Light is off"</span><span class="o">;</span> <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">water</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">WaterOn</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">WaterOn</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// Put hardware control code here.</span>
                <span class="n">water</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="s">"Greenhouse water is on"</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">WaterOff</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">WaterOff</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// Put hardware control code here.</span>
                <span class="n">water</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="s">"Greenhouse water is off"</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">thermostat</span> <span class="o">=</span> <span class="s">"Day"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThermostatNight</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">ThermostatNight</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// Put hardware control code here.</span>
                <span class="n">thermostat</span> <span class="o">=</span> <span class="s">"Night"</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="s">"Thermostat on night setting"</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThermostatDay</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">ThermostatDay</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// Put hardware control code here.</span>
                <span class="n">thermostat</span> <span class="o">=</span> <span class="s">"Day"</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="s">"Thermostat on day setting"</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="c1">// An example of an action() that inserts a</span>
        <span class="c1">// new one of itself into the event list:</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Bell</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">Bell</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="n">addEvent</span><span class="o">(</span><span class="k">new</span> <span class="n">Bell</span><span class="o">(</span><span class="n">delayTime</span><span class="o">));</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"Bing!"</span><span class="o">;</span> <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Restart</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">eventList</span><span class="o">;</span>
            <span class="kd">public</span> <span class="nf">Restart</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">eventList</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span>
                <span class="k">this</span><span class="o">.</span><span class="na">eventList</span> <span class="o">=</span> <span class="n">eventList</span><span class="o">;</span>
                <span class="k">for</span><span class="o">(</span><span class="n">Event</span> <span class="n">e</span> <span class="o">:</span> <span class="n">eventList</span><span class="o">)</span>
                    <span class="n">addEvent</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">for</span><span class="o">(</span><span class="n">Event</span> <span class="n">e</span> <span class="o">:</span> <span class="n">eventList</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">start</span><span class="o">();</span> <span class="c1">// Rerun each event</span>
                    <span class="n">addEvent</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
                <span class="o">}</span>
                <span class="n">start</span><span class="o">();</span> <span class="c1">// Rerun this Event</span>
                <span class="n">addEvent</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="s">"Restarting system"</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Terminate</span> <span class="kd">extends</span> <span class="n">Event</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="nf">Terminate</span><span class="o">(</span><span class="kt">long</span> <span class="n">delayTime</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">delayTime</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"Terminating"</span><span class="o">;</span> <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">GreenhouseControls</span> <span class="n">gc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GreenhouseControls</span><span class="o">();</span>
        <span class="c1">// Instead of hard-wiring, you could parse</span>
        <span class="c1">// configuration information from a text file here:</span>
        <span class="n">gc</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">Bell</span><span class="o">(</span><span class="mi">900</span><span class="o">));</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">eventList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;();</span>
        <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">ThermostatNight</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
        <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">LightOn</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
        <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">LightOff</span><span class="o">(</span><span class="mi">400</span><span class="o">));</span>
        <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">WaterOn</span><span class="o">(</span><span class="mi">600</span><span class="o">));</span>
        <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">WaterOff</span><span class="o">(</span><span class="mi">800</span><span class="o">));</span>
        <span class="n">eventList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">ThermostatDay</span><span class="o">(</span><span class="mi">1400</span><span class="o">));</span>
        <span class="n">gc</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="n">gc</span><span class="o">.</span><span class="na">new</span> <span class="nf">Restart</span><span class="o">(</span><span class="mi">2000</span><span class="o">,</span> <span class="n">eventList</span><span class="o">));</span>
        <span class="kt">int</span> <span class="n">delayTime</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">;</span>
        <span class="n">gc</span><span class="o">.</span><span class="na">addEvent</span><span class="o">(</span><span class="k">new</span> <span class="n">GreenhouseControls</span><span class="o">.</span><span class="na">Terminate</span><span class="o">(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">delayTime</span><span class="o">)));</span>
        <span class="n">gc</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-14">Exercise 14</h4>
<ul>
  <li><strong>Exercise 14</strong>: (3) Create an empty LinkedList<Integer>. Using a ListIterator, add Integers to the List by always inserting them in the middle of the List.</Integer></li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise14</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">insertInMiddle</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//insert a num 1-1000 in the middle of the list</span>
        <span class="kt">int</span> <span class="n">halfLength</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()/</span><span class="mi">2</span><span class="o">;</span>
        <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">halfLength</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">resultList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">resultList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">num</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">resultList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resultList</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="kt">int</span> <span class="n">times</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">times</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">list</span> <span class="o">=</span> <span class="n">insertInMiddle</span><span class="o">(</span><span class="n">list</span><span class="o">,</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-15">Exercise 15</h4>
<ul>
  <li><strong>Exercise 15</strong>: (4) Stacks are often used to evaluate expressions in programming languages. Using net.mindview.util.Stack, evaluate the following expression, where’+’ means “push the following letter onto the stack,” and’-’ means “pop the top of the stack and print it”: “+U+n+c—+e+r+t—+a-+i-+n+t+y—+ -+r+u—+l+e+s—”</li>
</ul>

<p>这题我用LinkedList自己实现了一个Stack。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise15</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">empty</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">peek</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">peek</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">push</span><span class="o">(</span><span class="n">String</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addFirst</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">search</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">indexOf</span><span class="o">((</span><span class="n">String</span><span class="o">)</span><span class="n">o</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">StringGenerator</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">RAND</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kd">public</span> <span class="nf">StringGenerator</span><span class="o">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">l</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
            <span class="kt">char</span><span class="o">[]</span> <span class="n">charArray</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="n">length</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)((</span><span class="kt">int</span><span class="o">)</span><span class="sc">'a'</span> <span class="o">+</span> <span class="n">RAND</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">26</span><span class="o">));</span>
                <span class="n">charArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">charArray</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">generator</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">new</span> <span class="nf">StringGenerator</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">enum</span> <span class="n">ScanStatus</span> <span class="o">{</span><span class="n">READ</span><span class="o">,</span> <span class="n">WRITE</span><span class="o">}</span>
    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommentErrorException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">CommentErrorException</span><span class="o">(</span><span class="n">String</span> <span class="n">offset</span><span class="o">)</span> <span class="o">{</span>   <span class="c1">//offset is the index where the error occurs</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">offset</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">scanComment</span><span class="o">(</span><span class="n">String</span> <span class="n">comment</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">CommentErrorException</span> <span class="o">{</span>
        <span class="n">ScanStatus</span> <span class="n">myStatus</span> <span class="o">=</span> <span class="n">ScanStatus</span><span class="o">.</span><span class="na">WRITE</span><span class="o">;</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">commentList</span> <span class="o">=</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">comment</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
        <span class="n">ListIterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">commentIte</span> <span class="o">=</span> <span class="n">commentList</span><span class="o">.</span><span class="na">listIterator</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">cursor</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span> <span class="c1">//current comment</span>
        <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="c1">//index of cursor</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">commentIte</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">commentIte</span><span class="o">.</span><span class="na">nextIndex</span><span class="o">();</span>
            <span class="n">cursor</span> <span class="o">=</span> <span class="n">commentIte</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">myStatus</span> <span class="o">==</span> <span class="n">ScanStatus</span><span class="o">.</span><span class="na">WRITE</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">cursor</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"+"</span><span class="o">))</span> <span class="o">{</span>
                    <span class="n">myStatus</span> <span class="o">=</span> <span class="n">ScanStatus</span><span class="o">.</span><span class="na">READ</span><span class="o">;</span>
                    <span class="k">continue</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">cursor</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"-"</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">empty</span><span class="o">())</span> <span class="o">{</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">CommentErrorException</span><span class="o">(</span><span class="s">"Position "</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">offset</span><span class="o">)</span> <span class="o">+</span> <span class="s">": stack is empty! nothing to pop!"</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">pop</span><span class="o">());</span>
                    <span class="k">continue</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">CommentErrorException</span><span class="o">(</span><span class="s">"Got \""</span> <span class="o">+</span> <span class="n">cursor</span> <span class="o">+</span> <span class="s">"\" at position "</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">offset</span><span class="o">)</span> <span class="o">+</span> <span class="s">": need +- operation here!"</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">myStatus</span> <span class="o">==</span> <span class="n">ScanStatus</span><span class="o">.</span><span class="na">READ</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">list</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">cursor</span><span class="o">);</span>
                <span class="n">myStatus</span> <span class="o">=</span> <span class="n">ScanStatus</span><span class="o">.</span><span class="na">WRITE</span><span class="o">;</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise15</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise15</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">stackLength</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">stackLength</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stack</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">stack</span><span class="o">.</span><span class="na">empty</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Stack is empty? "</span> <span class="o">+</span> <span class="n">stack</span><span class="o">.</span><span class="na">empty</span><span class="o">());</span>

        <span class="n">String</span> <span class="n">comment</span> <span class="o">=</span> <span class="s">"+U+n+c-+e+r+t-+a-+i-+n+t+y-+ -+r+u-+l+e+s-"</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">stack</span><span class="o">.</span><span class="na">scanComment</span><span class="o">(</span><span class="n">comment</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">CommentErrorException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-16">Exercise 16</h4>
<ul>
  <li><strong>Exercise 16</strong>: (5) Create a Set of the vowels. Working from UniqueWords.Java, count and display the number of vowels in each input word, and also display the total number of vowels in the input file.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise16</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SPLITER</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>
    <span class="c1">//read file</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">readFile</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span><span class="k">break</span><span class="o">;}</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">SPLITER</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="c1">//word segment</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">segmentWords</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">content</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">content</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Content for segmentWords() method is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">freqMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">Pattern</span> <span class="n">wordP</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"\\w+"</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">wordM</span> <span class="o">=</span> <span class="n">wordP</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">wordM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">wordM</span><span class="o">.</span><span class="na">group</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">freqMap</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">word</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">freqMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="n">freqMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">word</span><span class="o">)+</span><span class="mi">1</span><span class="o">);</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">freqMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">freqMap</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//count vowels</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">countVowels</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">wordsMap</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">totalVowelNum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">wordVowelCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">Pattern</span> <span class="n">vowelP</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[aeiouAEIOU]"</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">vowelM</span> <span class="o">=</span> <span class="n">vowelP</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">wordsMap</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">wordsMap</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The wordsMap for countVowels() method is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Formatter</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Formatter</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5s %5.5s \n"</span><span class="o">,</span> <span class="s">"WORD"</span><span class="o">,</span> <span class="s">"VOWEL"</span><span class="o">,</span> <span class="s">"FQ"</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-35.35s \n"</span><span class="o">,</span> <span class="s">"----------------------------------------------"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">record</span> <span class="o">:</span> <span class="n">wordsMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">wordVowelCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">vowelM</span> <span class="o">=</span> <span class="n">vowelM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">record</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">vowelM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">wordVowelCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5d %5.5s \n"</span><span class="o">,</span> <span class="n">record</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">wordVowelCount</span><span class="o">,</span> <span class="s">"*"</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">record</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
            <span class="n">totalVowelNum</span> <span class="o">+=</span> <span class="n">wordVowelCount</span> <span class="o">*</span> <span class="n">record</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-35.35s \n"</span><span class="o">,</span> <span class="s">"---------------------------------------------"</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total Vowel:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">totalVowelNum</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">//test Unit</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">UnitTest</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRONGPATH</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/hello.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">RIGHTPATH</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise16.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testReadFile</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">WRONGPATH</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testSegmentWords</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">segmentWords</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">)));</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testCountVowels</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">countVowels</span><span class="o">(</span><span class="n">segmentWords</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">)));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//UnitTest.testReadFile();</span>
        <span class="c1">//UnitTest.testSegmentWords();</span>
        <span class="n">UnitTest</span><span class="o">.</span><span class="na">testCountVowels</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-17">Exercise 17</h4>
<ul>
  <li><strong>Exercise 17</strong>: (2) Take the Gerbil class in Exercise 1 and put it into a Map instead, associating each Gerbil’s name (e.g. “Fuzzy” or “Spot”) as a String (the key) for each Gerbil (the value) you put in the table. Get an Iterator for the keySet( ) and use it to move through the Map, looking up the Gerbil for each key and printing out the key and telling the Gerbil to hop( ).</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise17</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Gerbil</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Gerbil</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hop</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Gerbil#"</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">", is hopping!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Gerbil</span> <span class="n">fuzzy</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gerbil</span><span class="o">(</span><span class="s">"Fuzzy"</span><span class="o">);</span>
        <span class="n">Gerbil</span> <span class="n">spot</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gerbil</span><span class="o">(</span><span class="s">"Spot"</span><span class="o">);</span>
        <span class="n">Gerbil</span> <span class="n">piupiu</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gerbil</span><span class="o">(</span><span class="s">"PiuPiu"</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Gerbil</span><span class="o">&gt;</span> <span class="n">gerbilMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Gerbil</span><span class="o">&gt;();</span>
        <span class="n">gerbilMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">fuzzy</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span><span class="n">fuzzy</span><span class="o">);</span>
        <span class="n">gerbilMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">spot</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span><span class="n">spot</span><span class="o">);</span>
        <span class="n">gerbilMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">piupiu</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span><span class="n">piupiu</span><span class="o">);</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Gerbil</span><span class="o">&gt;&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">gerbilMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">().</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Gerbil</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"(Gerbil: "</span> <span class="o">+</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">()</span> <span class="o">+</span> <span class="s">")    &gt;&gt;&gt;     "</span><span class="o">);</span>
            <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">hop</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-18">Exercise 18</h4>
<p>Exercise 18: (3) Fill a HashMap with key-value pairs. Print the results to show ordering by hash code. Extract the pairs, sort by key, and place the result into a LinkedHashMap. Show that the insertion order is maintained.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise18</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// insert HashMap</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">hashMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">hashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"one"</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">hashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"two"</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="n">hashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"three"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
        <span class="n">hashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"four"</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="n">hashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"five"</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
        <span class="c1">// print HashMap</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hashMap</span><span class="o">);</span>
        <span class="c1">// extract to ArrayList</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="n">hashMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;&gt;();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">set</span><span class="o">);</span>
        <span class="c1">// sort ArrayList</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry1</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry2</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">entry1</span><span class="o">.</span><span class="na">getValue</span><span class="o">(),</span>  <span class="n">entry2</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="c1">// insert into LinkedHashMap</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">linkedHashMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">linkedHashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="c1">// print LinkedHashMap</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">linkedHashMap</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-19">Exercise 19</h4>
<ul>
  <li><strong>Exercise 19</strong>: (2) Repeat the previous exercise with a HashSet and LinkedHashSet.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise19</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// fill HashSet</span>
        <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">hashSet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">hashSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"one"</span><span class="o">);</span>
        <span class="n">hashSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"two"</span><span class="o">);</span>
        <span class="n">hashSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"three"</span><span class="o">);</span>
        <span class="n">hashSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"four"</span><span class="o">);</span>
        <span class="n">hashSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"five"</span><span class="o">);</span>
        <span class="c1">// print HashSet</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hashSet</span><span class="o">);</span>
        <span class="c1">// transit to list</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">hashSet</span><span class="o">);</span>
        <span class="c1">// sort list</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">);</span>
        <span class="c1">// insert into LinkedHashSet</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">linkedHashSet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashSet</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">linkedHashSet</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
        <span class="c1">// print LinkedHashSet</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">linkedHashSet</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-20">Exercise 20</h4>
<ul>
  <li><strong>Exercise 20</strong>: (3) Modify Exercise 16 so that you keep a count of the occurrence of each vowel.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise20</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SPLITER</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>
    <span class="c1">//read file</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">readFile</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span><span class="k">break</span><span class="o">;}</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">SPLITER</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="c1">//word segment</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">segmentWords</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">content</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">content</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Content for segmentWords() method is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">freqMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">Pattern</span> <span class="n">wordP</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"\\w+"</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">wordM</span> <span class="o">=</span> <span class="n">wordP</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">wordM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">wordM</span><span class="o">.</span><span class="na">group</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">freqMap</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">word</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">freqMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="n">freqMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">word</span><span class="o">)+</span><span class="mi">1</span><span class="o">);</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">freqMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">freqMap</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//count vowels</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">countVowels</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">wordsMap</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">totalVowelNum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">wordVowelCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">aCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">eCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">iCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">oCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">uCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">Pattern</span> <span class="n">vowelP</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[aeiouAEIOU]"</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">vowelM</span> <span class="o">=</span> <span class="n">vowelP</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">aM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[aA]"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">eM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[eE]"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">iM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[iI]"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">oM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[oO]"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="n">Matcher</span> <span class="n">uM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"[uU]"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">wordsMap</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">wordsMap</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The wordsMap for countVowels() method is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Formatter</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Formatter</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5s %5.5s \n"</span><span class="o">,</span> <span class="s">"WORD"</span><span class="o">,</span> <span class="s">"VOWEL"</span><span class="o">,</span> <span class="s">"FQ"</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-35.35s \n"</span><span class="o">,</span> <span class="s">"----------------------------------------------"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">record</span> <span class="o">:</span> <span class="n">wordsMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">wordVowelCount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
            <span class="n">vowelM</span> <span class="o">=</span> <span class="n">vowelM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">vowelM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">wordVowelCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">aM</span> <span class="o">=</span> <span class="n">aM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">aM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">aCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">eM</span> <span class="o">=</span> <span class="n">eM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">eM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">eCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">iM</span> <span class="o">=</span> <span class="n">iM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">iM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">iCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">oM</span> <span class="o">=</span> <span class="n">oM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">oM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">oCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">uM</span> <span class="o">=</span> <span class="n">uM</span><span class="o">.</span><span class="na">reset</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">uM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">uCount</span><span class="o">++;</span>
            <span class="o">}</span>
            <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5d %5.5s \n"</span><span class="o">,</span> <span class="n">record</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">wordVowelCount</span><span class="o">,</span> <span class="s">"*"</span> <span class="o">+</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">record</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
            <span class="n">totalVowelNum</span> <span class="o">+=</span> <span class="n">wordVowelCount</span> <span class="o">*</span> <span class="n">record</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-35.35s \n"</span><span class="o">,</span> <span class="s">"---------------------------------------------"</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total a/A:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">aCount</span><span class="o">));</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total e/E:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">eCount</span><span class="o">));</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total i/I:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">iCount</span><span class="o">));</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total o/O:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">oCount</span><span class="o">));</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total u/U:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">uCount</span><span class="o">));</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%-20.20s | %5.5s \n"</span><span class="o">,</span> <span class="s">"Total Vowel:"</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">totalVowelNum</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">//test Unit</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">UnitTest</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRONGPATH</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/hello.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">RIGHTPATH</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise16.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testReadFile</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">WRONGPATH</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testSegmentWords</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">segmentWords</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">)));</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">testCountVowels</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">countVowels</span><span class="o">(</span><span class="n">segmentWords</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">)));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//UnitTest.testReadFile();</span>
        <span class="c1">//UnitTest.testSegmentWords();</span>
        <span class="n">UnitTest</span><span class="o">.</span><span class="na">testCountVowels</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-21">Exercise 21</h4>
<ul>
  <li><strong>Exercise 21</strong>: (3) Using a Map&lt;String,Integer&gt;, follow the form of UniqueWords.java to create a program that counts the occurrence of words in a file. Sort the results using Collections.sort( ) with a second argument of String.CASE_INSENSITIVE_ORDER (to produce an alphabetic sort), and display the result.</li>
</ul>

<h5 id="myreaderjava">MyReader.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyReader</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">spliter</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(){}</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">spliter</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">readFile</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
            <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">spliter</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">TestUnit</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRONGPATH</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/hello.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">RIGHTPATH</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/MyReader.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">testReadFile</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">WRONGPATH</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TestUnit</span> <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">().</span><span class="na">new</span> <span class="n">TestUnit</span><span class="o">();</span>
        <span class="n">test</span><span class="o">.</span><span class="na">testReadFile</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise21java">Exercise21.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise21</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">uniqueWords</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readFile</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">content</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">content</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">path</span> <span class="o">+</span> <span class="s">" is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Matcher</span> <span class="n">wordM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"\\w+"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">wordsMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">wordM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">word</span> <span class="o">=</span> <span class="n">wordM</span><span class="o">.</span><span class="na">group</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">wordsMap</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">word</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">wordsMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span><span class="n">wordsMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">word</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">wordsMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span><span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">wordsMap</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">sortedUniqueWords</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">wordsMap</span> <span class="o">=</span> <span class="n">uniqueWords</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">wordsMap</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">wordsMap</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The words map for the file "</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">" is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">wordsMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">());</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">linkedHashMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">word</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Integer</span> <span class="n">feq</span> <span class="o">=</span> <span class="n">wordsMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">feq</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">linkedHashMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span> <span class="n">feq</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">linkedHashMap</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">map</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">map</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The args Map for display() method is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Formatter</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Formatter</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%1$20.20s %2$-5.5s \n"</span><span class="o">,</span> <span class="s">"WORD"</span><span class="o">,</span> <span class="s">"FQ"</span><span class="o">);</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">set</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%1$20.20s %2$-5d \n"</span><span class="o">,</span> <span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise21.java"</span><span class="o">;</span>
        <span class="c1">//System.out.println(uniqueWords(path));</span>
        <span class="c1">//System.out.println(sortedUniqueWords(path));</span>
        <span class="n">display</span><span class="o">(</span><span class="n">sortedUniqueWords</span><span class="o">(</span><span class="n">path</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-22">Exercise 22</h4>
<ul>
  <li><strong>Exercise 22</strong>: (5) Modify the previous exercise so that it uses a class containing a String and a count field to store each different word, and a Set of these objects to maintain the list of words.</li>
</ul>

<h5 id="myreaderjava-1">MyReader.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyReader</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">spliter</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(){}</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">spliter</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">readFile</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
            <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">spliter</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">TestUnit</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRONGPATH</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/hello.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">RIGHTPATH</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/MyReader.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">testReadFile</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">WRONGPATH</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TestUnit</span> <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">().</span><span class="na">new</span> <span class="n">TestUnit</span><span class="o">();</span>
        <span class="n">test</span><span class="o">.</span><span class="na">testReadFile</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise22java">Exercise22.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise22</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Pair</span> <span class="kd">implements</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Pair</span><span class="o">()</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="nf">Pair</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">,</span> <span class="kt">int</span> <span class="n">freq</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">word</span><span class="o">;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">freq</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getKey</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">key</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getValue</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">value</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKey</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">word</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="kt">int</span> <span class="n">freq</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">freq</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"("</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s">","</span> <span class="o">+</span> <span class="n">value</span> <span class="o">+</span> <span class="s">")"</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">Pair</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">key</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Pair</span> <span class="n">p</span> <span class="o">=</span> <span class="o">(</span><span class="n">Pair</span><span class="o">)</span><span class="n">o</span><span class="o">;</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">hashCode</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="nf">uniqueWords</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">();</span>
        <span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">readFile</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">content</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">content</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">path</span> <span class="o">+</span> <span class="s">" is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Matcher</span> <span class="n">wordM</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">"\\w+"</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="n">pairSet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">wordM</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">Pair</span> <span class="n">word</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">(</span><span class="n">wordM</span><span class="o">.</span><span class="na">group</span><span class="o">(),</span> <span class="mi">1</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">pairSet</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">word</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">updateSet</span><span class="o">(</span><span class="n">pairSet</span><span class="o">,</span> <span class="n">word</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">continue</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">pairSet</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">pairSet</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">updateSet</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="n">set</span><span class="o">,</span> <span class="n">Pair</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="n">ite</span> <span class="o">=</span> <span class="n">set</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">Pair</span> <span class="n">current</span> <span class="o">=</span> <span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">p</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
                <span class="kt">int</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
                <span class="n">Pair</span> <span class="n">newPair</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pair</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">freq</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
                <span class="n">set</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
                <span class="n">set</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">newPair</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="nf">sortedUniqueWords</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="n">pairSet</span> <span class="o">=</span> <span class="n">uniqueWords</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">pairSet</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">pairSet</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The pair set for the file "</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">" is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">pairSet</span><span class="o">);</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Pair</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">list</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">list</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The args list for display() method is null or empty!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Formatter</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Formatter</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%1$20.20s %2$-5.5s \n"</span><span class="o">,</span> <span class="s">"WORD"</span><span class="o">,</span> <span class="s">"FQ"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Pair</span> <span class="n">pair</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">f</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%1$20.20s %2$-5d \n"</span><span class="o">,</span> <span class="n">pair</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">pair</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise21.java"</span><span class="o">;</span>
        <span class="c1">//System.out.println(uniqueWords(path));</span>
        <span class="c1">//System.out.println(sortedUniqueWords(path));</span>
        <span class="n">display</span><span class="o">(</span><span class="n">sortedUniqueWords</span><span class="o">(</span><span class="n">path</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-23">Exercise 23</h4>
<ul>
  <li><strong>Exercise 23</strong>: (4) Starting with Statistics.java, create a program that runs the test repeatedly and looks to see if any one number tends to appear more than the others in the results.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise23</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">randomNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="c1">// Produce a number between 0 and 20:</span>
            <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
            <span class="n">Integer</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
            <span class="n">m</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">r</span><span class="o">,</span> <span class="n">freq</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">freq</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">m</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// merge the second map to the first map</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">mergeMap</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map1</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map2</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">map1</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">map1</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">||</span> <span class="n">map2</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">map2</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">map1</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">set1</span> <span class="o">=</span> <span class="n">map1</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">set2</span> <span class="o">=</span> <span class="n">map2</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry1</span> <span class="o">:</span> <span class="n">set1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Integer</span> <span class="n">key1</span> <span class="o">=</span> <span class="n">entry1</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
            <span class="n">Integer</span> <span class="n">value1</span> <span class="o">=</span> <span class="n">entry1</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">entry2</span> <span class="o">:</span> <span class="n">set2</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Integer</span> <span class="n">key2</span> <span class="o">=</span> <span class="n">entry2</span><span class="o">.</span><span class="na">getKey</span><span class="o">();</span>
                <span class="n">Integer</span> <span class="n">value2</span> <span class="o">=</span> <span class="n">entry2</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">key2</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">value2</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key2</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">key1</span><span class="o">))</span> <span class="o">{</span>
                    <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key1</span><span class="o">,</span> <span class="n">value1</span> <span class="o">+</span> <span class="n">entry2</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key1</span><span class="o">,</span><span class="n">value1</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">repeatRandomNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">times</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">randomNum</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">times</span><span class="o">-</span><span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">mergeMap</span><span class="o">(</span><span class="n">result</span><span class="o">,</span><span class="n">randomNum</span><span class="o">(</span><span class="n">size</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">repeatRandomNum</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span><span class="mi">20</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-24">Exercise 24</h4>
<ul>
  <li><strong>Exercise 24</strong>: (2) Fill a LinkedHashMap with String keys and objects of your choice. Now extract the pairs, sort them based on the keys, and reinsert them into the Map.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise24</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NAME</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Dog</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">NAME</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Dog#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">" called "</span> <span class="o">+</span> <span class="n">NAME</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">randomName</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kt">char</span><span class="o">[]</span> <span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="o">[</span><span class="n">length</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">name</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)((</span><span class="kt">int</span><span class="o">)</span><span class="sc">'a'</span> <span class="o">+</span> <span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">26</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">String</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">dogMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;();</span>
        <span class="kt">int</span> <span class="n">mapSize</span> <span class="o">=</span> <span class="mi">20</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">nameLength</span> <span class="o">=</span><span class="mi">4</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">mapSize</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">dogName</span> <span class="o">=</span> <span class="n">randomName</span><span class="o">(</span><span class="n">nameLength</span><span class="o">);</span>
            <span class="n">dogMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">dogName</span><span class="o">,</span><span class="k">new</span> <span class="n">Dog</span><span class="o">(</span><span class="n">dogName</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="c1">//System.out.println(dogMap);</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;&gt;</span> <span class="n">dogSet</span> <span class="o">=</span> <span class="n">dogMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">();</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;&gt;</span> <span class="n">dogList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;&gt;();</span>
        <span class="n">dogList</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">dogSet</span><span class="o">);</span>
        <span class="c1">//System.out.println(dogList);</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">dogList</span><span class="o">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">entry1</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">entry2</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="na">CASE_INSENSITIVE_ORDER</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">entry1</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span><span class="n">entry2</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="c1">//System.out.println(dogList);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">sortedDogMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">dogList</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sortedDogMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span><span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sortedDogMap</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-25">Exercise 25</h4>
<ul>
  <li><strong>Exercise 25</strong>: (3) Create a Map&lt;String,ArrayList<Integer>&gt;. Use net.mindview.TextFile to open a text file and read it in a word at a time (use "\\W+" as the second argument to the TextFile constructor). Count the words as you read them in, and for each word in the file, record in the ArrayList<Integer> the word count associated with that word—this is, in effect, the location in the file where that word was found.</Integer></Integer></li>
</ul>

<h5 id="myreaderjava-2">MyReader.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyReader</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">spliter</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(){}</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">spliter</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">readFile</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
            <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">spliter</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">TestUnit</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRONGPATH</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/hello.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">RIGHTPATH</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/MyReader.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">testReadFile</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">WRONGPATH</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TestUnit</span> <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">().</span><span class="na">new</span> <span class="n">TestUnit</span><span class="o">();</span>
        <span class="n">test</span><span class="o">.</span><span class="na">testReadFile</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise25java">Exercise25.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>

<span class="c1">// statistics the word and their positions in the file</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise25</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">statistic</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">,</span> <span class="n">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">path</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">regex</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Argument content or regex is null!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">().</span><span class="na">readFile</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">content</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The content in "</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">" is null!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">regex</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;();</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">value</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="na">group</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
                <span class="n">value</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">start</span><span class="o">());</span>
                <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span><span class="n">value</span><span class="o">);</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">group</span><span class="o">(),</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">start</span><span class="o">())));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise25.java"</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">regex</span> <span class="o">=</span> <span class="s">"\\w+"</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">statistic</span><span class="o">(</span><span class="n">path</span><span class="o">,</span><span class="n">regex</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-26">Exercise 26</h4>
<ul>
  <li><strong>Exercise 26</strong>: (4) Take the resulting Map from the previous exercise and re-create the order of the words as they appeared in the original file.</li>
</ul>

<h5 id="myreaderjava-3">MyReader.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyReader</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">spliter</span> <span class="o">=</span> <span class="s">"\n"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(){}</span>
    <span class="kd">public</span> <span class="nf">MyReader</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">spliter</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">readFile</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
            <span class="n">String</span> <span class="n">line</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">line</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">break</span><span class="o">;</span>
                    <span class="o">}</span>
                    <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span> <span class="o">+</span> <span class="n">spliter</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">TestUnit</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">WRONGPATH</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/hello.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">RIGHTPATH</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/MyReader.java"</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">testReadFile</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">RIGHTPATH</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">readFile</span><span class="o">(</span><span class="n">WRONGPATH</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TestUnit</span> <span class="n">test</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">().</span><span class="na">new</span> <span class="n">TestUnit</span><span class="o">();</span>
        <span class="n">test</span><span class="o">.</span><span class="na">testReadFile</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise25java-1">Exercise25.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.*</span><span class="o">;</span>

<span class="c1">// statistics the word and their positions in the file</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise25</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">statistic</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">,</span> <span class="n">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">path</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">regex</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Argument content or regex is null!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyReader</span><span class="o">().</span><span class="na">readFile</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">content</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"The content in "</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">" is null!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">regex</span><span class="o">).</span><span class="na">matcher</span><span class="o">(</span><span class="n">content</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;();</span>
        <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">value</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">matcher</span><span class="o">.</span><span class="na">group</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
                <span class="n">value</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">start</span><span class="o">());</span>
                <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span><span class="n">value</span><span class="o">);</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">group</span><span class="o">(),</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">start</span><span class="o">())));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise25.java"</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">regex</span> <span class="o">=</span> <span class="s">"\\w+"</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">statistic</span><span class="o">(</span><span class="n">path</span><span class="o">,</span><span class="n">regex</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise26java">Exercise26.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise26</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="nf">sortedStatistic</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">,</span> <span class="n">String</span> <span class="n">regex</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">shuffleWordMap</span> <span class="o">=</span> <span class="n">Exercise25</span><span class="o">.</span><span class="na">statistic</span><span class="o">(</span><span class="n">path</span><span class="o">,</span><span class="n">regex</span><span class="o">);</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">indexMap</span> <span class="o">=</span> <span class="n">getIndexMap</span><span class="o">(</span><span class="n">shuffleWordMap</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">indexList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
        <span class="n">indexList</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">indexMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">());</span>
        <span class="n">Collections</span><span class="o">.</span><span class="na">sort</span><span class="o">(</span><span class="n">indexList</span><span class="o">,</span> <span class="k">new</span> <span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
            <span class="kd">public</span> <span class="kt">int</span> <span class="nf">compare</span><span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">entry1</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">entry2</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">entry1</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">compareTo</span><span class="o">(</span><span class="n">entry2</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">sortedWordMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">indexList</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">word</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
            <span class="n">sortedWordMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">word</span><span class="o">,</span><span class="n">shuffleWordMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">word</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sortedWordMap</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getIndexMap</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">shuffleMap</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">resultIndex</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">shuffleMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">resultIndex</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">),</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resultIndex</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter11/Exercise25.java"</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">regex</span> <span class="o">=</span> <span class="s">"\\w+"</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sortedStatistic</span><span class="o">(</span><span class="n">path</span><span class="o">,</span><span class="n">regex</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-27">Exercise 27</h4>
<ul>
  <li><strong>Exercise 27</strong>: (2) Write a class called Command that contains a String and has a method operation( ) that displays the String. Write a second class with a method that fills a Queue with Command objects and returns it. Pass the filled Queue to a method in a third class that consumes the objects in the Queue and calls their operation( ) methods.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise27</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">enum</span> <span class="n">LinuxCommand</span> <span class="o">{</span>
        <span class="n">CD</span><span class="o">,</span><span class="n">LS</span><span class="o">,</span><span class="n">GREP</span><span class="o">,</span><span class="n">FIND</span><span class="o">,</span><span class="n">CP</span><span class="o">,</span><span class="n">MV</span><span class="o">,</span><span class="n">RM</span><span class="o">,</span><span class="n">PS</span><span class="o">,</span><span class="n">KILL</span><span class="o">,</span><span class="n">FILE</span><span class="o">,</span><span class="n">TAR</span><span class="o">,</span><span class="n">CAT</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">name</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="n">LinuxCommand</span> <span class="nf">random</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
            <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">values</span><span class="o">[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">length</span><span class="o">)];</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Command</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">ID</span> <span class="o">=</span> <span class="o">++</span><span class="n">count</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">COMMAND</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Command</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">COMMAND</span> <span class="o">=</span> <span class="n">str</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">operation</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"Command#"</span> <span class="o">+</span> <span class="n">ID</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">COMMAND</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Queue</span><span class="o">&lt;</span><span class="n">Command</span><span class="o">&gt;</span> <span class="nf">fillCommandQueue</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Queue</span><span class="o">&lt;</span><span class="n">Command</span><span class="o">&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">Command</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">queue</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Command</span><span class="o">(</span><span class="n">LinuxCommand</span><span class="o">.</span><span class="na">random</span><span class="o">().</span><span class="na">toString</span><span class="o">()));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">queue</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">printCommands</span><span class="o">(</span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">Command</span><span class="o">&gt;</span> <span class="n">commands</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Command</span> <span class="n">command</span> <span class="o">:</span> <span class="n">commands</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">command</span><span class="o">.</span><span class="na">operation</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//System.out.println(fillCommandQueue(20));</span>
        <span class="n">printCommands</span><span class="o">(</span><span class="n">fillCommandQueue</span><span class="o">(</span><span class="mi">20</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-28">Exercise 28</h4>
<ul>
  <li><strong>Exercise 28</strong>: (2) Fill a PriorityQueue (using offer( )) with Double values created using java.util.Random, then remove the elements using poll( ) and display them.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise28</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="n">PriorityQueue</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;</span> <span class="n">pq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PriorityQueue</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">pq</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pq</span><span class="o">.</span><span class="na">poll</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-29">Exercise 29</h4>
<ul>
  <li><strong>Exercise 29</strong>: (2) Create a simple class that inherits from Object and contains no members, and show that you cannot successfully add multiple elements of that class to a PriorityQueue. This issue will be fully explained in the Containers in Depth chapter.</li>
</ul>

<p>要么构造PriorityQueue的时候给一个Comparator。不然，PriorityQueue里的元素必须实现Comparable接口。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise29</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">NoMemberClass</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="o">{}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">PriorityQueue</span><span class="o">&lt;</span><span class="n">NoMemberClass</span><span class="o">&gt;</span> <span class="n">pq</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PriorityQueue</span><span class="o">&lt;</span><span class="n">NoMemberClass</span><span class="o">&gt;();</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">pq</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="k">new</span> <span class="n">NoMemberClass</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<p>####Exercise 30</p>
<ul>
  <li><strong>Exercise 30</strong>: (5) Modify CollectionSequence.java so that it does not inherit from AbstractCollection, but instead implements Collection.</li>
</ul>

<h5 id="exercise30java">Exercise30.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise30</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">enum</span> <span class="n">LinuxCommand</span> <span class="o">{</span>
        <span class="n">CD</span><span class="o">,</span><span class="n">LS</span><span class="o">,</span><span class="n">GREP</span><span class="o">,</span><span class="n">FIND</span><span class="o">,</span><span class="n">CP</span><span class="o">,</span><span class="n">MV</span><span class="o">,</span><span class="n">RM</span><span class="o">,</span><span class="n">PS</span><span class="o">,</span><span class="n">KILL</span><span class="o">,</span><span class="n">FILE</span><span class="o">,</span><span class="n">TAR</span><span class="o">,</span><span class="n">CAT</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">name</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">LinuxCommand</span> <span class="nf">random</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
            <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">values</span><span class="o">[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">length</span><span class="o">)];</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="nf">randomProgram</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">program</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinuxCommand</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">program</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CommandSequence</span> <span class="kd">implements</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="c1">// object array</span>
        <span class="kd">private</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">program</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">CommandSequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">program</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">randomProgram</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>    <span class="c1">//数组如果满了，循环从头插入</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">program</span><span class="o">[</span><span class="n">cursor</span><span class="o">++]</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">cursor</span> <span class="o">==</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">addAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">c</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">command</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(!</span><span class="n">add</span><span class="o">(</span><span class="n">command</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clear</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">program</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinuxCommand</span><span class="o">[</span><span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">contains</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LinuxCommand</span> <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="n">LinuxCommand</span><span class="o">)</span><span class="n">o</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">ele</span> <span class="o">:</span> <span class="n">program</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">ele</span> <span class="o">==</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">containsAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">c</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">o</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(!</span> <span class="n">contains</span><span class="o">(</span><span class="n">o</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(!(</span><span class="n">o</span> <span class="k">instanceof</span> <span class="n">LinuxCommand</span><span class="o">))</span> <span class="o">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="o">(</span><span class="n">LinuxCommand</span><span class="o">)</span><span class="n">o</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">removeAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">changed</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">c</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">changed</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">o</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">remove</span><span class="o">(</span><span class="n">o</span><span class="o">))</span> <span class="o">{</span>
                    <span class="n">changed</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">changed</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">retainAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">boolean</span> <span class="n">changed</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">c</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">changed</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">o</span> <span class="o">:</span> <span class="k">this</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(!</span><span class="n">c</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">o</span><span class="o">))</span> <span class="o">{</span>
                    <span class="k">if</span><span class="o">(</span><span class="n">remove</span><span class="o">(</span><span class="n">o</span><span class="o">))</span> <span class="o">{</span>
                        <span class="n">changed</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">changed</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Object</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">Object</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
        <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Object</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">result</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="o">(</span><span class="n">T</span><span class="o">[])</span><span class="n">result</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="kd">public</span> <span class="n">LinuxCommand</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">program</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span> <span class="o">}</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Not implemented</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">};</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">InterfaceVsIterator</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="n">ele</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ele</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">ite</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">CommandSequence</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommandSequence</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="n">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise30v2java">Exercise30V2.java</h5>
<p>也有个偷懒的办法，只写一个Iterator类和iterator()方法。其他用不到方法都抛出UnsupportedOperationException。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise30V2</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">enum</span> <span class="n">LinuxCommand</span> <span class="o">{</span>
        <span class="n">CD</span><span class="o">,</span><span class="n">LS</span><span class="o">,</span><span class="n">GREP</span><span class="o">,</span><span class="n">FIND</span><span class="o">,</span><span class="n">CP</span><span class="o">,</span><span class="n">MV</span><span class="o">,</span><span class="n">RM</span><span class="o">,</span><span class="n">PS</span><span class="o">,</span><span class="n">KILL</span><span class="o">,</span><span class="n">FILE</span><span class="o">,</span><span class="n">TAR</span><span class="o">,</span><span class="n">CAT</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">name</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">LinuxCommand</span> <span class="nf">random</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
            <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">values</span><span class="o">[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">length</span><span class="o">)];</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="nf">randomProgram</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">program</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinuxCommand</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">program</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CommandSequence</span> <span class="kd">implements</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="c1">// object array</span>
        <span class="kd">private</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">program</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="c1">//current pointer</span>
        <span class="kd">public</span> <span class="nf">CommandSequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">program</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">randomProgram</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">add</span><span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>    <span class="c1">//数组如果满了，循环从头插入</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">addAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clear</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">contains</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">containsAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">removeAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">retainAll</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Object</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">(</span><span class="n">T</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">program</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="kd">public</span> <span class="n">LinuxCommand</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">program</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span> <span class="o">}</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Not implemented</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">};</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">InterfaceVsIterator</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">T</span> <span class="n">ele</span> <span class="o">:</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ele</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">ite</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">CommandSequence</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommandSequence</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="n">InterfaceVsIterator</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-31">Exercise 31</h4>
<ul>
  <li><strong>Exercise 31</strong>: (3) Modify polymorphism/shape/RandomShapeGenerator.java to make it Iterable. You’ll need to add a constructor that takes the number of elements that you want the iterator to produce before stopping. Verify that it works.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise31</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Shape</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">erase</span><span class="o">()</span> <span class="o">{}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Circle.draw()"</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">erase</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Circle.erase()"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Square</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Square.draw()"</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">erase</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Square.erase()"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Triangle</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Triangle.draw()"</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">erase</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Triangle.erase()"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">RandomShapeGenerator</span> <span class="kd">implements</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">RandomShapeGenerator</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="kd">public</span> <span class="n">Shape</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                    <span class="n">index</span><span class="o">++;</span>
                    <span class="k">switch</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span> <span class="o">{</span>
                        <span class="k">default</span><span class="o">:</span>
                        <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Circle</span><span class="o">();</span>
                        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Square</span><span class="o">();</span>
                        <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Triangle</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">};</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">shapeNum</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="n">RandomShapeGenerator</span> <span class="n">gen</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RandomShapeGenerator</span><span class="o">(</span><span class="n">shapeNum</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Shape</span> <span class="n">s</span> <span class="o">:</span> <span class="n">gen</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">s</span><span class="o">.</span><span class="na">draw</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-32">Exercise 32</h4>
<ul>
  <li><strong>Exercise 32</strong>: (2) Following the example of MultilterableClass, add reversed( ) and randomized( ) methods to NonCollectionSequence.java, as well as making NonCollectionSequence implement Iterable, and show that all the approaches work in foreach statements.</li>
</ul>

<h5 id="linuxcommandjava">LinuxCommand.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="n">LinuxCommand</span> <span class="o">{</span>
    <span class="n">CD</span><span class="o">,</span><span class="n">LS</span><span class="o">,</span><span class="n">GREP</span><span class="o">,</span><span class="n">FIND</span><span class="o">,</span><span class="n">CP</span><span class="o">,</span><span class="n">MV</span><span class="o">,</span><span class="n">RM</span><span class="o">,</span><span class="n">PS</span><span class="o">,</span><span class="n">KILL</span><span class="o">,</span><span class="n">FILE</span><span class="o">,</span><span class="n">TAR</span><span class="o">,</span><span class="n">CAT</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">id</span> <span class="o">=</span> <span class="n">ordinal</span><span class="o">()</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">().</span><span class="na">toLowerCase</span><span class="o">();</span>
        <span class="k">return</span> <span class="s">"Command#"</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">": "</span> <span class="o">+</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">LinuxCommand</span> <span class="nf">random</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">values</span><span class="o">[</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">length</span><span class="o">)];</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">LinuxCommand</span> <span class="nf">orderGet</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">values</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getEnumConstants</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">values</span><span class="o">[(</span><span class="n">index</span> <span class="o">%</span> <span class="n">values</span><span class="o">.</span><span class="na">length</span><span class="o">)];</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="nf">randomProgram</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">program</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinuxCommand</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">program</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="nf">orderProgram</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">program</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinuxCommand</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">program</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">orderGet</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">program</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise32java">Exercise32.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter11</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise32</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CommandSequence</span> <span class="o">{</span>
        <span class="kd">protected</span> <span class="kd">final</span> <span class="n">LinuxCommand</span><span class="o">[]</span> <span class="n">commands</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">CommandSequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">commands</span> <span class="o">=</span> <span class="n">LinuxCommand</span><span class="o">.</span><span class="na">orderProgram</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">NonCollectionCommandSequence</span> <span class="kd">extends</span> <span class="n">CommandSequence</span> <span class="kd">implements</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nf">NonCollectionCommandSequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">commands</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
                <span class="o">}</span>
                <span class="kd">public</span> <span class="n">LinuxCommand</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="n">commands</span><span class="o">[</span><span class="n">index</span><span class="o">++];</span>
                <span class="o">}</span>
            <span class="o">};</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MultiIterableCommandSequence</span> <span class="kd">extends</span> <span class="n">NonCollectionCommandSequence</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nf">MultiIterableCommandSequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">reverse</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;()</span> <span class="o">{</span>
                        <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">;</span>  <span class="c1">//begin from the last element</span>
                        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span>
                            <span class="k">return</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span>
                        <span class="o">}</span>
                        <span class="kd">public</span> <span class="n">LinuxCommand</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                            <span class="k">return</span> <span class="n">commands</span><span class="o">[</span><span class="n">index</span><span class="o">--];</span>
                        <span class="o">}</span>
                    <span class="o">};</span>
                <span class="o">}</span>
            <span class="o">};</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">shuffle</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
                    <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;</span> <span class="n">commandsCopyList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">LinuxCommand</span><span class="o">&gt;(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">commands</span><span class="o">));</span>
                    <span class="n">Collections</span><span class="o">.</span><span class="na">shuffle</span><span class="o">(</span><span class="n">commandsCopyList</span><span class="o">);</span>
                    <span class="k">return</span> <span class="n">commandsCopyList</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">};</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MultiIterableCommandSequence</span> <span class="n">commands</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MultiIterableCommandSequence</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"NORMAL ORDER &gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">command</span> <span class="o">:</span> <span class="n">commands</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"REVERSE ORDER &gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">command</span> <span class="o">:</span> <span class="n">commands</span><span class="o">.</span><span class="na">reverse</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SHUFFLE ORDER &gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">LinuxCommand</span> <span class="n">command</span> <span class="o">:</span> <span class="n">commands</span><span class="o">.</span><span class="na">shuffle</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

        <div class="after-post"></div> <!-- 文章结尾，和Disqus留一些间隔。-->
        <script>
            $("div.after-post").css("margin-bottom","50px");
        </script>

        <!-- Disqus plugin -->
        <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = /java/thinking_in_java/2016/07/10/tij4-11.html;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = /java/thinking_in_java/2016/07/10/tij4-11; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//www-ciaoshen-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
    <!-- .container -->


    <!-- footer bar -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<footer>
    <!-- Don't show tag cloud
    <div class="footer" id="footer">
        <div class="container">
            <div id="tags-cloud-title">
            <div class="row">
                <div class="col-lg-12  col-md-12 col-sm-12 col-xs-12">
                    <h2>Tag Cloud</h2>
                </div>
            </div>
            </div>
            <div id="tags-cloud" class="row">
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_String" href="/tags/String.html">
                        String
                        <span class="badge">5</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Memory_Model" href="/tags/Memory_Model.html">
                        Memory_Model
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JVM" href="/tags/JVM.html">
                        JVM
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hexo" href="/tags/Hexo.html">
                        Hexo
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Github" href="/tags/Github.html">
                        Github
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Blog" href="/tags/Blog.html">
                        Blog
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Git" href="/tags/Git.html">
                        Git
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JDK" href="/tags/JDK.html">
                        JDK
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JRE" href="/tags/JRE.html">
                        JRE
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IDE" href="/tags/IDE.html">
                        IDE
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_OOP" href="/tags/OOP.html">
                        OOP
                        <span class="badge">7</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Initialization" href="/tags/Initialization.html">
                        Initialization
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Control_Flow" href="/tags/Control_Flow.html">
                        Control_Flow
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_GC" href="/tags/GC.html">
                        GC
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Access_Control" href="/tags/Access_Control.html">
                        Access_Control
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Package" href="/tags/Package.html">
                        Package
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Inheritance" href="/tags/Inheritance.html">
                        Inheritance
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Composition" href="/tags/Composition.html">
                        Composition
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Factory_Pattern" href="/tags/Factory_Pattern.html">
                        Factory_Pattern
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Polymorphism" href="/tags/Polymorphism.html">
                        Polymorphism
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Late_Binding" href="/tags/Late_Binding.html">
                        Late_Binding
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_State_Pattern" href="/tags/State_Pattern.html">
                        State_Pattern
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Interface" href="/tags/Interface.html">
                        Interface
                        <span class="badge">5</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Abstract_Class" href="/tags/Abstract_Class.html">
                        Abstract_Class
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Strategy_Pattern" href="/tags/Strategy_Pattern.html">
                        Strategy_Pattern
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Inner_Class" href="/tags/Inner_Class.html">
                        Inner_Class
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Callback" href="/tags/Callback.html">
                        Callback
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Closure" href="/tags/Closure.html">
                        Closure
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Lambda_Expression" href="/tags/Lambda_Expression.html">
                        Lambda_Expression
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Container" href="/tags/Container.html">
                        Container
                        <span class="badge">9</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Array" href="/tags/Array.html">
                        Array
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hash" href="/tags/Hash.html">
                        Hash
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Exception" href="/tags/Exception.html">
                        Exception
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IO" href="/tags/IO.html">
                        IO
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Regular_Expression" href="/tags/Regular_Expression.html">
                        Regular_Expression
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Reflection" href="/tags/Reflection.html">
                        Reflection
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Career_Path" href="/tags/Career_Path.html">
                        Career_Path
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Immutability" href="/tags/Immutability.html">
                        Immutability
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Dynamic_Proxies" href="/tags/Dynamic_Proxies.html">
                        Dynamic_Proxies
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Generics" href="/tags/Generics.html">
                        Generics
                        <span class="badge">8</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Adapter_Pattern" href="/tags/Adapter_Pattern.html">
                        Adapter_Pattern
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Wildcards" href="/tags/Wildcards.html">
                        Wildcards
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_PESC" href="/tags/PESC.html">
                        PESC
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Covariant" href="/tags/Covariant.html">
                        Covariant
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_View" href="/tags/View.html">
                        View
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Iterator" href="/tags/Iterator.html">
                        Iterator
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Fly_Weight" href="/tags/Fly_Weight.html">
                        Fly_Weight
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_LinkedList" href="/tags/LinkedList.html">
                        LinkedList
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Weak_Reference" href="/tags/Weak_Reference.html">
                        Weak_Reference
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Phantom_Reference" href="/tags/Phantom_Reference.html">
                        Phantom_Reference
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_HashMap" href="/tags/HashMap.html">
                        HashMap
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_File" href="/tags/File.html">
                        File
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Stream" href="/tags/Stream.html">
                        Stream
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Encapsulation" href="/tags/Encapsulation.html">
                        Encapsulation
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Unicode" href="/tags/Unicode.html">
                        Unicode
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_UTF-8" href="/tags/UTF-8.html">
                        UTF-8
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_ASCII" href="/tags/ASCII.html">
                        ASCII
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Encoding" href="/tags/Encoding.html">
                        Encoding
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Charset" href="/tags/Charset.html">
                        Charset
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_CPU" href="/tags/CPU.html">
                        CPU
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Process" href="/tags/Process.html">
                        Process
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Block" href="/tags/Block.html">
                        Block
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Logic_Gates" href="/tags/Logic_Gates.html">
                        Logic_Gates
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_NIO" href="/tags/NIO.html">
                        NIO
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Enum" href="/tags/Enum.html">
                        Enum
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Table_Driven" href="/tags/Table_Driven.html">
                        Table_Driven
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Annotations" href="/tags/Annotations.html">
                        Annotations
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hibernate" href="/tags/Hibernate.html">
                        Hibernate
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JUnit" href="/tags/JUnit.html">
                        JUnit
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Spring" href="/tags/Spring.html">
                        Spring
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Syntactic sugar" href="/tags/Syntactic sugar.html">
                        Syntactic sugar
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_AOP" href="/tags/AOP.html">
                        AOP
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Concurrency" href="/tags/Concurrency.html">
                        Concurrency
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Thread" href="/tags/Thread.html">
                        Thread
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_DJ" href="/tags/DJ.html">
                        DJ
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IOC" href="/tags/IOC.html">
                        IOC
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Interrupt" href="/tags/Interrupt.html">
                        Interrupt
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_HTML" href="/tags/HTML.html">
                        HTML
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_CSS" href="/tags/CSS.html">
                        CSS
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Javascript" href="/tags/Javascript.html">
                        Javascript
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JQuery" href="/tags/JQuery.html">
                        JQuery
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Sass" href="/tags/Sass.html">
                        Sass
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Responsive_Design" href="/tags/Responsive_Design.html">
                        Responsive_Design
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Code_Style" href="/tags/Code_Style.html">
                        Code_Style
                        <span class="badge">15</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Builder_Pattern" href="/tags/Builder_Pattern.html">
                        Builder_Pattern
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Instance_Control" href="/tags/Instance_Control.html">
                        Instance_Control
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Singleton" href="/tags/Singleton.html">
                        Singleton
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Comparable" href="/tags/Comparable.html">
                        Comparable
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Clone" href="/tags/Clone.html">
                        Clone
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_API" href="/tags/API.html">
                        API
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Template_Pattern" href="/tags/Template_Pattern.html">
                        Template_Pattern
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Jekyll" href="/tags/Jekyll.html">
                        Jekyll
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Bootstrap" href="/tags/Bootstrap.html">
                        Bootstrap
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_SSH" href="/tags/SSH.html">
                        SSH
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_RSA" href="/tags/RSA.html">
                        RSA
                        <span class="badge">1</span>
                        </a>
                    </div>
                
            </div>
        </div>
    </div>
    don't need tag cloud here -->

    <div class="footer-bottom">
        <div class="container">
            <p class="pull-left"> Copyright © <b>Wei SHEN</b> &nbsp | &nbsp Designed by <b>Wei SHEN</b> &nbsp | &nbsp Coded by <b>Wei SHEN</b> &nbsp | &nbsp 2015-2017. All right reserved.  &nbsp | &nbsp  Contact me: <b>symantec__@hotmail.com</b> </p>
            <div class="pull-right">
                <ul class="social">

                </ul>
            </div>
        </div>
    </div>
    <!--/.footer-bottom-->
</footer>



    <!-- Bootstrap Core JavaScript -->
    <script src="/assets/js/bootstrap.min.js"></script>
    <!-- Add space between two paragraph -->
    <script src="/assets/js/span.js"></script>
    <!-- Adjust images size -->
    <script src="/assets/js/imgResponsive.js"></script>
    <!-- Disqus comment count plugin -->
    <script id="dsq-count-scr" src="//www-ciaoshen-com.disqus.com/count.js" async></script>

</body>

</html>
