<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Thinking {SHEN}</title>

    <!-- Bootstrap Core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Blog Template CSS -->
    <link href="/assets/css/blog.css" rel="stylesheet">
    <!-- jQuery Version 1.11.1 -->
    <script src="/assets/js/jquery.js"></script>
    <!-- footer bar -->
    <link href="/assets/css/footer.css" rel="stylesheet">
    <!-- code highlight. I also have other options. But this one looks good! -->
    <link href="/assets/css/jekyll-github.css" rel="stylesheet">
    <!-- Sidebar -->
    <!--<link href="/assets/css/sidebar.css" rel="stylesheet">-->


    <!-- Custom CSS -->
    <style>
        body {
            padding-top: 70px;
            /* Required padding for .navbar-fixed-top. Remove if using .navbar-static-top. Change if height of navigation changes. */
        }
        .container {
            width: 80%;
        }
    </style>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="">Thinking {SHEN}</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="/resume/">Resume</a>
                    </li>
                    <li>
                        <a href="/thinkinginjava/">Thinking in Java</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Container -->
    <div class="container">

        <!-- Page Title -->
        <div class="text-center">
      <!-- page-header是Bootstrap内置页头组件 -->
      <div class="page-header">
          <h1>[Thinking in Java] Note: Chapter 12 - Error Handling with Exception</h1>
      </div>
      <h5 class="blog-post-meta">
                <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span> &nbsp
                2016-07-17 05:50:10 -0400
                &nbsp | &nbsp
                <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> &nbsp
            
                <a href="/categories/Java.html"><span class="label label-primary"><b>Java</b></span></a>
                &nbsp
            
                <a href="/categories/Thinking_in_Java.html"><span class="label label-primary"><b>Thinking_in_Java</b></span></a>
                &nbsp
            
                &nbsp | &nbsp
                <span class="glyphicon glyphicon-comment" aria-hidden="true"></span> &nbsp
                <a href="#disqus_thread "></a>
      </h5>
      <h5 class="blog-post-meta">
          <span class="glyphicon glyphicon-tags" aria-hidden="true"></span> &nbsp
          
              <a href="/tags/Exception.html"><span class="label label-default">Exception</span></a>
              &nbsp
          
              <a href="/tags/IO.html"><span class="label label-default">IO</span></a>
              &nbsp
          
      </h5>
</div>


        <!-- Page Content -->
        <h3 id="我必须记住的惯用法">我必须记住的惯用法</h3>
<h4 id="io读写用双层try和finally保证每次资源都被正确关闭">IO读写，用双层try，和finally保证每次资源都被正确关闭</h4>
<p>这个惯用法在处理IO的时候，非常常用。所以放在最前面。有的时候，记住一个惯用法，胜过万语千言。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="s">"/filePath/fileName.txt"</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span> <span class="c1">//每次创建一个需要清理的对象，后面马上紧跟一个try{}finally{}块。在finally里把资源清理。</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// do something with the file</span>
            <span class="n">String</span> <span class="n">path2</span> <span class="o">=</span> <span class="s">"/filePath/fileName.txt"</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">BufferedReader</span> <span class="n">br2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path2</span><span class="o">)));</span>   <span class="c1">//后面要打开的文件也照样二层套嵌</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="c1">// do something with the second file</span>
                <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                    <span class="k">try</span> <span class="o">{</span>
                        <span class="n">br2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="异常exception">异常（Exception）</h3>
<p>首先，<strong>异常（Exception）</strong> 是指阻止当前程序继续执行的问题。一个典型的异常出现的场景，就是<strong>IO读取文件</strong>。为什么呢？因为本来处理文本的函数设计地很好，但读进来的万一是个空文件怎么办？而且在对几万甚至几亿个文件读取过程中，出现几个空文件，太正常了。</p>

<h4 id="每种异常exception都是一个类">每种异常（Exception）都是一个类</h4>
<p>Java号称什么都是类，所以异常（Exception）当然也是类。所有异常的共同祖先（基类）是<strong>Throwable类</strong>。Oracle官方手册这是这样描述Throwable类的：</p>
<blockquote>
  <p><strong>Throwable是Java所有error和exception的基类。</strong></p>
</blockquote>

<p>Throwable最常用的一个子类就是Exception类。有时候我们不知道要要捕获什么类，或者向上转型都是转到这个Exception类。Throwable和Exception的声明形式如下，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Throwable</span> <span class="kd">extends</span> <span class="n">Object</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exception</span> <span class="kd">extends</span> <span class="n">Throwable</span> <span class="o">{}</span>
</code></pre>
</div>

<p>下图是Java Exception类的家族信息：
<img src="/images/tij4-12/exception.png" alt="exception" /></p>

<p>上图中最著名的就是这个<strong>RuntimeException</strong>了。它在java.lang包下。其他一些大家耳熟能详，闻风丧胆的名字比如说：</p>
<ul>
  <li>数组下标越界异常：ArrayIndexOutOfBoundsException</li>
  <li>文件未找到异常：FileNotFoundException</li>
  <li>输入输出异常：IOException</li>
  <li>方法未找到异常：NoSuchMethodException</li>
</ul>

<p>它们都分别被定义在各自对应的特殊的包里。比较集中的有java.lang, java.util, java.io等几个常用包。</p>

<h4 id="自定义异常类">自定义异常类</h4>
<p>如果Java自带的异常类不能满足我们的需求，还可以自定义新的异常类。需要<strong>！！注意</strong>：因为Throwable实现了Seriallizable接口，因此要求有一个<strong>serialVersionUID</strong>成员字段。否则会抛出warning。</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>warning: <span class="o">[</span>serial] serializable class LoggingException has no definition of serialVersionUID
</code></pre>
</div>
<p>因此自定义一个新的异常类型，需要这样写：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">NewExeption</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;}</span>
</code></pre>
</div>

<p>对于自定义异常类型，需要记住一点：</p>
<blockquote>
  <p><strong>一定要取一个合适的名字！一定要取一个合适的名字！一定要取一个合适的名字！</strong></p>
</blockquote>

<p>重要的事情说三遍。因为往往异常类内部并不包含太多其他信息字段，通常<strong>名字就代表了一个异常全部的有效信息</strong>。</p>

<p>Exception的两种常用的构造函数：一个默认无参数，一个以String为参数。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">new</span> <span class="n">NullPointerException</span><span class="o">();</span>
<span class="k">new</span> <span class="nf">NullPointerException</span><span class="o">(</span><span class="s">"t = null"</span><span class="o">);</span>
</code></pre>
</div>

<h3 id="抛出throw">抛出throw</h3>
<p>遇到可能抛出的异常，有两种对待方法，一种就是处理掉，另一种就是搁置。如果在函数内部直接能就地处理掉，那一般也没必要抛出异常了。异常处理的价值就在于能延迟异常被处理时机。比如，下面这个简单的函数，把传入的String从中间一刀两断，只返回前半段字符串。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">halfString</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">){</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()/</span><span class="mi">2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>
<p>但如果传入的参数String是null的话，系统就会抛出一个NullPointerException。</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>Exception <span class="k">in </span>thread <span class="s2">"main"</span> java.lang.NullPointerException
	at com.ciaoshen.thinkinjava.chapter12.Test.splitString<span class="o">(</span>Test.java:10<span class="o">)</span>
	at com.ciaoshen.thinkinjava.chapter12.Test.main<span class="o">(</span>Test.java:14<span class="o">)</span>
</code></pre>
</div>
<p>但这函数只是被调用来负责切割，对其他函数怎么读取文本文件的过程一无所知。如果读取到了空String，最合适的处理场景是在读取文本，并调用切割函数的函数内部。</p>

<p>所以异常处理的一个核心理念，就是在遇到无法就地处理的异常的时候，可以先 <strong>”抛出“</strong> 这个异常，表示待定。等待有足够信息解决这个异常的环境，或者是集中处理一批相似异常，以减少代码冗余。“抛出”这个动作由 <strong>“throw”</strong> 这个关键字完成。throw实际执行的操作，就是 <strong>“return”</strong> 返回这个exception类型对象。比如之前的代码，编译器遇到空String的时候，会自动抛出NullPointerException。显式地写出来就像下面这样：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">halfString</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">){</span>
	<span class="k">if</span><span class="o">(</span><span class="n">s</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
		<span class="k">throw</span> <span class="k">new</span> <span class="nf">NullPointerException</span><span class="o">();</span>
	<span class="o">}</span><span class="k">else</span><span class="o">{</span>
		<span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()/</span><span class="mi">2</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<h4 id="runtimeexception不用抛出">RuntimeException不用抛出</h4>
<p>系统之所以不显式的写出来，是因为NullPointerException属于RuntimeException，属于系统默认检查的范围，不需要写出来也会检查。</p>

<h3 id="函数声明抛出异常exception-specification">函数声明抛出异常（Exception Specification）</h3>
<p>当函数抛出了一个异常，但内部又没有处理的时候，就必须在函数后加上异常声明 <strong>“exception specification”</strong>。 声明异常的时候使用关键字 <strong>“throws”</strong>，注意不是throw。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">halfString</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">NullPointerException</span><span class="o">{</span>
	<span class="k">if</span><span class="o">(</span><span class="n">s</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
		<span class="k">throw</span> <span class="k">new</span> <span class="nf">NullPointerException</span><span class="o">();</span>
	<span class="o">}</span><span class="k">else</span><span class="o">{</span>
		<span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()/</span><span class="mi">2</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>这句话的意思是：<strong>我这函数可能会抛出这个异常，调用此函数必须要处理它可能抛出的异常。</strong></p>

<p>可以同时声明抛出好几个异常，用 <strong>逗号”,”</strong> 连接。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">TooBig</span><span class="o">,</span> <span class="n">TooSmall</span><span class="o">,</span> <span class="n">DivZero</span> <span class="o">{</span>
    <span class="c1">//...</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="runtimeexception也不需要声明">RuntimeException也不需要声明</h4>
<p>但这里还是因为NullPointerException属于RuntimeException，系统默认存在，所以也可以不显式地声明异常。但<strong>其他不是RuntimeException的其他异常就必须声明</strong>。上面的声明和下面这样的写法是一样的：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">halfString</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">){</span>
	<span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()/</span><span class="mi">2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="异常处理handlertry-catch-finally">异常处理handler：try, catch, finally</h3>
<p>异常抛出以后，抛出它的函数可以不管，但总有地方要处理。处理的语法很简单，著名的<strong>try{}catch{}finally{}</strong>三连发大家都知道。</p>
<ul>
  <li><strong>try{}</strong>：守卫区Guarded Region。隔离执行可能抛出异常的函数或代码。</li>
  <li><strong>catch{}</strong>：处理区Handler。捕获异常，并进行处理。</li>
  <li><strong>finally{}</strong>：以上两步执行动作和处理动作完成之后，无论如何都会进行的收尾工作。</li>
</ul>

<p>比如面对刚才可能抛出NullPointerException的halfString()函数，要调用它，必须把它放在try{}区块里，然后在catch{}区块处理它抛出的异常。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">callHalfString</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">){</span>
        <span class="n">String</span> <span class="n">result</span><span class="o">=</span><span class="s">""</span><span class="o">;</span>
        <span class="k">try</span><span class="o">{</span>	<span class="c1">//隔离执行可能抛出异常的函数或代码</span>
            <span class="n">result</span><span class="o">=</span><span class="n">Test</span><span class="o">.</span><span class="na">halfString</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="o">){</span>		<span class="c1">//处理异常</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"The parameter string is null! Ignore it!"</span><span class="o">);</span>
        <span class="o">}</span><span class="k">finally</span><span class="o">{</span>	<span class="c1">//完成后的后续操作</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="finally是用来干什么的">finally是用来干什么的？</h4>
<p>上面的finally里面打印了抛出的异常。但实际上打印哪里都可以，一般都放在catch{}区块里，捕获了就打印。那finally是用来干什么的呢？况且finally还有一个重要的特性：无论try{}区块有没有正常完成，无论catch{}有没有捕获到异常，finally里的代码都会被执行。哪怕是在try和catch里有return也是一样（因为异常的throw就等同于一个return操作）。</p>

<p>书上是这么说的：</p>
<blockquote>
  <p><strong>The finally clause is necessary when you need to set something other than memory back to its original state.</strong></p>
</blockquote>

<p>也就是说，finally是用来做收尾清理工作的。尤其是函数和外部资源交互的时候，有的时候必须确保交互的资源被正确地恢复到操作之前的初始状态，无论函数本身的操作有没有正确地完成。</p>

<h4 id="也可以不处理继续往上抛">也可以不处理，继续往上抛</h4>
<p>当然callHalfString()函数如果还是处理不了异常，比如例子里这样，它其实还只是一个中介函数，还不是真正读取外部文件的地方。这时候，callHalfString也可以不处理，而是继续声明异常，继续甩锅！让上一级调用的函数负责处理。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">callHalfString2</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">NullPointerException</span><span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span><span class="o">=</span><span class="n">Test</span><span class="o">.</span><span class="na">halfString</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>
<p>这就是所谓的延迟异常处理的时间和场景，甚至可以有意归拢底层异常，在某个模块中集中处理。</p>

<h4 id="异常链--cause">异常链 &amp; cause</h4>
<p>有的时候，就算是甩锅也可以甩地有节操一点，比如说包装一下，再脱手。
Throwable基类里已经定义了<strong>Throwable#initCause(Throwable cause)</strong>方法。因为Exception继承自Throwable基类，任何Exception的派生类都自带initCause()方法。它的作用就是<strong>把A异常当做B异常的原因，包装到B异常里。</strong></p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">callHalfString</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">MyException</span><span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span><span class="o">=</span><span class="s">""</span><span class="o">;</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="n">result</span><span class="o">=</span><span class="n">Test</span><span class="o">.</span><span class="na">halfString</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">MyException</span> <span class="n">me</span><span class="o">=</span><span class="k">new</span> <span class="n">MyException</span><span class="o">();</span>
            <span class="n">me</span><span class="o">.</span><span class="na">initCause</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>	<span class="c1">//对捕获的NullPointerException进行包装</span>
            <span class="k">throw</span> <span class="n">me</span><span class="o">;</span>	<span class="c1">//再次抛出</span>
        <span class="o">}</span><span class="k">finally</span><span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre>
</div>
<p>这时候，捕捉到MyException()，打印出来，一层一层传递过来的错误都会列出来。</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>//后捕获到的MyException异常
com.ciaoshen.thinkinjava.chapter12.MyException
	at com.ciaoshen.thinkinjava.chapter12.Test.callHalfString4<span class="o">(</span>Test.java:55<span class="o">)</span>
	at com.ciaoshen.thinkinjava.chapter12.Test.main<span class="o">(</span>Test.java:66<span class="o">)</span>
//之前捕获的NullPointerException异被当成原因包装在MyException里面。打印的时候一起被打印出来。
Caused by: java.lang.NullPointerException
	at com.ciaoshen.thinkinjava.chapter12.Test.halfString<span class="o">(</span>Test.java:12<span class="o">)</span>
	at com.ciaoshen.thinkinjava.chapter12.Test.callHalfString4<span class="o">(</span>Test.java:53<span class="o">)</span>
	... 1 more
</code></pre>
</div>

<p>只有 <strong>Error</strong>, <strong>Exception</strong> 和 <strong>RunTimeException</strong> 三个异常可以把cause作为构造器的参数，其他异常必须用initCause()方法来初始化cause。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="o">){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>	<span class="c1">//构造RuntimeException可以直接把cause当作构造函数的参数。</span>
        <span class="o">}</span>
</code></pre>
</div>

<h4 id="runtimeexception还是完全不用处理">RuntimeException还是完全不用处理</h4>
<p>RuntimeException继续之前的神勇表现，完全不需要try{}catch{}finally{}这一套。当它不存在就好了。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">callHalfString2</span><span class="o">(</span><span class="n">String</span> <span class="n">line</span><span class="o">){</span>
        <span class="n">String</span> <span class="n">result</span><span class="o">=</span><span class="n">Test</span><span class="o">.</span><span class="na">halfString</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="java是termination模型不主动回到出错点">Java是Termination模型，不主动回到出错点</h3>
<p>Java和C++的异常处理流程支持的是 <strong>“终止模型(Termination)”</strong>。捕获异常之后，无论处理结果如何，都不在回到try{}的区块里继续执行出错的代码或函数。
还有一种处理方法叫 <strong>“恢复模型(Resumption)”</strong>。就是指会回到try{}的区块里。</p>

<p>但技术上可以用while loop强制回到try{}区块，直到代码正常运行为止。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">callHalfString</span><span class="o">(){</span>
	<span class="n">String</span><span class="o">[]</span> <span class="n">strList</span><span class="o">=</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">5</span><span class="o">];</span>
	<span class="n">strList</span><span class="o">[</span><span class="mi">0</span><span class="o">]=</span><span class="s">"zero"</span><span class="o">;</span>
	<span class="n">strList</span><span class="o">[</span><span class="mi">1</span><span class="o">]=</span><span class="kc">null</span><span class="o">;</span>	<span class="c1">//空记录，导致异常</span>
	<span class="n">strList</span><span class="o">[</span><span class="mi">2</span><span class="o">]=</span><span class="s">"two"</span><span class="o">;</span>
	<span class="n">strList</span><span class="o">[</span><span class="mi">3</span><span class="o">]=</span><span class="s">"three"</span><span class="o">;</span>
	<span class="n">strList</span><span class="o">[</span><span class="mi">4</span><span class="o">]=</span><span class="s">"four"</span><span class="o">;</span>

	<span class="c1">//可以用loop强制回到try{}区块里</span>
	<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
        <span class="n">String</span> <span class="n">result</span><span class="o">=</span><span class="s">""</span><span class="o">;</span>
        <span class="k">try</span><span class="o">{</span>	<span class="c1">//隔离执行可能抛出异常的函数或代码</span>
            <span class="n">result</span><span class="o">=</span><span class="n">Test</span><span class="o">.</span><span class="na">halfString</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">NullPointerException</span> <span class="n">e</span><span class="o">){</span>		<span class="c1">//处理异常：打印空记录位置后跳转到下一条</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Index="</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">" is null!"</span><span class="o">);</span>
        <span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="一个异常里到底记录了什么">一个异常里到底记录了什么？</h3>
<p>前面已经多次显示了，一个异常在console里打印出来是什么样子。</p>

<h4 id="怎么看一个异常记录了什么">怎么看一个异常记录了什么？</h4>
<p>最简单的直接用System.out.println()打印，就是直接调用Exception基类的toString()函数，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
	<span class="n">f</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">MyException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">//Output:</span>
<span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">.</span><span class="na">MyException</span>
</code></pre>
</div>
<p>可以看到，toString()打印的实际上是 <strong>package name</strong> + <strong>class name</strong>。</p>

<p>想要打印全部调用历史记录的，可以调用 Throwable接口定义的 <strong>printStackTrace()</strong> 方法。printStackTrace()方法可以接受一个PrintStream型的参数，而System.out正好就是那个PrintStream型。
<img src="/images/tij4-12/printStackTrace.png" alt="printStackTrace" />
<img src="/images/tij4-12/systemOut.png" alt="systemOut" /></p>

<p>如下面代码，把<strong>System.out</strong>当成printStackTrack()的参数，打印异常，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
	<span class="n">f</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

<p>打印出来的内容，包含两部分，除了刚才toString()也会打的包名+类名之外，还会列出线程执行过程中每一次的函数的调用历史清单，叫做 <strong>“栈轨迹”</strong>。</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>com.ciaoshen.thinkinjava.chapter12.LoggingException	//包名+类名
	at com.ciaoshen.thinkinjava.chapter12.CatchThrow.testLoggingException<span class="o">(</span>CatchThrow.java:37<span class="o">)</span>	//历史调用记录
	at com.ciaoshen.thinkinjava.chapter12.CatchThrow.main<span class="o">(</span>CatchThrow.java:63<span class="o">)</span>	//历史调用记录
</code></pre>
</div>

<h4 id="配合log日志使用">配合Log日志使用</h4>
<p>Java最常用的util库有一个日志包：<strong>java.util.logging</strong>。配合Exception使用，可以生成更详细的执行信息清单。比如下面代码自定义了一个AutoLogException异常类，继承自基类Exception。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.logging.*</span><span class="o">;</span>	<span class="c1">//日志库</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>	<span class="c1">//读外部文档</span>

<span class="kd">class</span> <span class="nc">AutoLogException</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">{</span>

    <span class="cm">/**
     *  PUBLIC METHOD
     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printLogging</span><span class="o">(){</span>
        <span class="n">StringWriter</span> <span class="n">trace</span><span class="o">=</span><span class="k">new</span> <span class="n">StringWriter</span><span class="o">();</span>  <span class="c1">//create a PrintStream</span>
        <span class="n">printStackTrace</span><span class="o">(</span><span class="k">new</span> <span class="n">PrintWriter</span><span class="o">(</span><span class="n">trace</span><span class="o">));</span>    <span class="c1">//add trace information to the PrintStream</span>
        <span class="n">autoLogger</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="n">trace</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>    <span class="c1">//convert the PrintStream to the String and add it into the Logger</span>
    <span class="o">}</span>

    <span class="cm">/**
     *  PRIVATE FIELDS
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>	<span class="c1">//Throwable接口规格</span>
    <span class="kd">private</span> <span class="n">Logger</span> <span class="n">autoLogger</span><span class="o">=</span><span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"Auto Logger"</span><span class="o">);</span>	<span class="c1">//Logger</span>
<span class="o">}</span>
</code></pre>
</div>
<p>AutoLogException类中，定义了一个用来打印日志信息的成员方法printLogging()，其具体操作步骤如下：</p>
<ul>
  <li>先获得一个Logger对象</li>
  <li>Logger#severe(String msg)方法把一个String当重要消息写进Logger</li>
  <li>然后Logger对象会自动把这个它获得的message传递给System.err对象（它是一个PrintStream对象），我们就可以用它打印了。</li>
  <li>关键是怎么获取Exception的异常消息呢？这时候需要用printStackTrace(PrintWriter s)方法</li>
  <li>但PrintWriter不能直接转换成String。需要在构造函数里给一个StringWriter做参数。然后利用StringWriter#toString()把trace信息转成String型。</li>
  <li>最后把这个String传给Logger#severe(String msg)大功告成</li>
</ul>

<p>最后在main里捕获AutoLogException后，直接调用printLogging()方法，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">AutoLogException</span><span class="o">();</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">AutoLogException</span> <span class="n">ale</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caught "</span><span class="o">+</span><span class="n">ale</span><span class="o">);</span>
            <span class="n">ale</span><span class="o">.</span><span class="na">printLogging</span><span class="o">();</span>
        <span class="o">}</span>        
    <span class="o">}</span>
</code></pre>
</div>

<p>打印出日志信息如下：</p>
<div class="highlighter-rouge"><pre class="highlight"><code>//System.err.println("Caught "+ale)这行代码的输出，说明Exception基类的toString()方法输出的是package name + class name Caught com.ciaoshen.thinkinjava.chapter12.AutoLogException

//这部分是在没有往Logger里填充trace信息时候autoLogger.severe()方法负责加的Logger报头。
juil. 21, 2016 3:37:43 PM com.ciaoshen.thinkinjava.chapter12.AutoLogException printLogging
GRAVE:

//下面这部分是实际trace信息。也就是printStackTrace()方法填充到StringWriter对象里的信息。
com.ciaoshen.thinkinjava.chapter12.AutoLogException at com.ciaoshen.thinkinjava.chapter12.AutoLogException.main(AutoLogException.java:48)
</code></pre>
</div>

<p>可以看到，除了printStackTrace()方法也也会打印的包名，类名，以及函数调用记录以外，autoLogger.severe()方法在中间加了一个Logger报头。其中：</p>
<ul>
  <li>juil. 21, 2016 3:37:43 PM 当然是异常产生的时间。</li>
  <li>com.ciaoshen.thinkinjava.chapter12.AutoLogException printLogging 是异常产生的场景</li>
  <li>最后<strong>GRAVE</strong>代表异常的严重等级。因为我们是用Logger#severe()方法打包的，等级就是严重。Logger里当然还包含其他等级。</li>
</ul>

<h3 id="关于异常的继承">关于异常的继承</h3>
<p>既然函数可以声明抛出异常，那事情就变得复杂了。因为涉及到类的方法，就会同时涉及到类的继承。当基类的某一方法声明抛出某一异常，那派生类中的同方法会不会也抛出这个异常？</p>

<p>虽然Java为了异常处理的<strong>“健壮性”</strong>考虑，把规则设置地有点复杂，但细心梳理还是能归纳出一个逻辑条理的：</p>
<ul>
  <li><strong>首先</strong>，基本面，继承类中的“方法”是在基类基础上做“加法”，Exception在基类基础上做“减法”。<strong>基类没有声明的不许有，基类有的可以没有。</strong></li>
  <li><strong>其次</strong>，构造方法是个例外，可以声明基类构造方法没有的异常。也可以不包括基类已经声明的异常。总之就是，<strong>和基类完全没有任何关系</strong>。</li>
  <li><strong>第三</strong>，由于异常也是类，也可以被继承。<strong>父异常的派生异常，视同于父异常，可被父异常的handler捕获。</strong></li>
  <li><strong>第四</strong>，<strong>基类是爹，接口是娘。</strong>当一个类同时继承了一个基类和实现了一个接口。当接口中声明了基类中没有的异常，<strong>以基类为准</strong>。</li>
</ul>

<p>其中最重要的是第一条，而且很好理解，一切都是为了<strong>向上转型</strong>。派生类可以有基类没有的方法，是因为派生类向上转型以后，编译器可以规定只允许调用基类中定义了的方法。比如说企鹅的例子：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Bird</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="nf">fly</span><span class="o">(){};</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Penguin</span> <span class="kd">extends</span> <span class="n">Bird</span><span class="o">{</span>
	<span class="kd">public</span> <span class="nf">fly</span><span class="o">(){};</span>
	<span class="kd">public</span> <span class="nf">swim</span><span class="o">(){};</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(){</span>
		<span class="n">Bird</span> <span class="n">birdPenguin</span><span class="o">=</span><span class="k">new</span> <span class="n">Penguin</span><span class="o">();</span>		<span class="c1">//企鹅向上转型成鸟类</span>
		<span class="n">birdPenguin</span><span class="o">.</span><span class="na">fly</span><span class="o">();</span>
		<span class="c1">//birdPenguin.swin();		//编译器可以禁止鸟类游泳</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>企鹅继承了鸟基类，鸟都不会游泳，但企鹅会。当企鹅向上转型成鸟之后，编译器通过语法检查，可以禁止作为鸟类的企鹅去游泳。因为编译器语法检查的依据就是基类的方法表。虽然Java是后期绑定，会把方法表上的名字和实际调用的函数绑定起来，但方法表上连这个名字都没有，编译器当然是不允许调用的。</p>

<p>但异常处理就不是这么回事了。编译器是没有办法禁止代码出现异常的。还是企鹅的例子：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Bird</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="nf">fly</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">hitWindowException</span><span class="o">{};</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Penguin</span> <span class="kd">extends</span> <span class="n">Bird</span><span class="o">{</span>
	<span class="kd">public</span> <span class="nf">fly</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">cannotFlyException</span><span class="o">{};</span>	<span class="c1">//声明基类没有声明的异常是不允许的</span>
	<span class="kd">public</span> <span class="nf">swim</span><span class="o">(){};</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(){</span>
		<span class="n">Bird</span> <span class="n">birdPenguin</span><span class="o">=</span><span class="k">new</span> <span class="n">Penguin</span><span class="o">();</span>		<span class="c1">//企鹅向上转型成鸟类</span>
		<span class="k">try</span><span class="o">{</span>
			<span class="n">birdPenguin</span><span class="o">.</span><span class="na">fly</span><span class="o">();</span>
		<span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">hitWindowException</span> <span class="n">hwe</span><span class="o">){</span>		<span class="c1">//根据基类Bird的异常声明，编译器知道鸟都有撞墙的毛病，可以强制要求检查鸟有没有撞墙</span>
			<span class="c1">//do something ...</span>
		<span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">cannotFlyException</span> <span class="n">cfe</span><span class="o">){</span>		<span class="c1">//但编译器根据基类Bird的异常声明，无法知道企鹅身为鸟类，竟然有不会飞的毛病。编译器认为所有鸟都是会飞的。</span>
											<span class="c1">//编译器无法强制程序员加上检查鸟会不会飞的语句</span>
											<span class="c1">//可是企鹅就是不会飞，于是程序就出现了一个漏洞，就不健壮了。</span>
			<span class="c1">//do something ...</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>把上面代码里的注释直接搬过来。根据基类Bird的异常声明，编译器只知道鸟都有撞墙的毛病，可以强制要求程序员检查鸟有没有撞墙。但如果作为鸟类的企鹅有不会飞的毛病。当企鹅向上转型成鸟类，编译器做语法检查，通过查找鸟类的异常声明，是不可能知道企鹅身为鸟类，竟然不会飞。编译器认为所有鸟都是会飞的。编译器无法强制程序员加上检查鸟会不会飞的语句。所以当企鹅不会飞的异常出现的时候，于是程序就出现了一个漏洞，就不健壮了。</p>

<p>这就是Java异常处理为什么麻烦的原因。其实是编译器从语法的角度不允许。</p>

<h3 id="异常处理常见的坑">异常处理常见的坑</h3>
<p>基本的语法都说完了，下面讲讲书里提到的一些常见的坑。</p>

<h4 id="尽量不要在构造函数里声明异常">尽量不要在构造函数里声明异常</h4>
<p>语法上，构造器也是可以声明异常的。比如这样，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Bird</span> <span class="o">{</span>
	<span class="n">Bird</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">hitWindowException</span><span class="o">{};</span>
<span class="o">}</span>
</code></pre>
</div>

<p>但，当出现派生类之后，你就不得不面对这样的尴尬：派生类构造器调用基类构造器super()的时候还需要检查异常。就像这样，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Penguin</span> <span class="kd">extends</span> <span class="n">Bird</span> <span class="o">{</span>
	<span class="n">Penguin</span><span class="o">(){</span>
		<span class="k">try</span><span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
			<span class="c1">//do something here...</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>这当然是不可以的，编译器会报错。因为<strong>调用基类构造器super()，必须在派生类构造器的第一行</strong>。</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>call to super must be first statement <span class="k">in </span>constructor
</code></pre>
</div>

<p>这时候的workaround办法就是派生类构造器里不处理基类构造器的异常，转而直接抛出甩锅：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Penguin</span> <span class="kd">extends</span> <span class="n">Bird</span> <span class="o">{</span>
	<span class="n">Penguin</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">hitWindowException</span><span class="o">{</span>
		<span class="kd">super</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="构造函数之后销毁对象的正确姿势">构造函数之后销毁对象的正确姿势</h4>
<p>关于异常处理，构造函数还有一个坑，就是对象的销毁。为了确保对象在使用完了之后才被销毁，我们可能想当然地在finally里销毁对象，就像这样，</p>
<div class="highlighter-rouge"><pre class="highlight"><code>B b;
public dispose(){}

public f(){
	try{
		B b=new B();
	}catch(Exception e){
		//do something here...
	}finally{
		dispose();	//千万别在这里销毁b
	}
}
</code></pre>
</div>
<p>A类里有一个B类成员字段。可是B类的构造函数会抛出异常。在成员方法f()里，我们需要构建一个B类对象b。一系列操作之后，在finally里调用销毁函数dispose()想把b对象销毁。</p>

<p>这里的问题是，<strong>当B类的构造函数出现异常的时候，b对象还没有构造完成。这时候调用dispose()就可能会出错</strong>。因为销毁的函数都是基于正确构造好的对象来写的。</p>

<p>这时候，正确的销毁b对象的姿势是：<strong>两层套嵌try结构</strong>。具体如下，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">try</span><span class="o">{</span>
	<span class="n">B</span> <span class="n">b</span><span class="o">=</span><span class="k">new</span> <span class="n">B</span><span class="o">();</span><span class="c1">//在第一层try里构造b</span>
	<span class="k">try</span><span class="o">{</span>
		<span class="c1">//use the b here...</span>
	<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
		<span class="n">dispose</span><span class="o">();</span><span class="c1">//用完了在第二层finally{}里销毁</span>
	<span class="o">}</span>
<span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
	<span class="c1">//do something here...</span>
<span class="o">}</span>
</code></pre>
</div>
<p>这个结构在第一层try里构造b。然后使用b的时候再开一个第二层try{}，用完了b在第二层finally{}里销毁b。如果构造b的时候抛出异常了，会直接跳转到第一层的catch{}里，不会进入到使用以及销毁对象的第二层try{}finally{}。</p>

<p>这里使用第二层try{}finally{}，然后在第二层finally{}里销毁b的好处是，哪怕在第二层try{}里使用b的过程中发生了什么异常，finally{}里的dispose()销毁动作是无论如何都会触发的。</p>

<p>所以，这个结构能够确保只有在构造器的构造完成之后才执行dispose()方法。这都是前人在工作总结出的智慧，全是干货。</p>

<h4 id="异常丢失">异常丢失</h4>
<p>由于异常本身的性质，在下面两种情况下，异常会消失。</p>

<p>#####第一种：基异常放在了派生异常的前面
第一种丢失原因很简单，因为编译器在类型判断的时候，会自动的向上转型，所有派生类都会被等同于基类。所以在catch异常的时候，如果先检查基异常，那所有的派生异常也都会被捕获，导致后面的派生异常的检查语句永远无法触发。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">try</span><span class="o">{</span>
	<span class="c1">//do something here...</span>
<span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>	<span class="c1">//所有的异常都将在这里被捕获。基类Exception覆盖了后面的RuntimeException。</span>
	<span class="c1">//do something here...</span>
<span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">RuntimeException</span> <span class="n">re</span><span class="o">){</span>
	<span class="c1">//do something here...</span>
<span class="o">}</span>
</code></pre>
</div>
<p>Java编译器编译的时候会对语法进行检查，出现这种情况，编译器会报错，</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>error: exception NullPointerException has already been caught
</code></pre>
</div>

<p>#####第二种：finaly里抛出的异常覆盖try中的异常
第二种异常丢失比较隐蔽。出现在之前讲的两层try{}结构里。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">VeryImportantException</span> <span class="o">{</span>
	<span class="k">throw</span> <span class="k">new</span> <span class="nf">VeryImportantException</span><span class="o">();</span>
<span class="o">}</span>
	<span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">NotImportantException</span> <span class="o">{</span>
<span class="k">throw</span> <span class="k">new</span> <span class="nf">HoHumException</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
	<span class="k">try</span> <span class="o">{</span>
		<span class="n">LostMessage</span> <span class="n">lm</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LostMessage</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">lm</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>	<span class="c1">//抛出一个重要异常</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">lm</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>	<span class="c1">//抛出一个不重要的异常，覆盖第一个重要异常</span>
		<span class="o">}</span>
	<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>平时使用双层try{}不会出什么状况。但像上面代码一样，当第二层的try{}finally{}里同时抛出异常的时候，问题就来了。</p>

<p>先说一下双层try{}结构里执行的顺序，</p>
<ul>
  <li>先执行lm.f()</li>
  <li>当lm.f()抛出重要异常，程序中断</li>
  <li>异常被外部catch捕获之前，会先执行内层finally里的lm.dispose()。</li>
  <li>当lm.dispose()也抛出一个不重要异常的时候，第二个不重要异常会覆盖前一个重要异常。</li>
</ul>

<p>如果内层finally里的lm.dispose()被替换成一个return，就变成了一个 <strong>“Exception Scilence”</strong> 问题。第二个return会覆盖前面的异常。因为原则上，抛出的异常就是一个return操作。而且这时候外部catch什么信息也捕获不到。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">VeryImportantException</span> <span class="o">{</span>
	<span class="k">throw</span> <span class="k">new</span> <span class="nf">VeryImportantException</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
	<span class="k">try</span> <span class="o">{</span>
		<span class="n">LostMessage</span> <span class="n">lm</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LostMessage</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">lm</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>	<span class="c1">//抛出一个重要异常</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="k">return</span><span class="o">;</span>	<span class="c1">//return会覆盖前一个异常。这就是Exception Scilence问题</span>
		<span class="o">}</span>
	<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="关于异常处理的一些最佳实践">关于异常处理的一些最佳实践</h3>

<h4 id="优先考虑用java库自带的exception">优先考虑用Java库自带的exception</h4>
<p>我们可以自定义很多特殊的异常类型。但调用代码的程序员，很可能并没有你包含这些异常的库，可能会带来麻烦。使用Java自带的异常，就不会有这样的麻烦。</p>

<h4 id="不知道怎么处理异常怎么办">不知道怎么处理异常怎么办？</h4>
<p>有的时候我们不是很情愿去处理一些异常，尤其是调用某些库函数的时候。如果我们真的不知道怎么处理某个异常怎么办呢？</p>

<h5 id="让main甩锅给console">让main甩锅给console</h5>
<p>这招可以说是甩锅大法的极致了。甩到最后，如果在main里都不处理的话，好吧，恭喜你，再也不用处理了，异常已经成功被甩入console异次元空间了。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{}</span>
</code></pre>
</div>

<h5 id="把事情闹大成runtimeexception">把事情闹大成RuntimeException</h5>
<p>存在这一条的理由是：与其 <strong>“吞掉”</strong> 一个异常，就这样忽略掉它，索性彻底暴露它，然后让别人来处理它可能是更好的选择。明枪易躲，暗箭难防，就是这个道理。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">t</span> <span class="n">r</span> <span class="n">y</span> <span class="o">{</span>
	<span class="c1">// ... to do something useful</span>
<span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IDontKnowWhatToDoWithThisCheckedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="catch-any-exception">catch any exception</h4>
<p>有的时候是不是已经被各式各样，花样繁多的异常搞晕了？那么闭上眼睛就捕获基类 <strong>“Exception”</strong> 或许是个不错的选择。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caught an exception"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>
<p>因为Exception基本是所有常见异常类的基类。甚至包括程序员自定义的异常。而且另一个好处是，Exception基类继承自Java所有错误和异常的始祖Throwable类。比如，</p>
<ul>
  <li><strong>String getMessage( )</strong>，<strong>String getLocalizedMessage( )</strong></li>
  <li><strong>String toString( )</strong></li>
  <li><strong>void printStackTrace( )</strong>，<strong>voidprintStackTrace(PrintStream)</strong>，<strong>voidprintStackTrace(java.io.PrintWriter)</strong></li>
  <li><strong>Throwable fillInStackTrace( )</strong></li>
</ul>

<p>####除非知道怎么处理，否则不要捕获一个异常
说这条，是源于一条重要的事实：使用异常处理的一个重要原因是我们想把业务逻辑代码和异常处理代码分开。这么做不至于让我们的代码看起来乱糟糟。所以我们总是在逻辑代码区块中抛出异常，然后只在我们想集中处理异常的时候再处理异常。</p>

<p>所以这一条也可以被说成是：在合适的地方处理异常。</p>

<h3 id="再来说说到底为什么要异常处理">再来说说到底为什么要异常处理？</h3>
<p>说了这么多，是时候坐下来想想到底为什么要这样处理异常了。
按常规的说法，动机无非有四：</p>
<ul>
  <li><strong>动机一</strong>：Exception的report的意义大于recovery。</li>
  <li><strong>动机二</strong>：正确处理异常。不是一味卡住或放过。</li>
  <li><strong>动机三</strong>：把逻辑代码和异常处理代码分开。</li>
  <li><strong>动机四</strong>：集中处理，归纳出异常种类，复用异常处理代码。</li>
</ul>

<h4 id="到底异常处理是不是必须的">到底异常处理是不是必须的？</h4>
<p>上面说了这么多异常处理的好处。但仔细想一想，Java的异常处理，在编程语言里来讲，算是比较复杂的。虽然其他语言也做异常处理，几乎没有像Java这样对异常进行这么严格的语法检查的。</p>

<p>作者从个人经验的角度出发，总结下来，<strong>当项目的规模变大之后，checked exception就变得微妙起来。</strong></p>

<p>原话是这样的耐人寻味：</p>
<blockquote>
  <p>“Examination of small programs leads to the conclusion that requiring exception specifications could both enhance developer productivity and enhance code quality, but experience with large software projects suggests a different result—decreased productivity and little or no increase in code quality.”</p>
</blockquote>

<blockquote>
  <p>“…on the whole I think that exceptions are good, but Java checked exceptions are more trouble than they are worth.”</p>
</blockquote>

<h3 id="最后的忠告不要太纠结于异常处理把注意力集中到更重要的事情上">最后的忠告：不要太纠结于异常处理，把注意力集中到更重要的事情上</h3>
<p>这句是我整个章节最听的进去的一句话了。</p>

<h3 id="附录常见异常表">附录：常见异常表</h3>
<ul>
  <li>算术异常类：ArithmeticExecption</li>
  <li>空指针异常类：NullPointerException</li>
  <li>类型强制转换异常：ClassCastException</li>
  <li>数组负下标异常：NegativeArrayException</li>
  <li>数组下标越界异常：ArrayIndexOutOfBoundsException</li>
  <li>违背安全原则异常：SecturityException</li>
  <li>文件已结束异常：EOFException</li>
  <li>文件未找到异常：FileNotFoundException</li>
  <li>字符串转换为数字异常：NumberFormatException</li>
  <li>操作数据库异常：SQLException</li>
  <li>输入输出异常：IOException</li>
  <li>方法未找到异常：NoSuchMethodException</li>
  <li>java.lang.AbstractMethodError: 抽象方法错误。当应用试图调用抽象方法时抛出。</li>
  <li>java.lang.AssertionError: 断言错。用来指示一个断言失败的情况。</li>
  <li>java.lang.ClassCircularityError: 类循环依赖错误。在初始化一个类时，若检测到类之间循环依赖则抛出该异常。</li>
  <li>java.lang.ClassFormatError: 类格式错误。当Java虚拟机试图从一个文件中读取Java类，而检测到该文件的内容不符合类的有效格式时抛出。</li>
  <li>java.lang.Error: 错误。是所有错误的基类，用于标识严重的程序运行问题。这些问题通常描述一些不应被应用程序捕获的反常情况。</li>
  <li>java.lang.ExceptionInInitializerError: 初始化程序错误。当执行一个类的静态初始化程序的过程中，发生了异常时抛出。静态初始化程序是指直接包含于类中的static语句段。</li>
  <li>java.lang.IllegalAccessError: 违法访问错误。当一个应用试图访问、修改某个类的域（Field）或者调用其方法，但是又违反域或方法的可见性声明，则抛出该异常。</li>
  <li>java.lang.IncompatibleClassChangeError: 不兼容的类变化错误。当正在执行的方法所依赖的类定义发生了不兼容的改变时，抛出该异常。一般在修改了应用中的某些类的声明定义而没有对整个应用重新编译而直接运行的情况下，容易引发该错误。</li>
  <li>java.lang.InstantiationError: 实例化错误。当一个应用试图通过Java的new操作符构造一个抽象类或者接口时抛出该异常.</li>
  <li>java.lang.InternalError: 内部错误。用于指示Java虚拟机发生了内部错误。</li>
  <li>java.lang.LinkageError: 链接错误。该错误及其所有子类指示某个类依赖于另外一些类，在该类编译之后，被依赖的类改变了其类定义而没有重新编译所有的类，进而引发错误的情况。</li>
  <li>java.lang.NoClassDefFoundError: 未找到类定义错误。当Java虚拟机或者类装载器试图实例化某个类，而找不到该类的定义时抛出该错误。</li>
  <li>java.lang.NoSuchFieldError: 域不存在错误。当应用试图访问或者修改某类的某个域，而该类的定义中没有该域的定义时抛出该错误。</li>
  <li>java.lang.NoSuchMethodError: 方法不存在错误。当应用试图调用某类的某个方法，而该类的定义中没有该方法的定义时抛出该错误。</li>
  <li>java.lang.OutOfMemoryError: 内存不足错误。当可用内存不足以让Java虚拟机分配给一个对象时抛出该错误。</li>
  <li>java.lang.StackOverflowError: 堆栈溢出错误。当一个应用递归调用的层次太深而导致堆栈溢出时抛出该错误。</li>
  <li>java.lang.ThreadDeath: 线程结束。当调用Thread类的stop方法时抛出该错误，用于指示线程结束。</li>
  <li>java.lang.UnknownError: 未知错误。用于指示Java虚拟机发生了未知严重错误的情况。</li>
  <li>java.lang.UnsatisfiedLinkError: 未满足的链接错误。当Java虚拟机未找到某个类的声明为native方法的本机语言定义时抛出。</li>
  <li>java.lang.UnsupportedClassVersionError: 不支持的类版本错误。当Java虚拟机试图从读取某个类文件，但是发现该文件的主、次版本号不被当前Java虚拟机支持的时候，抛出该错误。</li>
  <li>java.lang.VerifyError: 验证错误。当验证器检测到某个类文件中存在内部不兼容或者安全问题时抛出该错误。</li>
  <li>java.lang.VirtualMachineError: 虚拟机错误。用于指示虚拟机被破坏或者继续执行操作所需的资源不足的情况。</li>
  <li>java.lang.ArithmeticException: 算术条件异常。譬如：整数除零等。</li>
  <li>java.lang.ArrayIndexOutOfBoundsException: 数组索引越界异常。当对数组的索引值为负数或大于等于数组大小时抛出。</li>
  <li>java.lang.ArrayStoreException: 数组存储异常。当向数组中存放非数组声明类型对象时抛出。</li>
  <li>java.lang.ClassCastException: 类造型异常。假设有类A和B（A不是B的父类或子类），O是A的实例，那么当强制将O构造为类B的实例时抛出该异常。该异常经常被称为强制类型转换异常。</li>
  <li>java.lang.ClassNotFoundException: 找不到类异常。当应用试图根据字符串形式的类名构造类，而在遍历CLASSPAH之后找不到对应名称的class文件时，抛出该异常。</li>
  <li>java.lang.CloneNotSupportedException: 不支持克隆异常。当没有实现Cloneable接口或者不支持克隆方法时,调用其clone()方法则抛出该异常。</li>
  <li>java.lang.EnumConstantNotPresentException: 枚举常量不存在异常。当应用试图通过名称和枚举类型访问一个枚举对象，但该枚举对象并不包含常量时，抛出该异常。</li>
  <li>java.lang.Exception: 根异常。用以描述应用程序希望捕获的情况。</li>
  <li>java.lang.IllegalAccessException: 违法的访问异常。当应用试图通过反射方式创建某个类的实例、访问该类属性、调用该类方法，而当时又无法访问类的、属性的、方法的或构造方法的定义时抛出该异常。</li>
  <li>java.lang.IllegalMonitorStateException: 违法的监控状态异常。当某个线程试图等待一个自己并不拥有的对象（O）的监控器或者通知其他线程等待该对象（O）的监控器时，抛出该异常。</li>
  <li>java.lang.IllegalStateException: 违法的状态异常。当在Java环境和应用尚未处于某个方法的合法调用状态，而调用了该方法时，抛出该异常。</li>
  <li>java.lang.IllegalThreadStateException: 违法的线程状态异常。当县城尚未处于某个方法的合法调用状态，而调用了该方法时，抛出异常。</li>
  <li>java.lang.IndexOutOfBoundsException: 索引越界异常。当访问某个序列的索引值小于0或大于等于序列大小时，抛出该异常。</li>
  <li>java.lang.InstantiationException: 实例化异常。当试图通过newInstance()方法创建某个类的实例，而该类是一个抽象类或接口时，抛出该异常。</li>
  <li>java.lang.InterruptedException: 被中止异常。当某个线程处于长时间的等待、休眠或其他暂停状态，而此时其他的线程通过Thread的interrupt方法终止该线程时抛出该异常。</li>
  <li>java.lang.NegativeArraySizeException: 数组大小为负值异常。当使用负数大小值创建数组时抛出该异常。</li>
  <li>java.lang.NoSuchFieldException: 属性不存在异常。当访问某个类的不存在的属性时抛出该异常。</li>
  <li>java.lang.NoSuchMethodException: 方法不存在异常。当访问某个类的不存在的方法时抛出该异常。</li>
  <li>java.lang.NullPointerException: 空指针异常。当应用试图在要求使用对象的地方使用了null时，抛出该异常。譬如：调用null对象的实例方法、访问null对象的属性、计算null对象的长度、使用throw语句抛出null等等。</li>
  <li>java.lang.NumberFormatException: 数字格式异常。当试图将一个String转换为指定的数字类型，而该字符串确不满足数字类型要求的格式时，抛出该异常。</li>
  <li>java.lang.RuntimeException: 运行时异常。是所有Java虚拟机正常操作期间可以被抛出的异常的父类。</li>
  <li>java.lang.SecurityException: 安全异常。由安全管理器抛出，用于指示违反安全情况的异常。</li>
  <li>java.lang.StringIndexOutOfBoundsException: 字符串索引越界异常。当使用索引值访问某个字符串中的字符，而该索引值小于0或大于等于序列大小时，抛出该异常。</li>
  <li>java.lang.TypeNotPresentException: 类型不存在异常。当应用试图以某个类型名称的字符串表达方式访问该类型，但是根据给定的名称又找不到该类型是抛出该异常。该异常与ClassNotFoundException的区别在于该异常是unchecked（不被检查）异常，而ClassNotFoundException是checked（被检查）异常。</li>
  <li>java.lang.UnsupportedOperationException: 不支持的方法异常。指明请求的方法不被支持情况的异常。</li>
</ul>

<h3 id="练习">练习</h3>

<h4 id="exercise-1">Exercise 1</h4>
<ul>
  <li><strong>Exercise 1</strong>: (2) Create a class with a main( ) that throws an object of class Exception inside a try block. Give the constructor for Exception a String argument. Catch the exception inside a catch clause and print the String argument. Add a finally clause and print a message to prove you were there.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise1</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">"This is Exercise 1 of chapter 12!"</span><span class="o">;</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"In finally block of chapter 12 - exercise 1"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-2">Exercise 2</h4>
<ul>
  <li><strong>Exercise 2</strong>: (1) Define an object reference and initialize it to null. Try to call a method through this reference. Now wrap the code in a try-catch clause to catch the exception.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise2</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"This is Exercise 2 of chapter 12"</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Exercise2</span> <span class="n">myExercise</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="n">myExercise</span><span class="o">.</span><span class="na">foo</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-3">Exercise 3</h4>
<ul>
  <li><strong>Exercise 3</strong>: (1) Write code to generate and catch an ArraylndexOutOfBoundsException.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise3</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">arrayLength</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
            <span class="kt">int</span><span class="o">[]</span> <span class="n">arrayToOverflow</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">arrayLength</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">loopTimes</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">loopTimes</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">arrayToOverflow</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-4">Exercise 4</h4>
<ul>
  <li><strong>Exercise 4</strong>: (2) Create your own exception class using the extends keyword. Write a constructor for this class that takes a String argument and stores it inside the object with a String reference. Write a method that displays the stored String. Create a try-catch clause to exercise your new exception.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise4</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise4Exception</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="n">l</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"NULL"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise4Exception</span><span class="o">(){</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise4Exception</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">justAMessage</span> <span class="o">=</span> <span class="s">"I am the message of Exercise4Exception!"</span><span class="o">;</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">Exercise4</span><span class="o">.</span><span class="na">Exercise4Exception</span><span class="o">(</span><span class="n">justAMessage</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exercise4</span><span class="o">.</span><span class="na">Exercise4Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">showMessage</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-5">Exercise 5</h4>
<ul>
  <li><strong>Exercise 5</strong>: (3) Create your own resumption-like behavior using a while loop that repeats until an exception is no longer thrown.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise5</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">offset</span><span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>  <span class="c1">//try to read the last element in the array</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="kt">int</span><span class="o">[]</span> <span class="n">arrayToOverflow</span> <span class="o">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">};</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"The last element ("</span> <span class="o">+</span> <span class="s">"index="</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">+</span> <span class="s">") in the array is: "</span> <span class="o">+</span> <span class="n">arrayToOverflow</span><span class="o">[</span><span class="n">offset</span><span class="o">]);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">offset</span> <span class="o">+</span> <span class="s">" is too big!"</span><span class="o">);</span>
                <span class="n">offset</span><span class="o">--;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-6">Exercise 6</h4>
<ul>
  <li><strong>Exercise 6</strong>: (1) Create two exception classes, each of which performs its own logging automatically. Demonstrate that these work.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.logging.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise6</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise6Exception</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"Exercise6Exception"</span><span class="o">);</span>
        <span class="kd">public</span> <span class="nf">Exercise6Exception</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
            <span class="n">StringWriter</span> <span class="n">traceStr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringWriter</span><span class="o">();</span>
            <span class="n">printStackTrace</span><span class="o">(</span><span class="k">new</span> <span class="n">PrintWriter</span><span class="o">(</span><span class="n">traceStr</span><span class="o">));</span>
            <span class="k">this</span><span class="o">.</span><span class="na">log</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="n">traceStr</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">Exercise6</span><span class="o">.</span><span class="na">Exercise6Exception</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exercise6</span><span class="o">.</span><span class="na">Exercise6Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-7">Exercise 7</h4>
<ul>
  <li><strong>Exercise 7</strong>: (1) Modify Exercise 3 so that the catch clause logs the results.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.logging.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise7</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">arrayLength</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
            <span class="kt">int</span><span class="o">[]</span> <span class="n">arrayToOverflow</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">arrayLength</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">loopTimes</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">loopTimes</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">arrayToOverflow</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"ArrayIndexOutOfBoundsException"</span><span class="o">);</span>
            <span class="n">StringWriter</span> <span class="n">trace</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringWriter</span><span class="o">();</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="k">new</span> <span class="n">PrintWriter</span><span class="o">(</span><span class="n">trace</span><span class="o">));</span>
            <span class="n">log</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="n">trace</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-8">Exercise 8</h4>
<ul>
  <li><strong>Exercise 8</strong>: (1) Write a class with a method that throws an exception of the type created in Exercise 4. Try compiling it without an exception specification to see what the compiler says. Add the appropriate exception specification. Try out your class and its exception inside a try-catch clause.</li>
</ul>

<p>不添加异常说明，通不过编译。</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code>error: unreported exception Exercise4Exception; must be caught or declared to be thrown
</code></pre>
</div>

<p>必须在方法上加上异常说明，然后在try-catch块里调用。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise8</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">callExercise4</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exercise4</span><span class="o">.</span><span class="na">Exercise4Exception</span><span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">Exercise4</span><span class="o">.</span><span class="na">Exercise4Exception</span><span class="o">(</span><span class="s">"I call Exercise4Exception in Exercise 8!"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Exercise8</span><span class="o">.</span><span class="na">callExercise4</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exercise4</span><span class="o">.</span><span class="na">Exercise4Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">showMessage</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-9">Exercise 9</h4>
<ul>
  <li><strong>Exercise 9</strong>: (2) Create three new types of exceptions. Write a class with a method that throws all three. In main( ), call the method but only use a single catch clause that will catch all three types of exceptions.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise9</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise9Exception1</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"I am Exception 1 of Exercise 9!"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise9Exception1</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise9Exception1</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise9Exception2</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"I am Exception 2 of Exercise 9!"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise9Exception2</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise9Exception2</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise9Exception3</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"I am Exception 3 of Exercise 9!"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise9Exception3</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise9Exception3</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">throwThreeException</span><span class="o">(</span><span class="kt">int</span> <span class="n">inNum</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">inNum</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Exercise9</span><span class="o">.</span><span class="na">Exercise9Exception1</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Exercise9</span><span class="o">.</span><span class="na">Exercise9Exception2</span><span class="o">();</span>
            <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Exercise9</span><span class="o">.</span><span class="na">Exercise9Exception3</span><span class="o">();</span>
            <span class="k">default</span><span class="o">:</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Congratulation! You win!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">throwThreeException</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                <span class="n">i</span><span class="o">++;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-10">Exercise 10</h4>
<ul>
  <li><strong>Exercise 10</strong>: (2) Create a class with two methods, f( ) and g( ). In g( ), throw an exception of a new type that you define. In f( ), call g( ), catch its exception and, in the catch clause, throw a different exception (of a second type that you define). Test your code in main( ).</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise10</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ExceptionInG</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">ExceptionInG</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello I am ExceptionInG!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ExceptionInF</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">ExceptionInF</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello I am ExceptionInF!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">ExceptionInF</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">g</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ExceptionInG</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">ExceptionInF</span> <span class="n">exF</span><span class="o">=</span> <span class="k">new</span> <span class="n">ExceptionInF</span><span class="o">();</span>
            <span class="n">exF</span><span class="o">.</span><span class="na">initCause</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="k">throw</span> <span class="n">exF</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">g</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">ExceptionInG</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ExceptionInG</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">f</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-11">Exercise 11</h4>
<ul>
  <li><strong>Exercise 11</strong>: (1) Repeat the previous exercise, but inside the catch clause, wrap g( )’s exception in a RuntimeException.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise11</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ExceptionInG</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">ExceptionInG</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello I am ExceptionInG!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RuntimeException</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">g</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ExceptionInG</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">g</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">ExceptionInG</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ExceptionInG</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">f</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
            <span class="n">e</span><span class="o">.</span><span class="na">getCause</span><span class="o">().</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-12">Exercise 12</h4>
<ul>
  <li><strong>Exercise 12</strong>: (3) Modify innerclasses/Sequence.java so that it throws an appropriate exception if you try to put in too many elements.</li>
</ul>

<h5 id="selectorjava">Selector.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Selector</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">end</span><span class="o">();</span>
    <span class="n">Object</span> <span class="nf">current</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise12java">Exercise12.java</h5>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise12</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Sequence</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">items</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Sequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">size</span><span class="o">];</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Object</span> <span class="n">x</span><span class="o">)</span> <span class="kd">throws</span>  <span class="n">SequenceOutOfBoundsException</span><span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">next</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">items</span><span class="o">[</span><span class="n">next</span><span class="o">++]</span> <span class="o">=</span> <span class="n">x</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">SequenceOutOfBoundsException</span><span class="o">(</span><span class="s">"Sequence#add() method add too much elements!"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SequenceOutOfBoundsException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="nf">SequenceOutOfBoundsException</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="nf">SequenceOutOfBoundsException</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SequenceEmptyException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="nf">SequenceEmptyException</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="kd">public</span> <span class="nf">SequenceEmptyException</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">super</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SequenceSelector</span> <span class="kd">implements</span> <span class="n">Selector</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">i</span> <span class="o">==</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="n">Object</span> <span class="nf">current</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">items</span><span class="o">[</span><span class="n">i</span><span class="o">];</span> <span class="o">}</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">i</span><span class="o">++;</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="k">new</span> <span class="n">SequenceEmptyException</span><span class="o">(</span><span class="k">this</span> <span class="o">+</span> <span class="s">" #next() reach the end of sequence!"</span><span class="o">));</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Selector</span> <span class="nf">selector</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">SequenceSelector</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">sequenceLength</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">loopTimes</span> <span class="o">=</span> <span class="n">sequenceLength</span> <span class="o">*</span> <span class="mi">2</span><span class="o">;</span>
        <span class="kt">boolean</span> <span class="n">loopFinish</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="kt">boolean</span> <span class="n">sequenceIsFull</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="kt">boolean</span> <span class="n">sequenceIsEmpty</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="n">Exercise12</span><span class="o">.</span><span class="na">Sequence</span> <span class="n">sequence</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise12</span><span class="o">.</span><span class="na">Sequence</span><span class="o">(</span><span class="n">sequenceLength</span><span class="o">);</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">loopFinish</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(!</span> <span class="n">sequenceIsFull</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">loopTimes</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="n">sequence</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">if</span> <span class="o">(!</span> <span class="n">sequenceIsEmpty</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">sequence</span><span class="o">.</span><span class="na">selector</span><span class="o">();</span>
                    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span> <span class="n">loopTimes</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">current</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
                        <span class="n">selector</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Congratulation! Procedure finished!"</span><span class="o">);</span>
                <span class="n">loopFinish</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exercise12</span><span class="o">.</span><span class="na">Sequence</span><span class="o">.</span><span class="na">SequenceOutOfBoundsException</span> <span class="n">fullException</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fullException</span><span class="o">);</span>
                <span class="n">sequenceIsFull</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">RuntimeException</span> <span class="n">emptyException</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">emptyException</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
                <span class="n">sequenceIsEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-13">Exercise 13</h4>
<ul>
  <li><strong>Exercise 13</strong>: (2) Modify Exercise 9 by adding a finally clause. Verify that your finally clause is executed, even if a NullPointerException is thrown.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise13</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise13Exception1</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"I am Exception 1 of Exercise 13!"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise13Exception1</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise13Exception1</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise13Exception2</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"I am Exception 2 of Exercise 13!"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise13Exception2</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise13Exception2</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise13Exception3</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"I am Exception 3 of Exercise 13!"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise13Exception3</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise13Exception3</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exception</span><span class="o">[]</span> <span class="n">exceptionArray</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exception</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
        <span class="n">exceptionArray</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise13</span><span class="o">.</span><span class="na">Exercise13Exception1</span><span class="o">();</span>
        <span class="n">exceptionArray</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise13</span><span class="o">.</span><span class="na">Exercise13Exception2</span><span class="o">();</span>
        <span class="n">exceptionArray</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise13</span><span class="o">.</span><span class="na">Exercise13Exception3</span><span class="o">();</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="n">exceptionArray</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"This will be executed!"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-14">Exercise 14</h4>
<ul>
  <li><strong>Exercise 14</strong>: (2) Show that OnOffSwitch.java can fail by throwing a RuntimeException inside the try block.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise14</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">OnOffSwitch</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">Switch</span> <span class="n">sw</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Switch</span><span class="o">();</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">OnOffException1</span><span class="o">,</span><span class="n">OnOffException2</span> <span class="o">{</span><span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">();}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Exercise14</span><span class="o">.</span><span class="na">OnOffSwitch</span><span class="o">.</span><span class="na">sw</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
                <span class="c1">// Code that can throw exceptions...</span>
                <span class="n">Exercise14</span><span class="o">.</span><span class="na">OnOffSwitch</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
                <span class="n">Exercise14</span><span class="o">.</span><span class="na">OnOffSwitch</span><span class="o">.</span><span class="na">sw</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">OnOffException1</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"OnOffException1"</span><span class="o">);</span>
                <span class="n">Exercise14</span><span class="o">.</span><span class="na">OnOffSwitch</span><span class="o">.</span><span class="na">sw</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">OnOffException2</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"OnOffException2"</span><span class="o">);</span>
                <span class="n">Exercise14</span><span class="o">.</span><span class="na">OnOffSwitch</span><span class="o">.</span><span class="na">sw</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
            <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-15">Exercise 15</h4>
<ul>
  <li><strong>Exercise 15</strong>: (2) Show that WithFinally.java doesn’t fail by throwing a RuntimeException inside the try block.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise15</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">WithFinally</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="n">Switch</span> <span class="n">sw</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Switch</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Exercise15</span><span class="o">.</span><span class="na">WithFinally</span><span class="o">.</span><span class="na">sw</span><span class="o">.</span><span class="na">on</span><span class="o">();</span>
            <span class="c1">// Code that can throw exceptions...</span>
            <span class="n">Exercise14</span><span class="o">.</span><span class="na">OnOffSwitch</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">OnOffException1</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"OnOffException1"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">OnOffException2</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"OnOffException2"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">Exercise15</span><span class="o">.</span><span class="na">WithFinally</span><span class="o">.</span><span class="na">sw</span><span class="o">.</span><span class="na">off</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-16">Exercise 16</h4>
<ul>
  <li><strong>Exercise 16</strong>: (2) Modify reusing/CADSystem.java to demonstrate that returning from the middle of a try-finally will still perform proper cleanup.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise16</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Shape</span> <span class="o">{</span>
        <span class="n">Shape</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Shape constructor"</span><span class="o">);</span> <span class="o">}</span>
        <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Shape dispose"</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="n">Circle</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Drawing Circle"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Erasing Circle"</span><span class="o">);</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Triangle</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="n">Triangle</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Drawing Triangle"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Erasing Triangle"</span><span class="o">);</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Line</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">;</span>
        <span class="n">Line</span><span class="o">(</span><span class="kt">int</span> <span class="n">start</span><span class="o">,</span> <span class="kt">int</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">start</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Drawing Line: "</span> <span class="o">+</span> <span class="n">start</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">end</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Erasing Line: "</span> <span class="o">+</span> <span class="n">start</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">end</span><span class="o">);</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CADSystem</span> <span class="kd">extends</span> <span class="n">Shape</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Circle</span> <span class="n">c</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">Triangle</span> <span class="n">t</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">Line</span><span class="o">[]</span> <span class="n">lines</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Line</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span>
        <span class="kd">public</span> <span class="nf">CADSystem</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">lines</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">lines</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Line</span><span class="o">(</span><span class="n">j</span><span class="o">,</span> <span class="n">j</span><span class="o">*</span><span class="n">j</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Circle</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Triangle</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Combined constructor"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"CADSystem.dispose()"</span><span class="o">);</span>
            <span class="c1">// The order of cleanup is the reverse</span>
            <span class="c1">// of the order of initialization:</span>
            <span class="n">t</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="n">c</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">--)</span> <span class="o">{</span>
                <span class="n">lines</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">dispose</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise16</span><span class="o">.</span><span class="na">CADSystem</span> <span class="n">x</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise16</span><span class="o">.</span><span class="na">CADSystem</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// Code and exception handling...</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">x</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-17">Exercise 17</h4>
<ul>
  <li><strong>Exercise 17</strong>: (3) Modify polymorphism/Frog.java so that it uses try-finally to guarantee proper cleanup, and show that this works even if you return from the middle of the try-finally.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise17</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Characteristic</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">Characteristic</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Creating Characteristic "</span> <span class="o">+</span> <span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"disposing Characteristic "</span> <span class="o">+</span> <span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Description</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">s</span><span class="o">;</span>
        <span class="n">Description</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Creating Description "</span> <span class="o">+</span> <span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"disposing Description "</span> <span class="o">+</span> <span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">LivingCreature</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Characteristic</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Characteristic</span><span class="o">(</span><span class="s">"is alive"</span><span class="o">);</span>
        <span class="kd">private</span> <span class="n">Description</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Description</span><span class="o">(</span><span class="s">"Basic Living Creature"</span><span class="o">);</span>
        <span class="n">LivingCreature</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"LivingCreature()"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"LivingCreature dispose"</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="n">p</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Animal</span> <span class="kd">extends</span> <span class="n">LivingCreature</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Characteristic</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Characteristic</span><span class="o">(</span><span class="s">"has heart"</span><span class="o">);</span>
        <span class="kd">private</span> <span class="n">Description</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Description</span><span class="o">(</span><span class="s">"Animal not Vegetable"</span><span class="o">);</span>
        <span class="n">Animal</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Animal()"</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Animal dispose"</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="n">p</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Amphibian</span> <span class="kd">extends</span> <span class="n">Animal</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Characteristic</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Characteristic</span><span class="o">(</span><span class="s">"can live in water"</span><span class="o">);</span>
        <span class="kd">private</span> <span class="n">Description</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Description</span><span class="o">(</span><span class="s">"Both water and land"</span><span class="o">);</span>
        <span class="n">Amphibian</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Amphibian()"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Amphibian dispose"</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="n">p</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Frog</span> <span class="kd">extends</span> <span class="n">Amphibian</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Characteristic</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Characteristic</span><span class="o">(</span><span class="s">"Croaks"</span><span class="o">);</span>
        <span class="kd">private</span> <span class="n">Description</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Description</span><span class="o">(</span><span class="s">"Eats Bugs"</span><span class="o">);</span>
        <span class="kd">public</span> <span class="nf">Frog</span><span class="o">()</span> <span class="o">{</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Frog()"</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Frog dispose"</span><span class="o">);</span>
            <span class="n">t</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="n">p</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise17</span><span class="o">.</span><span class="na">Frog</span> <span class="n">frog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise17</span><span class="o">.</span><span class="na">Frog</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Bye!"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">frog</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-18">Exercise 18</h4>
<ul>
  <li><strong>Exercise 18</strong>: (3) Add a second level of exception loss to LostMessage.java so that the HoHumException is itself replaced by a third exception.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise18</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">VeryImportantException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">HoHumException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ThirdException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">VeryImportantException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">VeryImportantException</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">HoHumException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">HoHumException</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">third</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">ThirdException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ThirdException</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Exercise18</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">Exercise18</span><span class="o">.</span><span class="na">third</span><span class="o">();</span>
                <span class="n">Exercise18</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-19">Exercise 19</h4>
<ul>
  <li><strong>Exercise 19</strong>: (2) Repair the problem in LostMessage.java by guarding the call in the finally clause.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise19</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">VeryImportantException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">HoHumException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">VeryImportantException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">VeryImportantException</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">HoHumException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">HoHumException</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">Exercise19</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">Exercise19</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-20">Exercise 20</h4>
<ul>
  <li><strong>Exercise 20</strong>: (3) Modify StormyInning.java by adding an UmpireArgument exception type and methods that throw this exception. Test the modified hierarchy.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise20</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">EmpireArgument</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BaseballException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Foul</span> <span class="kd">extends</span> <span class="n">BaseballException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Strike</span> <span class="kd">extends</span> <span class="n">BaseballException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Inning</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nf">Inning</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">BaseballException</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">event</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">BaseballException</span> <span class="o">{</span>
            <span class="c1">// Doesn’t actually have to throw anything</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">atBat</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Strike</span><span class="o">,</span> <span class="n">Foul</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">walk</span><span class="o">()</span> <span class="o">{}</span> <span class="c1">// Throws no checked exceptions</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StormException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">RainedOut</span> <span class="kd">extends</span> <span class="n">StormException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">PopFoul</span> <span class="kd">extends</span> <span class="n">Foul</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Storm</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">event</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rainHard</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StormyInning</span> <span class="kd">extends</span> <span class="n">Inning</span> <span class="kd">implements</span> <span class="n">Storm</span> <span class="o">{</span>
        <span class="c1">// OK to add new exceptions for constructors, but you</span>
        <span class="c1">// must deal with the base constructor exceptions:</span>
        <span class="kd">public</span> <span class="nf">StormyInning</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span><span class="o">,</span> <span class="n">BaseballException</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="nf">StormyInning</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Foul</span><span class="o">,</span> <span class="n">BaseballException</span> <span class="o">{}</span>
        <span class="c1">// Regular methods must conform to base class:</span>
        <span class="c1">//! void walk() throws PopFoul {} //Compile error</span>
        <span class="c1">// Interface CANNOT add exceptions to existing</span>
        <span class="c1">// methods from the base class:</span>
        <span class="c1">//! public void event() throws RainedOut {}</span>
        <span class="c1">// If the method doesn’t already exist in the</span>
        <span class="c1">// base class, the exception is OK:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rainHard</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span> <span class="o">{}</span>
        <span class="c1">// You can choose to not throw any exceptions,</span>
        <span class="c1">// even if the base version does:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">event</span><span class="o">()</span> <span class="o">{}</span>
        <span class="c1">// Overridden methods can throw inherited exceptions:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">atBat</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">PopFoul</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">throwEmpireArgument</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">EmpireArgument</span> <span class="o">{}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">StormyInning</span> <span class="n">si</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StormyInning</span><span class="o">();</span>
            <span class="n">si</span><span class="o">.</span><span class="na">atBat</span><span class="o">();</span>
            <span class="n">si</span><span class="o">.</span><span class="na">throwEmpireArgument</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">PopFoul</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Pop foul"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">RainedOut</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Rained out"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">BaseballException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Generic baseball exception"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">EmpireArgument</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Empire Argument exception"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// Strike not thrown in derived version.</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// What happens if you upcast?</span>
            <span class="n">Inning</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StormyInning</span><span class="o">();</span>
            <span class="n">i</span><span class="o">.</span><span class="na">atBat</span><span class="o">();</span>
            <span class="c1">// You must catch the exceptions from the</span>
            <span class="c1">// base-class version of the method:</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Strike</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Strike"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Foul</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Foul"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">RainedOut</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Rained out"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">BaseballException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Generic baseball exception"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-21">Exercise 21</h4>
<ul>
  <li><strong>Exercise 21</strong>: (2) Demonstrate that a derived-class constructor cannot catch exceptions thrown by its base-class constructor.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise21</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BaseException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BaseClass</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nf">BaseClass</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">BaseException</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am Constructor of BaseClass!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DerivedClass</span> <span class="kd">extends</span> <span class="n">BaseClass</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nf">DerivedClass</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="c1">//super();  //ERROR: super() must be the first statement in constructor</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">BaseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Exception in BaseClass captured!"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">DerivedClass</span> <span class="n">derived</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DerivedClass</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-22">Exercise 22</h4>
<ul>
  <li><strong>Exercise 22</strong>: (2) Create a class called FailingConstructor with a constructor that might fail partway through the construction process and throw an exception. In main( ), write code that properly guards against this failure.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise22</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FailingConstructor</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">BufferedReader</span> <span class="n">br</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">FailingConstructor</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">FileNotFoundException</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">)));</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path</span> <span class="o">+</span> <span class="s">" opened!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">FileNotFoundException</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">close</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
            <span class="n">br</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">correctPath</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter12/Exercise22.java"</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">wrongPath</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/java/Chapter12.java"</span><span class="o">;</span>
        <span class="n">FailingConstructor</span> <span class="n">fcWrong</span><span class="o">;</span>
        <span class="n">FailingConstructor</span> <span class="n">fcRight</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">fcRight</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FailingConstructor</span><span class="o">(</span><span class="n">correctPath</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Right file opened!! Working Working!!!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">fcRight</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">correctPath</span> <span class="o">+</span> <span class="s">" closed!"</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"FATAL ERROR: "</span><span class="o">);</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">fcWrong</span><span class="o">=</span> <span class="k">new</span> <span class="n">FailingConstructor</span><span class="o">(</span><span class="n">wrongPath</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Wrong file opened!! Working Working!!!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">fcWrong</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wrongPath</span><span class="o">+</span> <span class="s">" closed!"</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"FATAL ERROR: "</span><span class="o">);</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"All work finished! Go home now!"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"File "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()</span> <span class="o">+</span> <span class="s">" not found!"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-23">Exercise 23</h4>
<ul>
  <li><strong>Exercise 23</strong>: (4) Add a class with a dispose( ) method to the previous exercise. Modify FailingConstructor so that the constructor creates one of these disposable objects as a member object, after which the constructor might throw an exception, after which it creates a second disposable member object. Write code to properly guard against failure, and in main( ) verify that all possible failure situations are covered.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise23</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FailingConstructor</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">BufferedReader</span> <span class="n">br1</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">BufferedReader</span> <span class="n">br2</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">FailingConstructor</span><span class="o">(</span><span class="n">String</span> <span class="n">path1</span><span class="o">,</span> <span class="n">String</span> <span class="n">path2</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">FileNotFoundException</span> <span class="o">{</span>
            <span class="n">br1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path1</span><span class="o">)));</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path1</span> <span class="o">+</span> <span class="s">" opened!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">br1</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path1</span> <span class="o">+</span> <span class="s">" cannot be closed!"</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="n">br2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path2</span><span class="o">)));</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path2</span> <span class="o">+</span> <span class="s">" opened!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="n">br2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path1</span> <span class="o">+</span> <span class="s">" cannot be closed!"</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">correctPath</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter12/Exercise22.java"</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">wrongPath</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/java/Chapter12.java"</span><span class="o">;</span>
        <span class="n">FailingConstructor</span> <span class="n">fc</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">fc</span><span class="o">=</span> <span class="k">new</span> <span class="n">FailingConstructor</span><span class="o">(</span><span class="n">correctPath</span><span class="o">,</span><span class="n">wrongPath</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Two files opened!! Working Working!!!"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-24">Exercise 24</h4>
<ul>
  <li><strong>Exercise 24</strong>: (3) Add a dispose( ) method to the FailingConstructor class and write code to properly use this class.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise24</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FailingConstructor</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">BufferedReader</span> <span class="n">br1</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">BufferedReader</span> <span class="n">br2</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">FailingConstructor</span><span class="o">(</span><span class="n">String</span> <span class="n">path1</span><span class="o">,</span> <span class="n">String</span> <span class="n">path2</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">FileNotFoundException</span> <span class="o">{</span>
            <span class="n">br1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path1</span><span class="o">)));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path1</span> <span class="o">+</span> <span class="s">" opened!"</span><span class="o">);</span>
            <span class="n">br2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path2</span><span class="o">)));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">path2</span> <span class="o">+</span> <span class="s">" opened!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dispose</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">br1</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"File 1 closed!"</span><span class="o">);</span>
                <span class="n">br2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"File 2 closed!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">correctPath</span> <span class="o">=</span> <span class="s">"/Users/Wei/java/com/ciaoshen/thinkinjava/chapter12/Exercise22.java"</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">wrongPath</span> <span class="o">=</span> <span class="s">"/Users/HelloKitty/java/Chapter12.java"</span><span class="o">;</span>
        <span class="n">FailingConstructor</span> <span class="n">fc</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">//fc= new FailingConstructor(correctPath,wrongPath);</span>
            <span class="n">fc</span><span class="o">=</span> <span class="k">new</span> <span class="n">FailingConstructor</span><span class="o">(</span><span class="n">correctPath</span><span class="o">,</span><span class="n">correctPath</span><span class="o">);</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Two files opened!! Working Working!!!"</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">fc</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-25">Exercise 25</h4>
<ul>
  <li><strong>Exercise 25</strong>: (2) Create a three-level hierarchy of exceptions. Now create a base-class A with a method that throws an exception at the base of your hierarchy. Inherit B from A and override the method so it throws an exception at level two of your hierarchy. Repeat by inheriting class C from B. In main( ), create a C and upcast it to A, then call the method.</li>
</ul>

<p>派生类抛出的异常，必须是基类声明抛出的异常或者是它的派生异常，也可以不抛出异常。但如果派生类向上转型成了基类，在catch语句块里，必须去捕获基类里抛出的异常类型，而不能用派生异常。就像虽然有多态，派生类被强制转型成基类后，调用基类方法其实执行的是派生类覆盖的版本。但是派生类新声明的方法，还是不能被调用的。因为，毕竟还是要遵守基类的接口。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise25</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BaseException</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DerivedException</span> <span class="kd">extends</span> <span class="n">BaseException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DerivedLevelTwoException</span> <span class="kd">extends</span> <span class="n">DerivedException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">BaseException</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">BaseException</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">B</span> <span class="kd">extends</span> <span class="n">A</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DerivedException</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">DerivedException</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">C</span> <span class="kd">extends</span> <span class="n">B</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">DerivedLevelTwoException</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">DerivedLevelTwoException</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">D</span> <span class="kd">extends</span> <span class="n">C</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">foo</span><span class="o">()</span> <span class="o">{}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">C</span> <span class="n">myC</span> <span class="o">=</span> <span class="k">new</span> <span class="n">C</span><span class="o">();</span>
        <span class="n">A</span> <span class="n">myA</span> <span class="o">=</span> <span class="o">(</span><span class="n">A</span><span class="o">)</span><span class="n">myC</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">myA</span><span class="o">.</span><span class="na">foo</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">BaseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">D</span> <span class="n">myD</span> <span class="o">=</span> <span class="k">new</span> <span class="n">D</span><span class="o">();</span>
        <span class="n">myD</span><span class="o">.</span><span class="na">foo</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-26">Exercise 26</h4>
<ul>
  <li><strong>Exercise 26</strong>: (1) Change the file name string in MainException.java to name a file that doesn’t exist. Run the program and note the result.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise26</span> <span class="o">{</span>
    <span class="c1">// Pass all exceptions to the console:</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// Open the file:</span>
        <span class="n">FileInputStream</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">"/Users/HelloKitty.MainException.java"</span><span class="o">);</span>
        <span class="c1">// Use the file ...</span>
        <span class="c1">// Close the file:</span>
        <span class="n">file</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-27">Exercise 27</h4>
<ul>
  <li><strong>Exercise 27</strong>: (1) Modify Exercise 3 to convert the exception to a RuntimeException.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise27</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">arrayLength</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
            <span class="kt">int</span><span class="o">[]</span> <span class="n">arrayToOverflow</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">arrayLength</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">loopTimes</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">loopTimes</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="n">arrayToOverflow</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ArrayIndexOutOfBoundsException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>    
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-28">Exercise 28</h4>
<ul>
  <li><strong>Exercise 28</strong>: (1) Modify Exercise 4 so that the custom exception class inherits from RuntimeException, and show that the compiler allows you to leave out the try block.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise28</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Exercise28Exception</span> <span class="kd">extends</span> <span class="n">RuntimeException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="n">l</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"NULL"</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Exercise28Exception</span><span class="o">(){</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="nf">Exercise28Exception</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">msg</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">showMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">justAMessage</span> <span class="o">=</span> <span class="s">"I am the message of Exercise4Exception!"</span><span class="o">;</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exercise28Exception</span><span class="o">(</span><span class="n">justAMessage</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-29">Exercise 29</h4>
<ul>
  <li><strong>Exercise 29</strong>: (1) Modify all the exception types in Stormylnning.java so that they extend RuntimeException, and show that no exception specifications or try blocks are necessary. Remove the ‘//!’ comments and show how the methods can be compiled without specifications.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise29</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">BaseballException</span> <span class="kd">extends</span> <span class="n">RuntimeException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Foul</span> <span class="kd">extends</span> <span class="n">BaseballException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Strike</span> <span class="kd">extends</span> <span class="n">BaseballException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Inning</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nf">Inning</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">BaseballException</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">event</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">BaseballException</span> <span class="o">{</span>
            <span class="c1">// Doesn’t actually have to throw anything</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">atBat</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Strike</span><span class="o">,</span> <span class="n">Foul</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">walk</span><span class="o">()</span> <span class="o">{}</span> <span class="c1">// Throws no checked exceptions</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StormException</span> <span class="kd">extends</span> <span class="n">RuntimeException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">RainedOut</span> <span class="kd">extends</span> <span class="n">StormException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">PopFoul</span> <span class="kd">extends</span> <span class="n">Foul</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">interface</span> <span class="nc">Storm</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">event</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rainHard</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">StormyInning</span> <span class="kd">extends</span> <span class="n">Inning</span> <span class="kd">implements</span> <span class="n">Storm</span> <span class="o">{</span>
        <span class="c1">// OK to add new exceptions for constructors, but you</span>
        <span class="c1">// must deal with the base constructor exceptions:</span>
        <span class="kd">public</span> <span class="nf">StormyInning</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span><span class="o">,</span> <span class="n">BaseballException</span> <span class="o">{}</span>
        <span class="kd">public</span> <span class="nf">StormyInning</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Foul</span><span class="o">,</span> <span class="n">BaseballException</span> <span class="o">{}</span>
        <span class="c1">// Regular methods must conform to base class:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">walk</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">PopFoul</span> <span class="o">{}</span> <span class="c1">// No Compile error now</span>
        <span class="c1">// Interface CANNOT add exceptions to existing</span>
        <span class="c1">// methods from the base class:</span>
        <span class="c1">// If the method doesn’t already exist in the</span>
        <span class="c1">// base class, the exception is OK:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rainHard</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">RainedOut</span> <span class="o">{}</span>
        <span class="c1">// You can choose to not throw any exceptions,</span>
        <span class="c1">// even if the base version does:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">event</span><span class="o">()</span> <span class="o">{}</span>
        <span class="c1">// Overridden methods can throw inherited exceptions:</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">atBat</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">PopFoul</span> <span class="o">{}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StormyInning</span> <span class="n">si</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StormyInning</span><span class="o">();</span>
        <span class="n">si</span><span class="o">.</span><span class="na">atBat</span><span class="o">();</span>
        <span class="c1">// Strike not thrown in derived version.</span>
        <span class="c1">// What happens if you upcast?</span>
        <span class="n">Inning</span> <span class="n">i</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StormyInning</span><span class="o">();</span>
        <span class="n">i</span><span class="o">.</span><span class="na">atBat</span><span class="o">();</span>
        <span class="c1">// You must catch the exceptions from the</span>
        <span class="c1">// base-class version of the method:</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-30">Exercise 30</h4>
<ul>
  <li><strong>Exercise 30</strong>: (2) Modify Human.java so that the exceptions inherit from RuntimeException. Modify main( ) so that the technique in TurnOffChecking.java is used to handle the different types of exceptions.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter12</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise30</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Annoyance</span> <span class="kd">extends</span> <span class="n">RuntimeException</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Sneeze</span> <span class="kd">extends</span> <span class="n">Annoyance</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">wrapException</span><span class="o">(</span><span class="kt">int</span> <span class="n">exceptionNum</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">switch</span> <span class="o">(</span><span class="n">exceptionNum</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Annoyance</span><span class="o">();</span>
                <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">Sneeze</span><span class="o">();</span>
                <span class="k">default</span><span class="o">:</span> <span class="k">return</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Sneeze</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Annoyance</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//wrapException(2);</span>
        <span class="c1">// Catch the exact type:</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">:</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[]</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">})</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">wrapException</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">RuntimeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="k">throw</span> <span class="n">e</span><span class="o">.</span><span class="na">getCause</span><span class="o">();</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Sneeze</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caught Sneeze"</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Annoyance</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caught Annoyance"</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caught other Throwable!"</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

        <div class="after-post"></div> <!-- 文章结尾，和Disqus留一些间隔。-->
        <script>
            $("div.after-post").css("margin-bottom","50px");
        </script>

        <!-- Disqus plugin -->
        <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = /java/thinking_in_java/2016/07/17/tij4-12.html;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = /java/thinking_in_java/2016/07/17/tij4-12; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//www-ciaoshen-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
    <!-- .container -->


    <!-- footer bar -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<footer>
    <!-- Don't show tag cloud
    <div class="footer" id="footer">
        <div class="container">
            <div id="tags-cloud-title">
            <div class="row">
                <div class="col-lg-12  col-md-12 col-sm-12 col-xs-12">
                    <h2>Tag Cloud</h2>
                </div>
            </div>
            </div>
            <div id="tags-cloud" class="row">
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_String" href="/tags/String.html">
                        String
                        <span class="badge">5</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Memory_Model" href="/tags/Memory_Model.html">
                        Memory_Model
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JVM" href="/tags/JVM.html">
                        JVM
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hexo" href="/tags/Hexo.html">
                        Hexo
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Github" href="/tags/Github.html">
                        Github
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Blog" href="/tags/Blog.html">
                        Blog
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Git" href="/tags/Git.html">
                        Git
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JDK" href="/tags/JDK.html">
                        JDK
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JRE" href="/tags/JRE.html">
                        JRE
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IDE" href="/tags/IDE.html">
                        IDE
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_OOP" href="/tags/OOP.html">
                        OOP
                        <span class="badge">7</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Initialization" href="/tags/Initialization.html">
                        Initialization
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Control_Flow" href="/tags/Control_Flow.html">
                        Control_Flow
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_GC" href="/tags/GC.html">
                        GC
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Access_Control" href="/tags/Access_Control.html">
                        Access_Control
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Package" href="/tags/Package.html">
                        Package
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Inheritance" href="/tags/Inheritance.html">
                        Inheritance
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Composition" href="/tags/Composition.html">
                        Composition
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Factory_Pattern" href="/tags/Factory_Pattern.html">
                        Factory_Pattern
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Polymorphism" href="/tags/Polymorphism.html">
                        Polymorphism
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Late_Binding" href="/tags/Late_Binding.html">
                        Late_Binding
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_State_Pattern" href="/tags/State_Pattern.html">
                        State_Pattern
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Interface" href="/tags/Interface.html">
                        Interface
                        <span class="badge">5</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Abstract_Class" href="/tags/Abstract_Class.html">
                        Abstract_Class
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Strategy_Pattern" href="/tags/Strategy_Pattern.html">
                        Strategy_Pattern
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Inner_Class" href="/tags/Inner_Class.html">
                        Inner_Class
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Callback" href="/tags/Callback.html">
                        Callback
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Closure" href="/tags/Closure.html">
                        Closure
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Lambda_Expression" href="/tags/Lambda_Expression.html">
                        Lambda_Expression
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Container" href="/tags/Container.html">
                        Container
                        <span class="badge">9</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Array" href="/tags/Array.html">
                        Array
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hash" href="/tags/Hash.html">
                        Hash
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Exception" href="/tags/Exception.html">
                        Exception
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IO" href="/tags/IO.html">
                        IO
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Regular_Expression" href="/tags/Regular_Expression.html">
                        Regular_Expression
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Reflection" href="/tags/Reflection.html">
                        Reflection
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Career_Path" href="/tags/Career_Path.html">
                        Career_Path
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Immutability" href="/tags/Immutability.html">
                        Immutability
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Dynamic_Proxies" href="/tags/Dynamic_Proxies.html">
                        Dynamic_Proxies
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Generics" href="/tags/Generics.html">
                        Generics
                        <span class="badge">8</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Adapter_Pattern" href="/tags/Adapter_Pattern.html">
                        Adapter_Pattern
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Wildcards" href="/tags/Wildcards.html">
                        Wildcards
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_PESC" href="/tags/PESC.html">
                        PESC
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Covariant" href="/tags/Covariant.html">
                        Covariant
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_View" href="/tags/View.html">
                        View
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Iterator" href="/tags/Iterator.html">
                        Iterator
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Fly_Weight" href="/tags/Fly_Weight.html">
                        Fly_Weight
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_LinkedList" href="/tags/LinkedList.html">
                        LinkedList
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Weak_Reference" href="/tags/Weak_Reference.html">
                        Weak_Reference
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Phantom_Reference" href="/tags/Phantom_Reference.html">
                        Phantom_Reference
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_HashMap" href="/tags/HashMap.html">
                        HashMap
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_File" href="/tags/File.html">
                        File
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Stream" href="/tags/Stream.html">
                        Stream
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Encapsulation" href="/tags/Encapsulation.html">
                        Encapsulation
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Unicode" href="/tags/Unicode.html">
                        Unicode
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_UTF-8" href="/tags/UTF-8.html">
                        UTF-8
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_ASCII" href="/tags/ASCII.html">
                        ASCII
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Encoding" href="/tags/Encoding.html">
                        Encoding
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Charset" href="/tags/Charset.html">
                        Charset
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_CPU" href="/tags/CPU.html">
                        CPU
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Process" href="/tags/Process.html">
                        Process
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Block" href="/tags/Block.html">
                        Block
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Logic_Gates" href="/tags/Logic_Gates.html">
                        Logic_Gates
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_NIO" href="/tags/NIO.html">
                        NIO
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Enum" href="/tags/Enum.html">
                        Enum
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Table_Driven" href="/tags/Table_Driven.html">
                        Table_Driven
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Annotations" href="/tags/Annotations.html">
                        Annotations
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hibernate" href="/tags/Hibernate.html">
                        Hibernate
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JUnit" href="/tags/JUnit.html">
                        JUnit
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Spring" href="/tags/Spring.html">
                        Spring
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Syntactic sugar" href="/tags/Syntactic sugar.html">
                        Syntactic sugar
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_AOP" href="/tags/AOP.html">
                        AOP
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Concurrency" href="/tags/Concurrency.html">
                        Concurrency
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Thread" href="/tags/Thread.html">
                        Thread
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_DJ" href="/tags/DJ.html">
                        DJ
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IOC" href="/tags/IOC.html">
                        IOC
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Interrupt" href="/tags/Interrupt.html">
                        Interrupt
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_HTML" href="/tags/HTML.html">
                        HTML
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_CSS" href="/tags/CSS.html">
                        CSS
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Javascript" href="/tags/Javascript.html">
                        Javascript
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JQuery" href="/tags/JQuery.html">
                        JQuery
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Sass" href="/tags/Sass.html">
                        Sass
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Responsive_Design" href="/tags/Responsive_Design.html">
                        Responsive_Design
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Code_Style" href="/tags/Code_Style.html">
                        Code_Style
                        <span class="badge">15</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Builder_Pattern" href="/tags/Builder_Pattern.html">
                        Builder_Pattern
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Instance_Control" href="/tags/Instance_Control.html">
                        Instance_Control
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Singleton" href="/tags/Singleton.html">
                        Singleton
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Comparable" href="/tags/Comparable.html">
                        Comparable
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Clone" href="/tags/Clone.html">
                        Clone
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_API" href="/tags/API.html">
                        API
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Template_Pattern" href="/tags/Template_Pattern.html">
                        Template_Pattern
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Jekyll" href="/tags/Jekyll.html">
                        Jekyll
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Bootstrap" href="/tags/Bootstrap.html">
                        Bootstrap
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_SSH" href="/tags/SSH.html">
                        SSH
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_RSA" href="/tags/RSA.html">
                        RSA
                        <span class="badge">1</span>
                        </a>
                    </div>
                
            </div>
        </div>
    </div>
    don't need tag cloud here -->

    <div class="footer-bottom">
        <div class="container">
            <p class="pull-left"> Copyright © <b>Wei SHEN</b> &nbsp | &nbsp Designed by <b>Wei SHEN</b> &nbsp | &nbsp Coded by <b>Wei SHEN</b> &nbsp | &nbsp 2015-2017. All right reserved.  &nbsp | &nbsp  Contact me: <b>symantec__@hotmail.com</b> </p>
            <div class="pull-right">
                <ul class="social">

                </ul>
            </div>
        </div>
    </div>
    <!--/.footer-bottom-->
</footer>



    <!-- Bootstrap Core JavaScript -->
    <script src="/assets/js/bootstrap.min.js"></script>
    <!-- Add space between two paragraph -->
    <script src="/assets/js/span.js"></script>
    <!-- Adjust images size -->
    <script src="/assets/js/imgResponsive.js"></script>
    <!-- Disqus comment count plugin -->
    <script id="dsq-count-scr" src="//www-ciaoshen-com.disqus.com/count.js" async></script>

</body>

</html>
