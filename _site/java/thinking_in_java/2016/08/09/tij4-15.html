<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Thinking {SHEN}</title>

    <!-- Bootstrap Core CSS -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Blog Template CSS -->
    <link href="/assets/css/blog.css" rel="stylesheet">
    <!-- jQuery Version 1.11.1 -->
    <script src="/assets/js/jquery.js"></script>
    <!-- footer bar -->
    <link href="/assets/css/footer.css" rel="stylesheet">
    <!-- code highlight. I also have other options. But this one looks good! -->
    <link href="/assets/css/jekyll-github.css" rel="stylesheet">
    <!-- Sidebar -->
    <!--<link href="/assets/css/sidebar.css" rel="stylesheet">-->


    <!-- Custom CSS -->
    <style>
        body {
            padding-top: 70px;
            /* Required padding for .navbar-fixed-top. Remove if using .navbar-static-top. Change if height of navigation changes. */
        }
        .container {
            width: 80%;
        }
    </style>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="">Thinking {SHEN}</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="/resume/">Resume</a>
                    </li>
                    <li>
                        <a href="/thinkinginjava/">Thinking in Java</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Container -->
    <div class="container">

        <!-- Page Title -->
        <div class="text-center">
      <!-- page-header是Bootstrap内置页头组件 -->
      <div class="page-header">
          <h1>[Thinking in Java] Note: Chapter 15 - Generics</h1>
      </div>
      <h5 class="blog-post-meta">
                <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span> &nbsp
                2016-08-09 06:24:15 -0400
                &nbsp | &nbsp
                <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> &nbsp
            
                <a href="/categories/Java.html"><span class="label label-primary"><b>Java</b></span></a>
                &nbsp
            
                <a href="/categories/Thinking_in_Java.html"><span class="label label-primary"><b>Thinking_in_Java</b></span></a>
                &nbsp
            
                &nbsp | &nbsp
                <span class="glyphicon glyphicon-comment" aria-hidden="true"></span> &nbsp
                <a href="#disqus_thread "></a>
      </h5>
      <h5 class="blog-post-meta">
          <span class="glyphicon glyphicon-tags" aria-hidden="true"></span> &nbsp
          
              <a href="/tags/Generics.html"><span class="label label-default">Generics</span></a>
              &nbsp
          
      </h5>
</div>


        <!-- Page Content -->
        <h3 id="泛型的语法">泛型的语法</h3>
<p>泛型的基本动机：让代码适应不同的数据类型，更好地复用。比如说<strong>“容器”</strong>。</p>

<ul>
  <li><strong>语法</strong>：用一对尖括号<code class="highlighter-rouge">&lt;T&gt;</code>，表示泛型，中间的T就是 <strong>“类型参数”</strong>。所有的T都表示同一个类型。</li>
</ul>

<p>Holder类是个最简单的容器。用来储存和操作内部单一元素。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Holder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
	<span class="c1">//字段</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t</span><span class="o">;</span>
    <span class="c1">//构造函数</span>
    <span class="kd">public</span> <span class="nf">Holder</span><span class="o">(</span><span class="n">T</span> <span class="n">inT</span><span class="o">){</span><span class="n">t</span><span class="o">=</span><span class="n">inT</span><span class="o">;}</span>
	<span class="c1">//成员方法</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">inT</span><span class="o">){</span><span class="n">t</span><span class="o">=</span><span class="n">inT</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="na">toString</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>两种情况：</p>
<ol>
  <li>类型声明的时候，后面在尖括号&lt;&gt;里加上“类型参数”。</li>
  <li>构造函数和方法声明名称的前后不用写类型参数。</li>
</ol>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Pet</span> <span class="n">p</span><span class="o">=</span><span class="k">new</span> <span class="n">Pet</span><span class="o">();</span>
        <span class="n">Dog</span> <span class="n">d</span><span class="o">=</span><span class="k">new</span> <span class="n">Dog</span><span class="o">();</span>

        <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;</span> <span class="n">h</span><span class="o">=</span><span class="k">new</span> <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;(</span><span class="n">p</span><span class="o">);</span>
        <span class="n">h</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">d</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre>
</div>

<h4 id="注意">注意</h4>
<ol>
  <li>数组不接受泛型</li>
  <li>基本型无法作为类型参数</li>
  <li>静态方法不能访问类型参数</li>
</ol>

<h3 id="泛型接口">泛型接口</h3>
<p>和泛型类一样的用法。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span><span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();}</span>
</code></pre>
</div>

<h3 id="泛型方法">泛型方法</h3>
<p>语法只需要把泛型参数列表置于返回类型之前。下面例子里void后面的<code class="highlighter-rouge">&lt;T&gt;</code>就是参数类型列表。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span><span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">f</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span>
		<span class="c1">//do something</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<h4 id="参数类型推断type-argument-inference">参数类型推断（Type Argument Inference）</h4>
<p>上面例子里的泛型方法 <strong>f()</strong>，调用的时候，不需要像泛型类那样显式的标明参数类型。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Test</span><span class="o">.</span><span class="na">f</span><span class="o">(</span><span class="s">"hello"</span><span class="o">);</span>
<span class="n">Test</span><span class="o">.</span><span class="na">f</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">Test</span><span class="o">.</span><span class="na">f</span><span class="o">(</span><span class="mf">1.0</span><span class="o">);</span>
</code></pre>
</div>
<h3 id="泛型内部类">泛型内部类</h3>
<p>当一个泛化类的内部还有一个泛化的内部类的时候，怎么处理？ 看下面这个例子：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Interface</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;{</span> <span class="kd">public</span> <span class="n">U</span> <span class="nf">getLast</span><span class="o">();}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericsDemo</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
	<span class="c1">//成员字段</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">content</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
	<span class="c1">//成员方法</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">content</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">t</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">getFirst</span><span class="o">(){</span><span class="k">return</span> <span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">size</span><span class="o">()&gt;</span><span class="mi">0</span><span class="o">)?</span> <span class="n">content</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;}</span>

	<span class="c1">//！！！注意：这里不能写成Inner&lt;T&gt;。不然编译器会误解T代表另一个新的类型参数，而不是外部主类中的类型参数T。</span>
    <span class="kd">class</span> <span class="nc">Inner</span> <span class="kd">implements</span> <span class="n">Interface</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
        <span class="kd">public</span> <span class="n">T</span> <span class="nf">getLast</span><span class="o">(){</span><span class="k">return</span> <span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">size</span><span class="o">()&gt;</span><span class="mi">0</span><span class="o">)?</span> <span class="n">content</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">size</span><span class="o">()-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;}</span>
    <span class="o">}</span>

	<span class="c1">//获取内部类引用</span>
    <span class="kd">public</span> <span class="n">Interface</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">getInterface</span><span class="o">(){</span><span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">new</span> <span class="n">Inner</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>实用主义的描述：</p>
<blockquote>
  <p>如果希望外部类的类型参数 <strong>“T”</strong> 在内部类里也保持相同的含义，在声明内部函数Inner的时候，就不要再设一个<X>类型参数。</X></p>
</blockquote>

<p>怎么调用上面的泛型内部类，看下面这个例子：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">GenericsDemo</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">gd</span><span class="o">=</span><span class="k">new</span> <span class="n">GenericsDemo</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">gd</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">);</span>

        <span class="n">GenericsDemo</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;.</span><span class="na">Inner</span> <span class="n">i1</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="na">new</span> <span class="nf">Inner</span><span class="o">();</span>
        <span class="n">Interface</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">i2</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="na">new</span> <span class="nf">Inner</span><span class="o">();</span>
        <span class="n">Interface</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">i3</span><span class="o">=</span><span class="n">gd</span><span class="o">.</span><span class="na">getInterface</span><span class="o">();</span>
    <span class="o">}</span>
</code></pre>
</div>

<p>书里LinkedStack的例子里的内部类Node<u>，就是一个反例，**`<u>`** 代表的是内部类自己的类型参数。</u></u></p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedStack</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="n">U</span> <span class="n">item</span><span class="o">;</span>
        <span class="n">Node</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>
        <span class="n">Node</span><span class="o">()</span> <span class="o">{</span> <span class="n">item</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="n">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="o">}</span>
        <span class="n">Node</span><span class="o">(</span><span class="n">U</span> <span class="n">item</span><span class="o">,</span> <span class="n">Node</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">item</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">next</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span> <span class="o">}</span>
    <span class="o">}</span>

	<span class="c1">//... ...</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="擦除erase">擦除（Erase）</h3>
<p>Java的泛型是用 <strong>“擦除”</strong> 的方式实现的。所谓擦除，就是说在运行时JVM是看到的是没有类型参数的“原生类”。比如ArrayList容器，</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ls</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ls</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>

<span class="c1">//Output: class java.util.ArrayList</span>
</code></pre>
</div>
<p>例子里的类型参数<code class="highlighter-rouge">&lt;String&gt;</code>只负责在编译期做类型检查，运行时JVM看到的是原生类“ArrayList”。</p>

<p>再看两个例子。第一，有一个存String和一个存Integer的ArrayList。比较他们的Class对象，类型相同。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Class</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;().</span><span class="na">getClass</span><span class="o">();</span>
<span class="n">Class</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;().</span><span class="na">getClass</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c1</span> <span class="o">==</span> <span class="n">c2</span><span class="o">);</span>

<span class="c1">// Output: true</span>
</code></pre>
</div>

<p>第二个例子，我们尝试用Class#getTypeParameters()方法获得泛型的类型参数。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">A</span> <span class="o">{}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getTypeParameters</span><span class="o">()));</span>
	<span class="o">}</span>
<span class="o">}</span>
<span class="c1">// Output:[E]</span>
</code></pre>
</div>
<p>结果返回的并不是真正的类型参数A，而是定义ArrayList<E>时候的占位符。</E></p>

<h4 id="c的模板reifiable-generics">C++的模板：Reifiable generics</h4>
<p>首先，和Java的擦除比，C++的模板是具体化（Reifiable）的：在编译期全展开，比如定义一个A类模板：</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">A</span><span class="p">{</span>
    <span class="k">public</span><span class="o">:</span>
        <span class="n">T</span> <span class="n">g</span><span class="p">(</span><span class="n">T</span> <span class="n">a</span><span class="p">,</span><span class="n">T</span> <span class="n">b</span><span class="p">);</span>
        <span class="n">A</span><span class="p">();</span>
<span class="p">};</span>
</code></pre>
</div>
<p>然后定义一个A类实例。</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">A</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>
<p>对编译器来说很清楚，<strong><code class="highlighter-rouge">A&lt;int&gt;</code>类就是<code class="highlighter-rouge">A&lt;int&gt;</code>。不是<code class="highlighter-rouge">A&lt;String&gt;</code></strong>。所以C++的类型很精确。</p>

<h4 id="因为擦除java泛型做不了什么">因为擦除，Java泛型做不了什么？</h4>
<p>对Java来说，像下面这样，调用泛型对象的fff()方法，编译器是通不过的。因为编译器在Runtime之前，无法知道泛型T的具体类型，是否有fff()方法。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">BBB</span> <span class="o">{</span><span class="kd">public</span> <span class="nf">fff</span><span class="o">(){}}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AAA</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="n">T</span> <span class="n">t</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nf">AAA</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">t</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>

	<span class="kd">public</span> <span class="nf">callF</span><span class="o">(){</span>
		<span class="n">t</span><span class="o">.</span><span class="na">fff</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="为什么java要用擦除实现泛型">为什么Java要用擦除实现泛型？</h4>
<p>后面还会讲到，Java用擦除实现泛型，会导致非常多的麻烦。为什么Java不实现像C++这样具体化的泛型，而是要用擦除？</p>

<p>关于这个问题，先可以看知乎上的一个问题：<a href="https://www.zhihu.com/question/28665443"><strong>《Java不能实现真正泛型的原因？》</strong></a>。尤其是RednexelaFX的回答。
还可以参考另一个回答：<a href="https://www.zhihu.com/question/34621277/answer/59440954"><strong>《Reifiable generics与Type erasure generics各有怎样的优点与缺点？》</strong></a></p>

<p>简单讲，首先，Java不是技术上“实现不了”。在2014的Project Valhalla里，就已经实现过。用擦除是为了 <strong>“向后兼容”</strong> 的考虑。引用Martin Odersky的原话：</p>

<ul>
  <li>In the Java generic designs, there were a lot of very very hard constrains. The strongest, the most difficult to cope with, was that it had to be fully backwards compatibility with ungenerified java.</li>
</ul>

<p>泛型不是在Java1.0就有的特性。而是在Java 5才加进来的。所以Java强调的向后兼容，是 <strong>“二进制向后兼容（binary backwards compatibility）”</strong>。</p>

<p>也就是每一个在Java1，Java2等老版本上能正常运行的的class文件，放在Java5，6，7，8的JRE上也要正常运行。实际上在加入Java5加入泛型之前，java的类库已经经过好几年发展，有一定规模了。如果为了新泛型，把过去的类库全部推倒重来是不现实的。这就是所谓的“历史包袱”。</p>

<p>在这个背景下，要让老版本的没有泛型的ArrayList，在支持泛型的虚拟机上运行，擦除是最简单的办法。</p>

<h4 id="泛型类型参数擦除到第一个边界">泛型类型参数擦除到第一个边界</h4>
<p>还是上面这个例子，如果声明AAA类的泛型参数T的时候，加上一个 <strong>“边界”</strong>：extends BBB。编译就能通过了。因为这时候编译器会**把<T extends="" BBB="">从左往右擦除**，直到第一个边界“BBB”。所以，剩下的就是 **“public class AAA<BBB>”**。这时候，编译器就能检查BBB类有没有实现fff()方法了。</BBB></T></p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">BBB</span> <span class="o">{</span><span class="kd">public</span> <span class="nf">fff</span><span class="o">(){}}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AAA</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">BBB</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="n">T</span> <span class="n">t</span><span class="o">;</span>
	<span class="kd">public</span> <span class="nf">AAA</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">t</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>

	<span class="kd">public</span> <span class="nf">callF</span><span class="o">(){</span>
		<span class="n">t</span><span class="o">.</span><span class="na">fff</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="泛型数组">泛型数组</h3>
<p>Java不允许泛型数组。因为数组是强类型的，在运行时必须检测到实际数据类型，创建数组的时候必须知道数组中元素的具体类型。
具体可以参考另一篇专题：<a href="http://www.ciaoshen.com/2016/08/21/noGenericArray/"><strong>《Java为什么不支持泛型数组？》</strong></a></p>

<h4 id="运行时类型检查的好处">运行时类型检查的好处</h4>
<p>因为数组在运行时做类型检查，所以基类数组里能存放派生类对象。这叫数组的“协变”。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Number</span><span class="o">[]</span> <span class="n">numArray</span><span class="o">=</span><span class="k">new</span> <span class="n">Integer</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
</code></pre>
</div>
<p>一个Number数组，可以用所有Number类的派生类Integer，Long，Short，Float，Double等等的数组来为Number[]数组赋值。因为数组做运行时类型检查，不怕。</p>

<p>但不做运行时检查的Collection容器，比如List就不行。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">List</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">numList</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
</code></pre>
</div>
<p>对编译器来讲，List<Number>不是List<Integer>。因为泛型擦除之后都是List<object>，容器运行时无法做类型检查，所以编译器不允许用List<Integer>为List<Number>赋值。</Number></Integer></object></Integer></Number></p>

<h4 id="两种方法声明泛型数组">两种方法声明泛型数组</h4>
<h5 id="接受检查的强类型方法理论上更好的方法">接受检查的强类型方法（理论上更好的方法）</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">E</span><span class="o">[]</span> <span class="n">a</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">GenSet</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">,</span> <span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Use Array native method to create array</span>
        <span class="c1">// of a type only known at run time</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
        <span class="kd">final</span> <span class="n">E</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="n">E</span><span class="o">[])</span> <span class="n">Array</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="n">E</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="不接受检查的弱类型方法jdk里普遍使用">不接受检查的弱类型方法（JDK里普遍使用）</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenSet</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">a</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">GenSet</span><span class="o">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">s</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="n">E</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
        <span class="kd">final</span> <span class="n">E</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="n">E</span><span class="o">)</span> <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="第二种方法里需要注意">第二种方法里需要注意</h5>
<p>不能给对象数组Object[]转型。因为String[]和Object[]之间不存在IS-A的关系。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Object</span><span class="o">[]</span> <span class="n">o</span><span class="o">=</span><span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
<span class="n">String</span><span class="o">[]</span> <span class="n">s</span><span class="o">=</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
<span class="n">s</span><span class="o">[</span><span class="mi">0</span><span class="o">]=</span><span class="s">"hello"</span><span class="o">;</span>

<span class="n">s</span><span class="o">=(</span><span class="n">String</span><span class="o">)</span><span class="n">o</span><span class="o">;</span>
</code></pre>
</div>

<p>所以，下面例子里的操作是不允许的。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">o</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Test3</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">){</span><span class="n">o</span><span class="o">=</span><span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">num</span><span class="o">];}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">){</span>
        <span class="k">if</span><span class="o">(</span><span class="n">index</span><span class="o">&lt;</span><span class="n">o</span><span class="o">.</span><span class="na">length</span><span class="o">){</span>
            <span class="n">o</span><span class="o">[</span><span class="n">index</span><span class="o">]=</span><span class="n">t</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
	<span class="c1">//单个元素转型：可以</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">){</span><span class="k">return</span> <span class="o">(</span><span class="n">index</span><span class="o">&lt;</span><span class="n">o</span><span class="o">.</span><span class="na">length</span><span class="o">)?</span> <span class="o">(</span><span class="n">T</span><span class="o">)</span><span class="n">o</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;}</span>
	<span class="c1">//对数组转型：报错</span>
    <span class="kd">public</span> <span class="n">T</span><span class="o">[]</span> <span class="nf">getAll</span><span class="o">(){</span><span class="k">return</span> <span class="o">(</span><span class="n">T</span><span class="o">[])</span><span class="n">o</span><span class="o">;}</span>	<span class="c1">//Error</span>
<span class="o">}</span>
</code></pre>
</div>
<h3 id="桥方法">桥方法</h3>
<p>另一个Java擦除引起的麻烦在反省类被继承的时候发生。Java核心技术里给出下面这个例子：（参见：Java核心技术卷1：P536）
假设我有个泛型类Pair。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Pair</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
	<span class="kd">private</span> <span class="n">T</span> <span class="n">first</span><span class="o">;</span>
	<span class="kd">private</span> <span class="n">T</span> <span class="n">second</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">T</span> <span class="nf">getFirst</span><span class="o">(){</span><span class="k">return</span> <span class="n">first</span><span class="o">;}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSecond</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">seconde</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>然后有一个表示日期区间的派生类DateInteval。它为了确保日期区间的第二个值比第一个大，重写了基类Pair的setSecond()方法。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">DateInteval</span> <span class="kd">extends</span> <span class="n">Pair</span><span class="o">&lt;</span><span class="n">Date</span><span class="o">&gt;{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSecond</span><span class="o">(</span><span class="n">Date</span> <span class="n">d</span><span class="o">){</span>
		<span class="k">if</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">getFirst</span><span class="o">())&gt;=</span><span class="mi">0</span><span class="o">){</span>
			<span class="n">second</span><span class="o">=</span><span class="n">d</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<p>这时候就会产生一个问题，实际上DateInteval类同时具备两个setSecond方法，后面的重写的setSecond方法没有覆盖掉基类Pair的setSecond方法，因为参数类型不同。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSecond</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">);</span>	<span class="c1">//继承自基类Pair。</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSecond</span><span class="o">(</span><span class="n">Date</span> <span class="n">d</span><span class="o">);</span>
</code></pre>
</div>
<p>如果这时候我给setSecond方法传递一个Object对象，就会错误调用继承自基类的版本。这可能不是程序员想要的。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">DateInteval</span> <span class="n">di</span><span class="o">=</span><span class="k">new</span> <span class="n">DateInteval</span><span class="o">();</span>
<span class="n">Object</span> <span class="n">o</span><span class="o">=</span><span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
<span class="n">di</span><span class="o">.</span><span class="na">setSecond</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
</code></pre>
</div>
<p>所以实际上JVM在这个时候会自动合成一个 <strong>“桥方法（Bridge Method）”</strong>：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSecond</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">){</span><span class="n">setSecond</span><span class="o">((</span><span class="n">Date</span><span class="o">)</span><span class="n">o</span><span class="o">);}</span>
</code></pre>
</div>
<p>这样，当我们像前面这样给setSecond传递一个Object对象的时候，会自动跳转调用正确的setSecond(Date)方法。然后因为参数类型不匹配，会抛出ClassCastException异常。</p>

<h3 id="通配符">通配符</h3>
<p>一篇IBM Developer上的文章
<a href="http://www.ibm.com/developerworks/cn/java/j-jtp04298.html"><strong>《Java 理论与实践: 使用通配符简化泛型使用》</strong></a></p>

<ul>
  <li>无界通配符：<code class="highlighter-rouge">&lt;?&gt;</code></li>
  <li>上界通配符：<code class="highlighter-rouge">&lt;? extends XXX&gt;</code></li>
  <li>下界通配符：<code class="highlighter-rouge">&lt;? super XXX&gt;</code></li>
</ul>

<p>贴两张图：
<img src="/images/tij4-15/lowerBounds.png" alt="extends" />
<img src="/images/tij4-15/upperBounds.png" alt="super" /></p>

<p>具体可以参考另两篇专题：<a href="http://www.ciaoshen.com/2016/08/21/superExtends/"><strong>《Java泛型中extends和super的区别？》</strong></a>， <a href="http://www.ciaoshen.com/2016/08/21/wildcards/"><strong>《通配符”?”和类型参数”T”的区别？》</strong></a></p>

<h4 id="pecs原则">PECS原则</h4>
<p>PECS（Producer Extends Consumer Super）原则是要记住的：</p>
<ul>
  <li>频繁往外读取内容的，适合用上界Extends。</li>
  <li>经常往里插入的，适合用下界Super。</li>
</ul>

<p>具体细节还是参看上面两篇专题。</p>

<h4 id="关于无界通配符的第一个例子">关于无界通配符的第一个例子</h4>
<p>通过这个例子，理解一下通配符的捕获机制。</p>

<p>当一个通配符捕获一个运行时具体类型之后，会被标记成CAP#XXX。就不接受任何具体类型的操作。看下面这个例子感受一下。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Ticket</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">info</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Ticket</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">info</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">info</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">info</span><span class="o">.</span><span class="na">toString</span><span class="o">();}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Box</span><span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">V</span> <span class="n">item</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">V</span> <span class="n">v</span><span class="o">){</span><span class="n">item</span><span class="o">=</span><span class="n">v</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="na">toString</span><span class="o">();}</span>

<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestWildcards</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="cm">/**
         *  Box&lt;Ticket&lt;?&gt;&gt;里什么Ticket都能放。因为通配符没有捕获类型。
         */</span>
        <span class="n">Box</span><span class="o">&lt;</span><span class="n">Ticket</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">box</span><span class="o">=</span><span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Ticket</span><span class="o">&lt;?&gt;&gt;();</span>

        <span class="n">Ticket</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ti</span><span class="o">=</span><span class="k">new</span> <span class="n">Ticket</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="mi">111</span><span class="o">);</span>
        <span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">ts</span><span class="o">=</span><span class="k">new</span> <span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="s">"Hello"</span><span class="o">);</span>

        <span class="n">box</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">ti</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">box</span><span class="o">);</span>
        <span class="n">box</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">ts</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">box</span><span class="o">);</span>

        <span class="cm">/**
         *  Ticket&lt;?&gt;被赋值一种泛型之后，就所有的操作都不能做了。因为通配符捕获运行时实际类型后，标记为CAP#1。
         */</span>
        <span class="n">Ticket</span><span class="o">&lt;?&gt;</span> <span class="n">t</span><span class="o">=</span><span class="k">new</span> <span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="s">"World"</span><span class="o">);</span>
        <span class="c1">//t.set(111);   //ERROR, 什么类型都不接受</span>
        <span class="c1">//t.set("what?");   //ERROR, 什么类型都不接受</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>


        <span class="cm">/**
         *  Box&lt;Ticket&lt;String&gt;&gt;里只能放Ticket&lt;String&gt;
         */</span>
        <span class="n">Box</span><span class="o">&lt;</span><span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">boxTstr</span><span class="o">=</span><span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
        <span class="n">boxTstr</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="k">new</span> <span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="s">"NoProblem"</span><span class="o">));</span>
        <span class="c1">//boxTstr.set(new Ticket&lt;Integer&gt;(111));    //ERROR，编译器类型检查通不过</span>

        <span class="cm">/**
         *  同样，当通配符捕获运行时实际类型后，标记为CAP#1。就什么操作也做不了
         */</span>
        <span class="n">Box</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Ticket</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">boxTstr2</span><span class="o">=</span><span class="k">new</span> <span class="n">Box</span><span class="o">&lt;</span><span class="n">Ticket</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;();</span>
        <span class="c1">//boxTstr2.set(new Ticket&lt;String&gt;("Now?"));   //ERROR, 什么类型都不接受</span>
        <span class="c1">//boxTstr2.set(new Ticket&lt;Integer&gt;(222)); //ERROR, 什么类型都不接受</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>
<h4 id="关于通配符第二个例子">关于通配符第二个例子</h4>
<p>下面这个例子基本把通配符常见的使用场景都包括了，遇到问题可以来查一下。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Holder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">t</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Wildcards</span> <span class="o">{</span>
    <span class="c1">// 原生类：无泛型，就用Object代替</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">rawArgs</span><span class="o">(</span><span class="n">Holder</span> <span class="n">holder</span><span class="o">,</span> <span class="n">Object</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//可以。raw type警告</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span> <span class="c1">// raw type Warning:</span>

        <span class="c1">// 可以。raw type警告</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="k">new</span> <span class="n">Wildcards</span><span class="o">());</span> <span class="c1">// raw type warning</span>

        <span class="c1">// 不行。这里没有泛型T</span>
        <span class="c1">//T t = holder.get();</span>

        <span class="c1">// 可以。但原先holder里的类型信息丢失。</span>
        <span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">holder</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// 无边界通配符</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">unboundedArg</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?&gt;</span> <span class="n">holder</span><span class="o">,</span> <span class="n">Object</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//报错。因为Holder&lt;capture of ?&gt; 里的set(capture of ?)方法，代表某种不知道类型的参数，不能接受Object类型，也不接受任何类型。</span>
        <span class="c1">//holder.set(arg); // Error:</span>

        <span class="c1">//报错。因为Holder&lt;capture of ?&gt; 里的set(capture of ?)方法，代表某种不知道类型的参数，不能接受Object类型，也不接受任何类型。</span>
        <span class="c1">//holder.set(new Wildcards()); // Same error</span>

        <span class="c1">// 不行，没有泛型T</span>
        <span class="c1">//T t = holder.get();</span>

        <span class="c1">// 可以。只有Object型可以接受通配符型&lt;?&gt;的赋值。但原先holder里的类型信息丢失。</span>
        <span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">holder</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// 正常泛型&lt;T&gt;，没问题</span>
    <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">exact1</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">holder</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">T</span> <span class="n">t</span> <span class="o">=</span> <span class="n">holder</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// 正常泛型&lt;T&gt;，没问题</span>
    <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">exact2</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">holder</span><span class="o">,</span> <span class="n">T</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span>
        <span class="n">T</span> <span class="n">t</span> <span class="o">=</span> <span class="n">holder</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//子类边界</span>
    <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">wildSubtype</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">holder</span><span class="o">,</span> <span class="n">T</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//报错。Holder&lt;? extends T&gt; 里的set(? extends T)方法，不能接受T类型</span>
        <span class="c1">//holder.set(arg); // Error:</span>

        <span class="c1">//可以。holder.get()返回T或T的子类，可以赋值给T类型。</span>
        <span class="n">T</span> <span class="n">t</span> <span class="o">=</span> <span class="n">holder</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//超类边界</span>
    <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">wildSupertype</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">holder</span><span class="o">,</span> <span class="n">T</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//可以。因为set(? super T)接受T或T的超类为参数。无论如何都能接受T类型。</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">arg</span><span class="o">);</span>

        <span class="c1">//报错。holder.get()返回T或T的超类，无法放进T类型里。</span>
        <span class="c1">//T t = holder.get(); // Error:</span>

        <span class="c1">// 可以。但原先holder里的类型信息丢失。</span>
        <span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">holder</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//Holder raw = new Holder&lt;Long&gt;();</span>
        <span class="c1">// Or:</span>
        <span class="n">Long</span> <span class="n">lng</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
        <span class="n">Object</span> <span class="n">o</span><span class="o">=</span><span class="k">new</span> <span class="n">Object</span><span class="o">();</span>

        <span class="c1">//四种不同程度泛化的Holder对象</span>
        <span class="n">Holder</span> <span class="n">raw</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Holder</span><span class="o">();</span>
        <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">qualified</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
        <span class="n">Holder</span><span class="o">&lt;?&gt;</span> <span class="n">unbounded</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
        <span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Long</span><span class="o">&gt;</span> <span class="n">bounded</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>

        <span class="c1">//原生类Holder为参数：四种Holder放进去都没问题</span>
        <span class="n">rawArgs</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>
        <span class="n">rawArgs</span><span class="o">(</span><span class="n">qualified</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>
        <span class="n">rawArgs</span><span class="o">(</span><span class="n">unbounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>
        <span class="n">rawArgs</span><span class="o">(</span><span class="n">bounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//无边界通配符Holder：无论放什么都不行，编译期已经报错</span>
        <span class="n">unboundedArg</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>
        <span class="n">unboundedArg</span><span class="o">(</span><span class="n">qualified</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>
        <span class="n">unboundedArg</span><span class="o">(</span><span class="n">unbounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>
        <span class="n">unboundedArg</span><span class="o">(</span><span class="n">bounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//警告：用Holder当Holder&lt;T&gt;类型参数</span>
        <span class="n">Object</span> <span class="n">r1</span> <span class="o">=</span> <span class="n">exact1</span><span class="o">(</span><span class="n">raw</span><span class="o">);</span> <span class="c1">// Warnings: unchecked</span>

        <span class="c1">//没问题</span>
        <span class="n">Long</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">exact1</span><span class="o">(</span><span class="n">qualified</span><span class="o">);</span>

        <span class="c1">//只有Object可以接受&lt;?&gt;通配符的返回类型</span>
        <span class="n">Object</span> <span class="n">r3</span> <span class="o">=</span> <span class="n">exact1</span><span class="o">(</span><span class="n">unbounded</span><span class="o">);</span> <span class="c1">// Must return Object</span>

        <span class="c1">//没问题</span>
        <span class="n">Long</span> <span class="n">r4</span> <span class="o">=</span> <span class="n">exact1</span><span class="o">(</span><span class="n">bounded</span><span class="o">);</span>

        <span class="c1">//警告：用Holder当Holder&lt;Long&gt;</span>
        <span class="n">Long</span> <span class="n">r5</span> <span class="o">=</span> <span class="n">exact2</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Warnings: unchecked</span>

        <span class="c1">//没问题</span>
        <span class="n">Long</span> <span class="n">r6</span> <span class="o">=</span> <span class="n">exact2</span><span class="o">(</span><span class="n">qualified</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//报错：exact2(Holder&lt;T&gt;,T)方法不能用（Holder&lt;capture of ?&gt;,Long）这两个参数。</span>
        <span class="n">Long</span> <span class="n">r7</span> <span class="o">=</span> <span class="n">exact2</span><span class="o">(</span><span class="n">unbounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Error:</span>

        <span class="c1">//报错：exact2(Holder&lt;T&gt;,T)方法不能用（Holder&lt;capture of ? extends Long&gt;,Long）这两个参数。</span>
        <span class="n">Long</span> <span class="n">r8</span> <span class="o">=</span> <span class="n">exact2</span><span class="o">(</span><span class="n">bounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Error:</span>

        <span class="c1">//警告：改用holder&lt;Long&gt;的地方用了holder原生类</span>
        <span class="n">Long</span> <span class="n">r9</span> <span class="o">=</span> <span class="n">wildSubtype</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Warnings: unchecked</span>

        <span class="c1">//警告：该给(Holder&lt;? extends T&gt;,T)参数的，给了(Holder,Long)</span>
        <span class="n">Long</span> <span class="n">r10</span> <span class="o">=</span> <span class="n">wildSubtype</span><span class="o">(</span><span class="n">qualified</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//没问题，但只能用Object来接收返回值</span>
        <span class="n">Object</span> <span class="n">r11</span> <span class="o">=</span> <span class="n">wildSubtype</span><span class="o">(</span><span class="n">unbounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//没问题</span>
        <span class="n">Long</span> <span class="n">r12</span> <span class="o">=</span> <span class="n">wildSubtype</span><span class="o">(</span><span class="n">bounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//警告：该给(Holder&lt;? super T&gt;,T)参数的，给了(Holder,Long)</span>
        <span class="n">wildSupertype</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Warnings:</span>

        <span class="c1">//没问题</span>
        <span class="n">wildSupertype</span><span class="o">(</span><span class="n">qualified</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span>

        <span class="c1">//报错：该给(Holder&lt;? super T&gt;,T)参数的，给了(Holder&lt;capture of ?&gt;,Long)</span>
        <span class="n">wildSupertype</span><span class="o">(</span><span class="n">unbounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Error:</span>

        <span class="c1">//报错：该给(Holder&lt;? super T&gt;,T)参数的，给了(Holder&lt;capture of ? extends Long&gt;,Long)</span>
        <span class="n">wildSupertype</span><span class="o">(</span><span class="n">bounded</span><span class="o">,</span> <span class="n">lng</span><span class="o">);</span> <span class="c1">// Error:</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="无界通配符的第三个例子">无界通配符的第三个例子</h4>
<p>使用一个泛型类<code class="highlighter-rouge">Plate&lt;T&gt;</code>，如果用无界通配符<code class="highlighter-rouge">Plate&lt;?&gt;</code>，就可以放各种不同的类型。每存入一个类型，都会临时命名为CAP#XXX。</p>

<p><strong>所以<code class="highlighter-rouge">List&lt;Plate&lt;?&gt;&gt;</code>里什么Plate都能放。</strong></p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">();}</span>
<span class="kd">class</span> <span class="nc">Apple</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Apple!"</span><span class="o">;}}</span>
<span class="kd">class</span> <span class="nc">Banana</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Banana!"</span><span class="o">;}}</span>
<span class="kd">class</span> <span class="nc">Melon</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Melon!"</span><span class="o">;}}</span>

<span class="kd">class</span> <span class="nc">Plate</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">item</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Plate</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">item</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A plate of "</span><span class="o">+</span><span class="n">item</span><span class="o">;}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WildBox</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">t</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">){</span><span class="k">return</span> <span class="o">(</span><span class="n">index</span><span class="o">&lt;</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">())?</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">):</span><span class="kc">null</span><span class="o">;}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">WildBox</span><span class="o">&lt;</span><span class="n">Plate</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="n">WildBox</span><span class="o">&lt;</span><span class="n">Plate</span><span class="o">&lt;?&gt;&gt;();</span>
        <span class="n">wb</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Apple</span><span class="o">()));</span>
        <span class="n">wb</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Banana</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Banana</span><span class="o">()));</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wb</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wb</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//Output:</span>
<span class="c1">//A plate of Apple!</span>
<span class="c1">//A plate of Banana!</span>
</code></pre>
</div>

<p><strong>但判断<code class="highlighter-rouge">Set&lt;Plate&lt;?&gt;&gt;</code>里都有什么Plate，都是false。体会一下通配符的捕获机制。</strong></p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">();}</span>
<span class="kd">class</span> <span class="nc">Apple</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Apple!"</span><span class="o">;}}</span>
<span class="kd">class</span> <span class="nc">Banana</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Banana!"</span><span class="o">;}}</span>
<span class="kd">class</span> <span class="nc">Melon</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Melon!"</span><span class="o">;}}</span>

<span class="kd">class</span> <span class="nc">Plate</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">item</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Plate</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">item</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A plate of "</span><span class="o">+</span><span class="n">item</span><span class="o">;}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WildBox2</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">set</span><span class="o">=</span><span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">set</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">t</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">contains</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="k">return</span> <span class="n">set</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">t</span><span class="o">);}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">WildBox2</span><span class="o">&lt;</span><span class="n">Plate</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="n">WildBox2</span><span class="o">&lt;</span><span class="n">Plate</span><span class="o">&lt;?&gt;&gt;();</span>
        <span class="n">wb</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Apple</span><span class="o">()));</span>
        <span class="n">wb</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Banana</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Banana</span><span class="o">()));</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wb</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Apple</span><span class="o">())));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wb</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Banana</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Banana</span><span class="o">())));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wb</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Melon</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Melon</span><span class="o">())));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="协变和自限定">协变和自限定</h3>
<h4 id="协变">协变</h4>
<p>根据Override重写的规则，被重写方法的参数和返回值都不能变。</p>

<p>Java 5.0开始允许在派生类中继承自基类的方法改变返回值。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Base</span> <span class="o">{}</span>
<span class="kd">class</span> <span class="nc">Derived</span> <span class="kd">extends</span> <span class="n">Base</span> <span class="o">{}</span>

<span class="kd">interface</span> <span class="nc">OrdinaryGetter</span> <span class="o">{</span>
    <span class="n">Base</span> <span class="nf">get</span><span class="o">();</span>
<span class="o">}</span>
<span class="kd">interface</span> <span class="nc">DerivedGetter</span> <span class="kd">extends</span> <span class="n">OrdinaryGetter</span> <span class="o">{</span>
    <span class="c1">// Return type of overridden method is allowed to vary:</span>
    <span class="n">Derived</span> <span class="nf">get</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="古怪的循环泛型crg">古怪的循环泛型（CRG）</h4>
<p>“<strong>古怪的循环泛型</strong>”的本质就是：“<strong>基类用导出类作为类型参数</strong>”。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">BaseGeneric</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{}</span>
<span class="kd">class</span> <span class="nc">SubType</span> <span class="kd">extends</span> <span class="n">BaseGeneric</span><span class="o">&lt;</span><span class="n">SubType</span><span class="o">&gt;</span> <span class="o">{}</span>
</code></pre>
</div>

<p>这种循环泛型的好处是，泛型基类BaseGeneric里定义的方法，是以其自身的导出类SubType为参数，和返回值。所以SubType类所继承的方法都是以同类SubType的其他对象实例为参数和返回值。所以，泛型基类BaseGeneric相当于定义了针对它自身导出类的一系列操作。然后<strong>它的导出类就只能操作自己的同类对象</strong>。这是循环泛型的意义所在。</p>

<h4 id="自限定">自限定</h4>
<p>但上面的例子只是说SubType使用了循环泛型的用法。但泛型基类BaseGeneric的其他子类完全可以不使用循环泛型。</p>

<p>所以自限定的意义就在于，在定义泛型基类的时候，强制这个泛型基类的导出类，只能使用循环泛型的形式。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">SelfBounds</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">SelfBounds</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="o">{}</span>
</code></pre>
</div>

<p>自限定类型最典型的应用：Enum枚举型
一定要看这篇关于枚举型的文章–<a href="https://www.ibm.com/developerworks/cn/java/j-lo-enum/"><strong>《Java 语言中 Enum 类型的使用介绍》</strong></a></p>

<h4 id="自限定自带协变特性">自限定自带协变特性</h4>
<p>Getter g的g.get()方法的返回值是派生类Getter类型，而不是基类GenericGetter类型。而且和普通的继承规则不同，g.get()方法不是被重载(overload)而是重写(override)。</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">GenericGetter</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">GenericGetter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
    <span class="n">T</span> <span class="nf">get</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">Getter</span> <span class="kd">extends</span> <span class="n">GenericGetter</span><span class="o">&lt;</span><span class="n">Getter</span><span class="o">&gt;</span> <span class="o">{}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericsAndReturnTypes</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">test</span><span class="o">(</span><span class="n">Getter</span> <span class="n">g</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Getter</span> <span class="n">result</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="n">GenericGetter</span> <span class="n">gg</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="na">get</span><span class="o">();</span> <span class="c1">// Also the base type</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="异常">异常</h3>
<p>想要抛出根据泛型变化的异常，就需要把异常当成类型参数写进函数里。然后由throws关键字抛出。看下面这个例子：</p>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Processor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">,</span> <span class="n">F</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">resultCollector</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">ProcessRunner</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">,</span> <span class="n">F</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Processor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">processAll</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">E</span><span class="o">,</span><span class="n">F</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">resultCollector</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Processor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;</span> <span class="n">processor</span> <span class="o">:</span> <span class="k">this</span><span class="o">){</span>
            <span class="n">processor</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">resultCollector</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resultCollector</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="java缺乏潜在类型机制">Java缺乏“潜在类型”机制</h3>
<h4 id="c和python都支持潜在类型机制">C++和Python都支持“潜在类型”机制</h4>
<p>潜在类型机制也叫“鸭子类型机制”。大白话说就是：我不用定义一个关于方法a()和方法b()的接口。我可以不关心类型，只要有a()方法和b()方法就行。</p>

<p>Python里可以有这样的代码：</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">print</span> <span class="s">"Arf!"</span>
	<span class="k">def</span> <span class="nf">sit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">print</span> <span class="s">"Sitting"</span>
	<span class="k">def</span> <span class="nf">reproduce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">pass</span>

<span class="k">class</span> <span class="nc">Robot</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">speak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">print</span> <span class="s">"Click!"</span>
	<span class="k">def</span> <span class="nf">sit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">print</span> <span class="s">"Clank!"</span>
	<span class="k">def</span> <span class="nf">oilChange</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
		<span class="k">pass</span>

<span class="k">def</span> <span class="nf">perform</span><span class="p">(</span><span class="n">anything</span><span class="p">):</span>
	<span class="n">anything</span><span class="o">.</span><span class="n">speak</span><span class="p">()</span>
	<span class="n">anything</span><span class="o">.</span><span class="n">sit</span><span class="p">()</span>
</code></pre>
</div>

<p>C++里可以这样写：</p>
<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Dog</span> <span class="p">{</span>
	<span class="k">public</span><span class="o">:</span>
	<span class="kt">void</span> <span class="n">speak</span><span class="p">()</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">sit</span><span class="p">()</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">reproduce</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">Robot</span> <span class="p">{</span>
	<span class="k">public</span><span class="o">:</span>
	<span class="kt">void</span> <span class="n">speak</span><span class="p">()</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">sit</span><span class="p">()</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">oilChange</span><span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="n">perform</span><span class="p">(</span><span class="n">T</span> <span class="n">anything</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">anything</span><span class="p">.</span><span class="n">speak</span><span class="p">();</span>
	<span class="n">anything</span><span class="p">.</span><span class="n">sit</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

<h4 id="用适配器模式模拟潜在类型">用适配器模式模拟“潜在类型”</h4>
<p>Java泛型的先天不足，可以用模式来弥补。下面的例子用适配器模式，模拟出一个“潜在类型”。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//addable接口</span>
<span class="kd">interface</span> <span class="nc">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">);</span> <span class="o">}</span>

<span class="c1">//面向Addable接口的fill方法</span>
<span class="kd">class</span> <span class="nc">FillPets</span> <span class="o">{</span>
    <span class="c1">//用反射填充容器</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Pet</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">fill</span><span class="o">(</span><span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">addable</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">classToken</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">addable</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">classToken</span><span class="o">.</span><span class="na">newInstance</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/** 《适配器》
 * 原理是类库里的Collection和SimpleQueue动不了。
 * 那就给他们都套一层代理。然后新的代理类实现Addable接口。
 */</span>

<span class="c1">//Collection是通过组合的方式套代理</span>
<span class="kd">class</span> <span class="nc">AddableCollectionAdapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">AddableCollectionAdapter</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// 把加了add()方法的容器的引用，赋值给Addable接口。</span>
<span class="kd">class</span> <span class="nc">Adapter</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">collectionAdapter</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AddableCollectionAdapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//SimpleQueue</span>
<span class="kd">class</span> <span class="nc">SimpleQueue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span> <span class="n">storage</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">t</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">//SimpleQueue的派生类实现Addable接口。</span>
<span class="kd">class</span> <span class="nc">AddableSimpleQueue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">SimpleQueue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 *  LEV 1
 */</span>
<span class="kd">class</span> <span class="nc">Individual</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(){</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">=</span><span class="s">"NULL"</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">=</span><span class="n">name</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"..."</span><span class="o">);}</span>
<span class="o">}</span>

<span class="cm">/**
 *  LEV 2
 */</span>
<span class="kd">class</span> <span class="nc">Person</span> <span class="kd">extends</span> <span class="n">Individual</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Pet</span> <span class="kd">extends</span> <span class="n">Individual</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Pet</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Pet</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"!!!"</span><span class="o">);}</span>
<span class="o">}</span>

<span class="cm">/**
 *  LEV 3 - 狗，猫，鼠
 */</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"WongWong!!!"</span><span class="o">);}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MiewMiew!!!"</span><span class="o">);}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Rodent</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"JiJiJi!!!"</span><span class="o">);}</span>
<span class="o">}</span>

<span class="cm">/**
 *  LEV 4 - 狗系
 */</span>
<span class="kd">class</span> <span class="nc">Mutt</span> <span class="kd">extends</span> <span class="n">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Pug</span> <span class="kd">extends</span> <span class="n">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Pug</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Pug</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 *  LEV 4 - 猫系
 */</span>
<span class="kd">class</span> <span class="nc">EgyptianMau</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Manx</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Manx</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Manx</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 *  LEV 4 - 鼠系
 */</span>
<span class="kd">class</span> <span class="nc">Rat</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Rat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Rat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Mouse</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Hamster</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

 <span class="o">*</span>  <span class="err">测试类</span>
 <span class="o">*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise41</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="c1">//Pet容器</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">dogs</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;();</span>
        <span class="c1">//给Pet容器套上实现了Addable接口的适配器，就能用面向Addable接口的fill()方法了。</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="k">new</span> <span class="n">AddableCollectionAdapter</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;(</span><span class="n">dogs</span><span class="o">),</span><span class="n">Mutt</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
        <span class="c1">//用辅助方法获得Addable接口对象实例</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">Adapter</span><span class="o">.</span><span class="na">collectionAdapter</span><span class="o">(</span><span class="n">dogs</span><span class="o">),</span> <span class="n">Pug</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Dog</span> <span class="nl">d:</span> <span class="n">dogs</span><span class="o">){</span>
            <span class="n">d</span><span class="o">.</span><span class="na">speak</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"----------------------"</span><span class="o">);</span>

        <span class="c1">//SimpleQueue实现了Addable()接口与的派生类。也可以用fill()方法填充。</span>
        <span class="n">AddableSimpleQueue</span><span class="o">&lt;</span><span class="n">Cat</span><span class="o">&gt;</span> <span class="n">catQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddableSimpleQueue</span><span class="o">&lt;</span><span class="n">Cat</span><span class="o">&gt;();</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">catQueue</span><span class="o">,</span> <span class="n">EgyptianMau</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">catQueue</span><span class="o">,</span> <span class="n">Manx</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Cat</span> <span class="nl">c:</span> <span class="n">catQueue</span><span class="o">){</span>
            <span class="n">c</span><span class="o">.</span><span class="na">speak</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h3 id="最佳实践">最佳实践</h3>
<ul>
  <li>如果只是用泛型方法可以取代将整个类泛型化，就应该只使用泛型方法。</li>
  <li>只有当想实现跨越多个类的应用，才应该使用泛型。</li>
</ul>

<h3 id="记住">记住</h3>
<ul>
  <li>虚拟机里没有泛型，只有普通的类和方法</li>
  <li>所有类型的参数都用他们的限定类型替换</li>
  <li>桥方法被合成保持多态</li>
  <li>为了保持类型安全性，必要时插入强制类型转换</li>
</ul>

<h3 id="思考">思考</h3>
<ul>
  <li>编译时类型检查，运行时类型检查都还不够。还需要一个良好的命名，以及良好的测试，来保证类型安全。</li>
  <li>类型安全并不是泛型的根本目的。增加代码的通用性才是。类型安全反而是编写通用代码带来的副作用。</li>
</ul>

<h3 id="练习">练习</h3>
<h4 id="exercise-1">Exercise 1</h4>
<ul>
  <li><strong>Exercise 1</strong>: (1) Use Holders with the typeinfo.pets library to show that a Holders that is specified to hold a base type can also hold a derived type.</li>
</ul>

<h5 id="petjava">Pet.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Pet</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A Pet!"</span><span class="o">;}}</span>
</code></pre>
</div>
<h5 id="dogjava">Dog.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Pet</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A Dog!"</span><span class="o">;}}</span>
</code></pre>
</div>
<h5 id="catjava">Cat.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Pet</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A Cat!"</span><span class="o">;}}</span>
</code></pre>
</div>
<h5 id="exercise1java">Exercise1.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise1</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t3</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Exercise1</span><span class="o">(</span><span class="n">T</span> <span class="n">one</span><span class="o">,</span><span class="n">T</span> <span class="n">two</span><span class="o">,</span><span class="n">T</span> <span class="n">three</span><span class="o">){</span><span class="n">t1</span><span class="o">=</span><span class="n">one</span><span class="o">;</span><span class="n">t2</span><span class="o">=</span><span class="n">two</span><span class="o">;</span><span class="n">t3</span><span class="o">=</span><span class="n">three</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">get</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">t1</span><span class="o">,</span><span class="n">t2</span><span class="o">,</span><span class="n">t3</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">t1</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">"],"</span><span class="o">+</span><span class="s">"["</span><span class="o">+</span><span class="n">t2</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">"],"</span><span class="o">+</span><span class="s">"["</span><span class="o">+</span><span class="n">t3</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">"]"</span><span class="o">;}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Pet</span> <span class="n">p</span><span class="o">=</span><span class="k">new</span> <span class="n">Pet</span><span class="o">();</span>
        <span class="n">Dog</span> <span class="n">d</span><span class="o">=</span><span class="k">new</span> <span class="n">Dog</span><span class="o">();</span>
        <span class="n">Cat</span> <span class="n">c</span><span class="o">=</span><span class="k">new</span> <span class="n">Cat</span><span class="o">();</span>
        <span class="n">Exercise1</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;</span> <span class="n">h</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise1</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;(</span><span class="n">p</span><span class="o">,</span><span class="n">d</span><span class="o">,</span><span class="n">c</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;</span> <span class="n">l</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="o">.</span><span class="na">size</span><span class="o">();</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-2">Exercise 2</h4>
<ul>
  <li><strong>Exercise 2</strong>: (1) Create a holder class that holds three objects of the same type, along with the methods to store and fetch those objects and a constructor to initialize all three.</li>
</ul>

<h5 id="petjava-1">Pet.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Pet</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A Pet!"</span><span class="o">;}}</span>
</code></pre>
</div>
<h5 id="dogjava-1">Dog.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Pet</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A Dog!"</span><span class="o">;}}</span>
</code></pre>
</div>
<h5 id="catjava-1">Cat.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Pet</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A Cat!"</span><span class="o">;}}</span>
</code></pre>
</div>
<h5 id="exercise2java">Exercise2.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise2</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>

    <span class="kd">private</span> <span class="n">T</span> <span class="n">t1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t3</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Exercise2</span><span class="o">(</span><span class="n">T</span> <span class="n">one</span><span class="o">,</span><span class="n">T</span> <span class="n">two</span><span class="o">,</span><span class="n">T</span> <span class="n">three</span><span class="o">){</span><span class="n">t1</span><span class="o">=</span><span class="n">one</span><span class="o">;</span><span class="n">t2</span><span class="o">=</span><span class="n">two</span><span class="o">;</span><span class="n">t3</span><span class="o">=</span><span class="n">three</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">get</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">t1</span><span class="o">,</span><span class="n">t2</span><span class="o">,</span><span class="n">t3</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">t1</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">"],"</span><span class="o">+</span><span class="s">"["</span><span class="o">+</span><span class="n">t2</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">"],"</span><span class="o">+</span><span class="s">"["</span><span class="o">+</span><span class="n">t3</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">"]"</span><span class="o">;}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Pet</span> <span class="n">p</span><span class="o">=</span><span class="k">new</span> <span class="n">Pet</span><span class="o">();</span>
        <span class="n">Dog</span> <span class="n">d</span><span class="o">=</span><span class="k">new</span> <span class="n">Dog</span><span class="o">();</span>
        <span class="n">Cat</span> <span class="n">c</span><span class="o">=</span><span class="k">new</span> <span class="n">Cat</span><span class="o">();</span>
        <span class="n">Exercise2</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;</span> <span class="n">h</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise2</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;(</span><span class="n">p</span><span class="o">,</span><span class="n">d</span><span class="o">,</span><span class="n">c</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;</span> <span class="n">l</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">l</span><span class="o">.</span><span class="na">size</span><span class="o">();</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-3">Exercise 3</h4>
<ul>
  <li><strong>Exercise 3</strong> : (1) Create and test a SixTuple generic.
```java
package com.ciaoshen.thinkinjava.chapter15;
import java.util.*;</li>
</ul>

<p>class Exercise3&lt;A,B,C,D,E,F&gt;{
    A a; B b; C c; D d; E e; F f;</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public Exercise3(A inA,B inB,C inC,D inD,E inE,F inF){a=inA;b=inB;c=inC;d=inD;e=inE;f=inF;}

public String toString(){return a.toString()+b.toString()+c.toString()+d.toString()+e.toString()+f.toString();}

public static void main(String[] args){
    Exercise3&lt;Integer,Long,Float,Double,String,Boolean&gt; mySix=new Exercise3&lt;Integer,Long,Float,Double,String,Boolean&gt;(1,2l,3f,4d,"five",true);
    System.out.println(mySix.toString());
} } ```
</code></pre>
</div>

<h4 id="exercise-4">Exercise 4</h4>
<ul>
  <li><strong>Exercise 4</strong>: (3) “Generify” innerclasses/Sequence.java.</li>
</ul>

<h5 id="selectorjava">Selector.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Selector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">end</span><span class="o">();</span>
    <span class="n">T</span> <span class="nf">current</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise4java">Exercise4.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise4</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">items</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Exercise4</span><span class="o">()</span> <span class="o">{</span> <span class="n">items</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">items</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span>
        <span class="n">String</span> <span class="n">r</span><span class="o">=</span><span class="s">""</span><span class="o">;</span>
        <span class="k">for</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span> <span class="o">:</span> <span class="n">items</span><span class="o">){</span>
            <span class="n">r</span><span class="o">+=</span><span class="n">item</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SequenceSelector</span> <span class="kd">implements</span> <span class="n">Selector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">i</span> <span class="o">==</span> <span class="n">items</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="n">T</span> <span class="nf">current</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">if</span><span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">size</span><span class="o">()){</span><span class="n">i</span><span class="o">++;}</span> <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Selector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">selector</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">SequenceSelector</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise4</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">sequence</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise4</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">sequence</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sequence</span><span class="o">);</span>

        <span class="n">Selector</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">sequence</span><span class="o">.</span><span class="na">selector</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(!</span><span class="n">selector</span><span class="o">.</span><span class="na">end</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">current</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
            <span class="n">selector</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-5">Exercise 5</h4>
<ul>
  <li><strong>Exercise 5</strong>: (2) Remove the type parameter on the Node class and modify the rest of the code in LinkedStack.java to show that an inner class has access to the generic type parameters of its outer class.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise5</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="n">T</span> <span class="n">item</span><span class="o">;</span>
        <span class="n">Node</span> <span class="n">next</span><span class="o">;</span>
        <span class="n">Node</span><span class="o">()</span> <span class="o">{</span> <span class="n">item</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="n">next</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="o">}</span>
        <span class="n">Node</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">,</span> <span class="n">Node</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">item</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">next</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span> <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">Node</span> <span class="n">top</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">();</span> <span class="c1">// End sentinel</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">top</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Node</span><span class="o">(</span><span class="n">item</span><span class="o">,</span> <span class="n">top</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">T</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">T</span> <span class="n">result</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="na">item</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(!</span><span class="n">top</span><span class="o">.</span><span class="na">end</span><span class="o">())</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">top</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise5</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">test</span><span class="o">=</span> <span class="k">new</span> <span class="n">Exercise5</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="s">"Phasers on stun!"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">)){</span>
            <span class="n">test</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">s</span><span class="o">;</span>
        <span class="k">while</span><span class="o">((</span><span class="n">s</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="na">pop</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-6">Exercise 6</h4>
<ul>
  <li><strong>Exercise 6</strong>: (1) Use RandomList with two more types in addition to the one shown in main( ).</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise6</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
    <span class="kd">private</span> <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="n">storage</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">select</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">storage</span><span class="o">.</span><span class="na">size</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise6</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">rs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Exercise6</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">Exercise6</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ri</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise6</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">Exercise6</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;</span> <span class="n">rf</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise6</span><span class="o">&lt;</span><span class="n">Float</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="nl">s:</span> <span class="o">(</span><span class="s">"The quick brown fox jumped over "</span> <span class="o">+</span> <span class="s">"the lazy brown dog"</span><span class="o">).</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">)){</span>
            <span class="n">rs</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">11</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">select</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">ri</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">rf</span><span class="o">.</span><span class="na">add</span><span class="o">((</span><span class="kt">float</span><span class="o">)</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ri</span><span class="o">.</span><span class="na">select</span><span class="o">());</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rf</span><span class="o">.</span><span class="na">select</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-7">Exercise 7</h4>
<ul>
  <li><strong>Exercise 7</strong>: (2) Use composition instead of inheritance to adapt Fibonacci to make it Iterable.</li>
</ul>

<p>这题的关键在于实现两个接口。外部类IterableFibonacci实现Iterable<Integer>接口，内部类FibIte实现Iterator<Integer>接口。</Integer></Integer></p>

<h5 id="fibonaccijava">Fibonacci.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Fibonacci</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">fib</span><span class="o">(</span><span class="n">count</span><span class="o">++);</span> <span class="o">}</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">fib</span><span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span> <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">return</span> <span class="nf">fib</span><span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="o">)</span> <span class="o">+</span> <span class="n">fib</span><span class="o">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise7java">Exercise7.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise7</span> <span class="kd">extends</span> <span class="n">Fibonacci</span> <span class="kd">implements</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">n</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Exercise7</span><span class="o">(</span><span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span> <span class="n">n</span> <span class="o">=</span> <span class="n">count</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">(){</span><span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">new</span> <span class="n">FibIte</span><span class="o">();}</span>

    <span class="kd">class</span> <span class="nc">FibIte</span> <span class="kd">implements</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">;</span> <span class="o">}</span>
        <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">n</span><span class="o">--;</span>
            <span class="k">return</span> <span class="n">Exercise7</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// Not implemented</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise7</span> <span class="n">iteFib</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise7</span><span class="o">(</span><span class="mi">18</span><span class="o">);</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ite</span><span class="o">=</span><span class="n">iteFib</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">()+</span><span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-8">Exercise 8</h4>
<ul>
  <li><strong>Exercise 8</strong>: (2) Following the form of the Coffee example, create a hierarchy of StoryCharacters from your favorite movie, dividing them into GoodGuys and BadGuys. Create a generator for StoryCharacters, following the form of CoffeeGenerator.</li>
</ul>

<h5 id="generatorjava">Generator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="goodguysjava">GoodGuys.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GoodGuys</span> <span class="kd">extends</span> <span class="n">StoryCharacters</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">GoodGuys</span><span class="o">(){</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"Good "</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">()));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="badguysjava">BadGuys.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BadGuys</span> <span class="kd">extends</span> <span class="n">StoryCharacters</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">BadGuys</span><span class="o">(){</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"Bad "</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">nanoTime</span><span class="o">()));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="storycharactersjava">StoryCharacters.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">StoryCharacters</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">StoryCharacters</span><span class="o">(</span><span class="n">String</span> <span class="n">inName</span><span class="o">){</span><span class="n">name</span><span class="o">=</span><span class="n">inName</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">name</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise8java">Exercise8.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise8</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">StoryCharacters</span><span class="o">&gt;,</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">StoryCharacters</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">StoryCharacters</span><span class="o">&gt;&gt;</span> <span class="n">factories</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">StoryCharacters</span><span class="o">&gt;&gt;();</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="kd">static</span><span class="o">{</span>
        <span class="n">factories</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">GoodGuys</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">factories</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">BadGuys</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">max</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Exercise8</span><span class="o">(</span><span class="kt">int</span> <span class="n">inNum</span><span class="o">){</span><span class="n">max</span><span class="o">=</span><span class="n">inNum</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">StoryCharacters</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">(){</span><span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">new</span> <span class="n">ChIte</span><span class="o">(</span><span class="n">max</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="n">StoryCharacters</span> <span class="nf">next</span><span class="o">(){</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="k">return</span> <span class="o">(</span><span class="n">StoryCharacters</span><span class="o">)(</span><span class="n">factories</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">factories</span><span class="o">.</span><span class="na">size</span><span class="o">())).</span><span class="na">newInstance</span><span class="o">());</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Cannot make the new instance of StoryCharacters!"</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">class</span> <span class="nc">ChIte</span> <span class="kd">implements</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">StoryCharacters</span><span class="o">&gt;{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">n</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">ChIte</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">){</span><span class="n">n</span><span class="o">=</span><span class="n">num</span><span class="o">;}</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">(){</span><span class="k">return</span> <span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">;}</span>
        <span class="kd">public</span> <span class="n">StoryCharacters</span> <span class="nf">next</span><span class="o">(){</span>
            <span class="n">n</span><span class="o">--;</span>
            <span class="k">return</span> <span class="n">Exercise8</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">remove</span><span class="o">(){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise8</span> <span class="n">test</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise8</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">StoryCharacters</span><span class="o">&gt;</span> <span class="n">ite</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ite</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-9">Exercise 9</h4>
<ul>
  <li><strong>Exercise 9</strong>: (1) Modify GenericMethods.java so that f( ) accepts three arguments, all of which are of a different parameterized type.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise9</span><span class="o">{</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">U</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">,</span> <span class="n">U</span> <span class="n">u</span><span class="o">,</span> <span class="n">V</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">u</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise9</span> <span class="n">test</span><span class="o">=</span> <span class="k">new</span> <span class="n">Exercise9</span><span class="o">();</span>
        <span class="n">test</span><span class="o">.</span><span class="na">f</span><span class="o">(</span><span class="s">""</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mf">1.0</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-10">Exercise 10</h4>
<ul>
  <li><strong>Exercise 10</strong>: (1) Modify the previous exercise so that one of f( )’s arguments is non-parameterized.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise10</span><span class="o">{</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">U</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">,</span> <span class="n">U</span> <span class="n">u</span><span class="o">,</span> <span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">u</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise10</span> <span class="n">test</span><span class="o">=</span> <span class="k">new</span> <span class="n">Exercise10</span><span class="o">();</span>
        <span class="n">test</span><span class="o">.</span><span class="na">f</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mf">1.0</span><span class="o">,</span><span class="s">"2.0"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-11">Exercise 11</h4>
<ul>
  <li><strong>Exercise 11</strong>: (1) Test New.java by creating your own classes and ensuring that New will work properly with them.</li>
</ul>

<h5 id="genericonejava">GenericOne.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericOne</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">GenericOne</span><span class="o">(</span><span class="n">T</span> <span class="n">inT</span><span class="o">){</span><span class="n">t</span><span class="o">=</span><span class="n">inT</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">": "</span><span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise11java">Exercise11.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise11</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">getOne</span><span class="o">(</span><span class="n">T</span> <span class="n">inT</span><span class="o">){</span><span class="k">return</span> <span class="k">new</span> <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">inT</span><span class="o">);}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">go</span><span class="o">=</span> <span class="n">Exercise11</span><span class="o">.</span><span class="na">getOne</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">go</span><span class="o">);</span>
        <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">Exercise11</span><span class="o">.</span><span class="na">getOne</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gi</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-12">Exercise 12</h4>
<ul>
  <li><strong>Exercise 12</strong>: (1) Repeat the previous exercise using explicit type specification.</li>
</ul>

<h5 id="genericonejava-1">GenericOne.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericOne</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">t</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">GenericOne</span><span class="o">(</span><span class="n">T</span> <span class="n">inT</span><span class="o">){</span><span class="n">t</span><span class="o">=</span><span class="n">inT</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="na">toString</span><span class="o">()+</span><span class="s">": "</span><span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getName</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise12java">Exercise12.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise12</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">getOne</span><span class="o">(</span><span class="n">T</span> <span class="n">inT</span><span class="o">){</span><span class="k">return</span> <span class="k">new</span> <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">inT</span><span class="o">);}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">go</span><span class="o">=</span> <span class="n">Exercise12</span><span class="o">.&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="n">getOne</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">go</span><span class="o">);</span>
        <span class="n">GenericOne</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">gi</span> <span class="o">=</span> <span class="n">Exercise12</span><span class="o">.&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="n">getOne</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gi</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-13">Exercise 13</h4>
<ul>
  <li><strong>Exercise 13</strong>: (4) Overload the fill( ) method so that the arguments and return types are the specific subtypes of Collection: List, Queue and Set. This way, you don’t lose the type of container. Can you overload to distinguish between List and LinkedList?</li>
</ul>

<h5 id="generatorjava-1">Generator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="coffeejava">Coffee.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Coffee</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">count</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Coffee</span><span class="o">(){</span><span class="n">id</span><span class="o">=</span><span class="n">count</span><span class="o">++;}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">showId</span><span class="o">(){</span><span class="k">return</span> <span class="n">id</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="lattejava">Latte.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Latte</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"No."</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">showId</span><span class="o">())+</span><span class="s">"&gt;&gt;&gt; I am Latte!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="mochajava">Mocha.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Mocha</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"No."</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">showId</span><span class="o">())+</span><span class="s">"&gt;&gt;&gt; I am Mocha!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="capuccinojava">Capuccino.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Capuccino</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"No."</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">showId</span><span class="o">())+</span><span class="s">"&gt;&gt;&gt; I am Capuccino!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="coffeegneratorjava">CoffeeGnerator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CoffeeGenerator</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Coffee</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">&gt;&gt;</span> <span class="n">c</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">&gt;&gt;();</span>
    <span class="kd">static</span><span class="o">{</span>
        <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Latte</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Mocha</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Capuccino</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="kd">public</span> <span class="n">Coffee</span> <span class="nf">next</span><span class="o">(){</span>
        <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">newInstance</span><span class="o">();</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise13java">Exercise13.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise13</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">fill</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">coll</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">coll</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">coll</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">fill</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">fill</span><span class="o">(</span><span class="n">Queue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">queue</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">queue</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">queue</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">fill</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">set</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">n</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">set</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">set</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Coffee</span><span class="o">&gt;</span> <span class="n">manyCoffee</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Coffee</span><span class="o">&gt;();</span>
        <span class="n">manyCoffee</span><span class="o">=</span><span class="n">Exercise13</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">manyCoffee</span><span class="o">,</span> <span class="k">new</span> <span class="n">CoffeeGenerator</span><span class="o">(),</span> <span class="mi">10</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Coffee</span> <span class="n">cup</span> <span class="o">:</span> <span class="n">manyCoffee</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cup</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-14">Exercise 14</h4>
<ul>
  <li><strong>Exercise 14</strong>: (1) Modify BasicGeneratorDemo.java to use the explicit form of creation for the Generator (that is, use the explicit constructor instead of the generic create( ) method).</li>
</ul>

<h5 id="generatorjava-2">Generator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="countedobjectjava">CountedObject.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CountedObject</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">counter</span><span class="o">++;</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">id</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">id</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">"CountedObject "</span> <span class="o">+</span> <span class="n">id</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="basicgeneratorjava">BasicGenerator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BasicGenerator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">BasicGenerator</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">){</span> <span class="k">this</span><span class="o">.</span><span class="na">type</span> <span class="o">=</span> <span class="n">type</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// Assumes type is a public class:</span>
            <span class="k">return</span> <span class="n">type</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="c1">// Produce a Default generator given a type token:</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">create</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">BasicGenerator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">type</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise14java">Exercise14.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise14</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">BasicGenerator</span><span class="o">&lt;</span><span class="n">CountedObject</span><span class="o">&gt;</span> <span class="n">bg</span><span class="o">=</span><span class="k">new</span> <span class="n">BasicGenerator</span><span class="o">&lt;</span><span class="n">CountedObject</span><span class="o">&gt;(</span><span class="n">CountedObject</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">bg</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-15">Exercise 15</h4>
<ul>
  <li><strong>Exercise 15</strong>: (1) Verify the previous statement.</li>
</ul>

<h5 id="twotuplejava">TwoTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">TwoTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="threetuplejava">ThreeTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreeTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">ThreeTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="fourtuplejava">FourTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FourTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">D</span> <span class="n">fourth</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FourTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">,</span><span class="n">D</span> <span class="n">d</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;</span><span class="n">fourth</span><span class="o">=</span><span class="n">d</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fourth</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="fivetuplejava">FiveTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FiveTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">D</span> <span class="n">fourth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">E</span> <span class="n">fifth</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FiveTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">,</span><span class="n">D</span> <span class="n">d</span><span class="o">,</span><span class="n">E</span> <span class="n">e</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;</span><span class="n">fourth</span><span class="o">=</span><span class="n">d</span><span class="o">;</span><span class="n">fifth</span><span class="o">=</span><span class="n">e</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fourth</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fifth</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="sixtuplejava">SixTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SixTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">D</span> <span class="n">fourth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">E</span> <span class="n">fifth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">F</span> <span class="n">sixth</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FiveTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">,</span><span class="n">D</span> <span class="n">d</span><span class="o">,</span><span class="n">E</span> <span class="n">e</span><span class="o">,</span><span class="n">F</span> <span class="n">f</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;</span><span class="n">fourth</span><span class="o">=</span><span class="n">d</span><span class="o">;</span><span class="n">fifth</span><span class="o">=</span><span class="n">e</span><span class="o">;</span><span class="n">sixth</span><span class="o">=</span><span class="n">f</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fourth</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fifth</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">sixth</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="tuplejava">Tuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tuple</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;</span> <span class="n">ThreeTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ThreeTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;</span> <span class="n">FourTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">,</span> <span class="n">D</span> <span class="n">d</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">FourTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">FiveTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">,</span> <span class="n">D</span> <span class="n">d</span><span class="o">,</span> <span class="n">E</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">FiveTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;</span> <span class="n">SixTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">,</span> <span class="n">D</span> <span class="n">d</span><span class="o">,</span> <span class="n">E</span> <span class="n">e</span><span class="o">,</span> <span class="n">F</span> <span class="n">f</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">SixTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">,</span> <span class="n">f</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise15java">Exercise15.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise15</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"rawtypes"</span><span class="o">)</span>
        <span class="n">TwoTuple</span> <span class="n">tuple</span><span class="o">=</span><span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="s">"ABC"</span><span class="o">,</span><span class="mi">123</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">tuple</span><span class="o">);</span>
        <span class="c1">//@SuppressWarnings("unchecked")    //不加注释就会报unchecked警告</span>
        <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">withType</span><span class="o">=</span><span class="n">tuple</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">withType</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-16">Exercise 16</h4>
<ul>
  <li><strong>Exercise 16</strong>: (2) Add a SixTuple to Tuple.java, and test it in TupleTest2.java.</li>
</ul>

<h5 id="twotuplejava-1">TwoTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">TwoTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="threetuplejava-1">ThreeTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreeTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">ThreeTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="fourtuplejava-1">FourTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FourTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">D</span> <span class="n">fourth</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FourTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">,</span><span class="n">D</span> <span class="n">d</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;</span><span class="n">fourth</span><span class="o">=</span><span class="n">d</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fourth</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="fivetuplejava-1">FiveTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FiveTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">D</span> <span class="n">fourth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">E</span> <span class="n">fifth</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FiveTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">,</span><span class="n">D</span> <span class="n">d</span><span class="o">,</span><span class="n">E</span> <span class="n">e</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;</span><span class="n">fourth</span><span class="o">=</span><span class="n">d</span><span class="o">;</span><span class="n">fifth</span><span class="o">=</span><span class="n">e</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fourth</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fifth</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="sixtuplejava-1">SixTuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SixTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">C</span> <span class="n">third</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">D</span> <span class="n">fourth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">E</span> <span class="n">fifth</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">F</span> <span class="n">sixth</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FiveTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span><span class="n">B</span> <span class="n">b</span><span class="o">,</span><span class="n">C</span> <span class="n">c</span><span class="o">,</span><span class="n">D</span> <span class="n">d</span><span class="o">,</span><span class="n">E</span> <span class="n">e</span><span class="o">,</span><span class="n">F</span> <span class="n">f</span><span class="o">){</span><span class="n">first</span><span class="o">=</span><span class="n">a</span><span class="o">;</span><span class="n">second</span><span class="o">=</span><span class="n">b</span><span class="o">;</span><span class="n">third</span><span class="o">=</span><span class="n">c</span><span class="o">;</span><span class="n">fourth</span><span class="o">=</span><span class="n">d</span><span class="o">;</span><span class="n">fifth</span><span class="o">=</span><span class="n">e</span><span class="o">;</span><span class="n">sixth</span><span class="o">=</span><span class="n">f</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"["</span><span class="o">+</span><span class="n">first</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">second</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">third</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fourth</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">fifth</span><span class="o">+</span><span class="s">","</span><span class="o">+</span><span class="n">sixth</span><span class="o">+</span><span class="s">"]"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="tuplejava-1">Tuple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tuple</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;</span> <span class="n">ThreeTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ThreeTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;</span> <span class="n">FourTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">,</span> <span class="n">D</span> <span class="n">d</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">FourTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">FiveTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">,</span> <span class="n">D</span> <span class="n">d</span><span class="o">,</span> <span class="n">E</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">FiveTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;</span> <span class="n">SixTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">,</span> <span class="n">C</span> <span class="n">c</span><span class="o">,</span> <span class="n">D</span> <span class="n">d</span><span class="o">,</span> <span class="n">E</span> <span class="n">e</span><span class="o">,</span> <span class="n">F</span> <span class="n">f</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">SixTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">,</span><span class="n">C</span><span class="o">,</span><span class="n">D</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">,</span> <span class="n">e</span><span class="o">,</span> <span class="n">f</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="vehiclejava">Vehicle.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Vehicle</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">=++</span><span class="n">count</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Vehicle#"</span><span class="o">+</span><span class="n">id</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="amphibianjava">Amphibian.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Amphibian</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">=++</span><span class="n">count</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Amphibian#"</span><span class="o">+</span><span class="n">id</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise16java">Exercise16.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise16</span><span class="o">{</span>
    <span class="kd">static</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">f</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="s">"hi"</span><span class="o">,</span> <span class="mi">47</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"rawtypes"</span><span class="o">)</span>
    <span class="kd">static</span> <span class="n">TwoTuple</span> <span class="nf">f2</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="s">"hi"</span><span class="o">,</span> <span class="mi">47</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">static</span> <span class="n">ThreeTuple</span><span class="o">&lt;</span><span class="n">Amphibian</span><span class="o">,</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">g</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">Amphibian</span><span class="o">(),</span> <span class="s">"hi"</span><span class="o">,</span> <span class="mi">47</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">static</span> <span class="n">FourTuple</span><span class="o">&lt;</span><span class="n">Vehicle</span><span class="o">,</span><span class="n">Amphibian</span><span class="o">,</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">h</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">Vehicle</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Amphibian</span><span class="o">(),</span> <span class="s">"hi"</span><span class="o">,</span> <span class="mi">47</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">static</span> <span class="n">FiveTuple</span><span class="o">&lt;</span><span class="n">Vehicle</span><span class="o">,</span><span class="n">Amphibian</span><span class="o">,</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">,</span><span class="n">Double</span><span class="o">&gt;</span> <span class="nf">k</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">Vehicle</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Amphibian</span><span class="o">(),</span> <span class="s">"hi"</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mf">11.1</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">static</span> <span class="n">SixTuple</span><span class="o">&lt;</span><span class="n">Vehicle</span><span class="o">,</span><span class="n">Amphibian</span><span class="o">,</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">,</span><span class="n">Double</span><span class="o">,</span><span class="n">Float</span><span class="o">&gt;</span> <span class="nf">l</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">Vehicle</span><span class="o">(),</span> <span class="k">new</span> <span class="n">Amphibian</span><span class="o">(),</span> <span class="s">"hi"</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mf">11.1</span><span class="o">,</span><span class="mf">22.2f</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ttsi</span> <span class="o">=</span> <span class="n">f</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ttsi</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f2</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">g</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">h</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">k</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">l</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-17">Exercise 17</h4>
<ul>
  <li><strong>Exercise 17</strong>: (4) Study the JDK documentation for EnumSet. You’ll see that there’s a clone( ) method defined. However, you cannot clone( ) from the reference to the Set interface passed in Sets.java. Can you modify Sets.java to handle both the general case of a Set interface as shown, and the special case of an EnumSet, using clone( ) instead of creating a new HashSet?</li>
</ul>

<p>这道题关键是练习泛型方法怎么声明：</p>
<blockquote>
  <p>**public static &lt;T extends Enum<T>&gt; EnumSet<T> union(EnumSet<T> a, EnumSet<T> b) {... ...}**</T></T></T></T></p>
</blockquote>

<p><strong>注意！</strong> 在函数的参数以及返回值的地方直接用泛型替换符T来表示，但是在最前面参数列表的地方，要定义参数T的具体边界。</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise17</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">enum</span> <span class="n">Watercolors</span> <span class="o">{</span> <span class="n">ZINC</span><span class="o">,</span> <span class="n">LEMON_YELLOW</span><span class="o">,</span> <span class="n">MEDIUM_YELLOW</span><span class="o">,</span> <span class="n">DEEP_YELLOW</span><span class="o">,</span> <span class="n">ORANGE</span><span class="o">,</span> <span class="n">BRILLIANT_RED</span><span class="o">,</span> <span class="n">CRIMSON</span><span class="o">,</span> <span class="n">MAGENTA</span><span class="o">,</span> <span class="n">ROSE_MADDER</span><span class="o">,</span> <span class="n">VIOLET</span><span class="o">,</span> <span class="n">CERULEAN_BLUE_HUE</span><span class="o">,</span> <span class="n">PHTHALO_BLUE</span><span class="o">,</span> <span class="n">ULTRAMARINE</span><span class="o">,</span> <span class="n">COBALT_BLUE_HUE</span><span class="o">,</span> <span class="n">PERMANENT_GREEN</span><span class="o">,</span> <span class="n">VIRIDIAN_HUE</span><span class="o">,</span> <span class="n">SAP_GREEN</span><span class="o">,</span> <span class="n">YELLOW_OCHRE</span><span class="o">,</span> <span class="n">BURNT_SIENNA</span><span class="o">,</span> <span class="n">RAW_UMBER</span><span class="o">,</span> <span class="n">BURNT_UMBER</span><span class="o">,</span> <span class="n">PAYNES_GRAY</span><span class="o">,</span> <span class="n">IVORY_BLACK</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Enum</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">union</span><span class="o">(</span><span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">,</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
        <span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Enum</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">intersection</span><span class="o">(</span><span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">,</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
        <span class="n">result</span><span class="o">.</span><span class="na">retainAll</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Enum</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">difference</span><span class="o">(</span><span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">superset</span><span class="o">,</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">subset</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">superset</span><span class="o">.</span><span class="na">clone</span><span class="o">();</span>
        <span class="n">result</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">subset</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Enum</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">complement</span><span class="o">(</span><span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">,</span> <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">difference</span><span class="o">(</span><span class="n">union</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">),</span> <span class="n">intersection</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">set1</span><span class="o">=</span><span class="n">EnumSet</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="n">Watercolors</span><span class="o">.</span><span class="na">MEDIUM_YELLOW</span><span class="o">,</span> <span class="n">Watercolors</span><span class="o">.</span><span class="na">MAGENTA</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">set2</span><span class="o">=</span><span class="n">EnumSet</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="n">Watercolors</span><span class="o">.</span><span class="na">ZINC</span><span class="o">,</span><span class="n">Watercolors</span><span class="o">.</span><span class="na">ORANGE</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">setUnion</span><span class="o">=</span><span class="n">Sets</span><span class="o">.</span><span class="na">union</span><span class="o">(</span><span class="n">set1</span><span class="o">,</span><span class="n">set2</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">setIntersection</span><span class="o">=</span><span class="n">Sets</span><span class="o">.</span><span class="na">intersection</span><span class="o">(</span><span class="n">set1</span><span class="o">,</span><span class="n">set2</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">setComplement</span><span class="o">=</span><span class="n">Sets</span><span class="o">.</span><span class="na">complement</span><span class="o">(</span><span class="n">set1</span><span class="o">,</span><span class="n">set2</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">superset</span><span class="o">=</span><span class="n">EnumSet</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="n">Watercolors</span><span class="o">.</span><span class="na">ZINC</span><span class="o">,</span><span class="n">Watercolors</span><span class="o">.</span><span class="na">PERMANENT_GREEN</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">subset</span><span class="o">=</span><span class="n">EnumSet</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="n">Watercolors</span><span class="o">.</span><span class="na">CRIMSON</span><span class="o">,</span> <span class="n">Watercolors</span><span class="o">.</span><span class="na">ULTRAMARINE</span><span class="o">);</span>
        <span class="n">EnumSet</span><span class="o">&lt;</span><span class="n">Watercolors</span><span class="o">&gt;</span> <span class="n">setDifference</span><span class="o">=</span><span class="n">Sets</span><span class="o">.</span><span class="na">difference</span><span class="o">(</span><span class="n">superset</span><span class="o">,</span><span class="n">subset</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n Set Union &gt;&gt;&gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Watercolors</span> <span class="n">w</span> <span class="o">:</span> <span class="n">setUnion</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">w</span><span class="o">+</span><span class="s">"    "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n Set Intersection &gt;&gt;&gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Watercolors</span> <span class="n">w</span> <span class="o">:</span> <span class="n">setIntersection</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">w</span><span class="o">+</span><span class="s">"    "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n Set Complement &gt;&gt;&gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Watercolors</span> <span class="n">w</span> <span class="o">:</span> <span class="n">setComplement</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">w</span><span class="o">+</span><span class="s">"    "</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"\n Set Difference &gt;&gt;&gt;&gt;&gt;"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Watercolors</span> <span class="n">w</span> <span class="o">:</span> <span class="n">setDifference</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">w</span><span class="o">+</span><span class="s">"    "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-18">Exercise 18</h4>
<ul>
  <li><strong>Exercise 18</strong>: (3) Following the form of BankTeller.java, create an example where BigFish eat LittleFish in the Ocean.</li>
</ul>

<h5 id="generatorjava-3">Generator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span><span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();}</span>
</code></pre>
</div>

<h5 id="smallfishjava">SmallFish.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SmallFish</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span><span class="o">=</span><span class="n">counter</span><span class="o">++;</span>
    <span class="kd">private</span> <span class="nf">SmallFish</span><span class="o">(){}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Small Fish No."</span><span class="o">+</span><span class="n">id</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">SmallFish</span><span class="o">&gt;</span> <span class="nf">generator</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">SmallFish</span><span class="o">&gt;(){</span>
            <span class="kd">public</span> <span class="n">SmallFish</span> <span class="nf">next</span><span class="o">(){</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nf">SmallFish</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="bigfishjava">BigFish.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BigFish</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span><span class="o">=</span><span class="n">counter</span><span class="o">++;</span>
    <span class="kd">private</span> <span class="nf">BigFish</span><span class="o">(){}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"Big Fish No."</span><span class="o">+</span><span class="n">id</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">BigFish</span><span class="o">&gt;</span> <span class="nf">generator</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">BigFish</span><span class="o">&gt;(){</span>
            <span class="kd">public</span> <span class="n">BigFish</span> <span class="nf">next</span><span class="o">(){</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nf">BigFish</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise18java">Exercise18.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise18</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">eat</span><span class="o">(</span><span class="n">BigFish</span> <span class="n">bf</span><span class="o">,</span> <span class="n">SmallFish</span> <span class="n">sf</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">bf</span><span class="o">+</span><span class="s">" EAT "</span><span class="o">+</span><span class="n">sf</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="n">Queue</span><span class="o">&lt;</span><span class="n">SmallFish</span><span class="o">&gt;</span> <span class="n">foods</span><span class="o">=</span><span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">SmallFish</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">15</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">foods</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">SmallFish</span><span class="o">.</span><span class="na">generator</span><span class="o">().</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">BigFish</span><span class="o">&gt;</span> <span class="n">killers</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">BigFish</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">killers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">BigFish</span><span class="o">.</span><span class="na">generator</span><span class="o">().</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="n">SmallFish</span> <span class="nl">sf:</span><span class="n">foods</span><span class="o">){</span>
            <span class="n">Exercise18</span><span class="o">.</span><span class="na">eat</span><span class="o">(</span><span class="n">killers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">killers</span><span class="o">.</span><span class="na">size</span><span class="o">())),</span><span class="n">sf</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-19">Exercise 19</h4>
<ul>
  <li><strong>Exercise 19</strong>: (2) Following the form of Store.java, build a model of a containerized cargo ship.</li>
</ul>

<h5 id="generatorjava-4">Generator.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span><span class="kd">public</span> <span class="n">T</span> <span class="nf">next</span><span class="o">();}</span>
</code></pre>
</div>

<h5 id="generatorsjava">Generators.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Generators</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">fill</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">,</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">gen</span><span class="o">,</span> <span class="kt">int</span> <span class="n">num</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">gen</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="productjava">Product.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Product</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span><span class="o">=++</span><span class="n">count</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">price</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Product</span><span class="o">(</span><span class="kt">double</span> <span class="n">price</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">price</span> <span class="o">=</span> <span class="n">price</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"        Product No."</span><span class="o">+</span><span class="n">id</span> <span class="o">+</span> <span class="s">" &gt;&gt;&gt; "</span> <span class="o">+</span> <span class="s">"price: $"</span> <span class="o">+</span> <span class="n">price</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;</span> <span class="n">generator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">Random</span> <span class="n">rand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kd">public</span> <span class="n">Product</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Product</span><span class="o">(</span> <span class="n">Math</span><span class="o">.</span><span class="na">round</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">()</span> <span class="o">*</span> <span class="mf">1000.0</span><span class="o">)</span> <span class="o">+</span> <span class="mf">0.99</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="containerjava">Container.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Container</span> <span class="kd">extends</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Product</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_SIZE</span><span class="o">=</span><span class="mi">1000</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span><span class="o">=++</span><span class="n">count</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Container</span><span class="o">(</span><span class="kt">int</span> <span class="n">max</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="n">size</span><span class="o">=</span><span class="n">max</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fill</span><span class="o">(</span><span class="kt">int</span> <span class="n">numP</span><span class="o">){</span>
        <span class="n">Generators</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="k">this</span><span class="o">,</span><span class="n">Product</span><span class="o">.</span><span class="na">generator</span><span class="o">,</span><span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">size</span><span class="o">,</span><span class="n">numP</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span>
        <span class="n">StringBuilder</span> <span class="n">s</span><span class="o">=</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="n">s</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"    Container No."</span><span class="o">+</span><span class="n">id</span><span class="o">+</span><span class="s">"[Max Size: "</span><span class="o">+</span><span class="n">size</span><span class="o">+</span><span class="s">"] &gt;&gt;&gt; \n"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Product</span> <span class="nl">p:</span><span class="k">this</span><span class="o">){</span>
            <span class="n">s</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">p</span><span class="o">+</span><span class="s">"\n"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Container</span><span class="o">&gt;</span> <span class="n">generator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Container</span><span class="o">&gt;(){</span>
        <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kd">public</span> <span class="n">Container</span> <span class="nf">next</span><span class="o">(){</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Container</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX_SIZE</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="deckjava">Deck.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Deck</span> <span class="kd">extends</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Container</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_SIZE</span><span class="o">=</span><span class="mi">10000</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">id</span><span class="o">=++</span><span class="n">count</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nf">Deck</span><span class="o">(</span><span class="kt">int</span> <span class="n">max</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">();</span>
        <span class="n">size</span><span class="o">=</span><span class="n">max</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fill</span><span class="o">(</span><span class="kt">int</span> <span class="n">numC</span><span class="o">,</span> <span class="kt">int</span> <span class="n">numP</span><span class="o">){</span>
        <span class="n">Generators</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">Container</span><span class="o">.</span><span class="na">generator</span><span class="o">,</span> <span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">size</span><span class="o">,</span><span class="n">numC</span><span class="o">));</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Container</span> <span class="nl">c:</span><span class="k">this</span><span class="o">){</span>
            <span class="n">c</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">numP</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span>
        <span class="n">StringBuilder</span> <span class="n">s</span><span class="o">=</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="n">s</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Deck No."</span><span class="o">+</span><span class="n">id</span><span class="o">+</span><span class="s">"[Max Size: "</span><span class="o">+</span><span class="n">size</span><span class="o">+</span><span class="s">"] &gt;&gt;&gt; \n"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Container</span> <span class="nl">c:</span><span class="k">this</span><span class="o">){</span>
            <span class="n">s</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">c</span><span class="o">+</span><span class="s">"\n"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Deck</span><span class="o">&gt;</span> <span class="n">generator</span><span class="o">=</span><span class="k">new</span> <span class="n">Generator</span><span class="o">&lt;</span><span class="n">Deck</span><span class="o">&gt;(){</span>
        <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kd">public</span> <span class="n">Deck</span> <span class="nf">next</span><span class="o">(){</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Deck</span><span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">MAX_SIZE</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">};</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="cargoshipjava">CargoShip.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CargoShip</span> <span class="kd">extends</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Deck</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">MAX_SIZE</span><span class="o">=</span><span class="mi">20</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CargoShip</span><span class="o">(</span><span class="kt">int</span> <span class="n">numD</span><span class="o">,</span> <span class="kt">int</span> <span class="n">numC</span><span class="o">,</span> <span class="kt">int</span> <span class="n">numP</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Generators</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="k">this</span><span class="o">,</span><span class="n">Deck</span><span class="o">.</span><span class="na">generator</span><span class="o">,</span><span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">numD</span><span class="o">,</span><span class="n">MAX_SIZE</span><span class="o">));</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Deck</span> <span class="nl">d:</span><span class="k">this</span><span class="o">){</span>
            <span class="n">d</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">numC</span><span class="o">,</span><span class="n">numP</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Deck</span> <span class="n">d</span> <span class="o">:</span> <span class="k">this</span><span class="o">){</span>
            <span class="n">result</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">d</span><span class="o">+</span><span class="s">"\n"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">CargoShip</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">5</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise19java">Exercise19.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise19</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="k">new</span> <span class="n">CargoShip</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-20">Exercise 20</h4>
<ul>
  <li><strong>Exercise 20</strong>: (1) Create an interface with two methods, and a class that implements that interface and adds another method. In another class, create a generic method with an argument type that is bounded by the interface, and show that the methods in the interface are callable inside this generic method. In main( ), pass an instance of the implementing class to the generic method.</li>
</ul>

<h5 id="ijava">I.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">I</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">b</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="impljava">Impl.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Impl</span> <span class="kd">implements</span> <span class="n">I</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">a</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am a()!"</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">b</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am b()!"</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">c</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am c()!"</span><span class="o">);}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise20java">Exercise20.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise20</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">I</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">generic</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span>
        <span class="n">t</span><span class="o">.</span><span class="na">a</span><span class="o">();</span>
        <span class="n">t</span><span class="o">.</span><span class="na">b</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Exercise20</span><span class="o">.</span><span class="na">generic</span><span class="o">(</span><span class="k">new</span> <span class="n">Impl</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-21">Exercise 21</h4>
<ul>
  <li><strong>Exercise 21</strong>: (4) Modify ClassTypeCapture.java by adding a Map&lt;String,Class<?>>, a method addType(String typename, Class<?> kind), and a method createNew(String typename). createNew( ) will either produce a new instance of the class associated with its argument string, or produce an error message.</li>
</ul>

<p>这题需要注意的是：Map&lt;String,Class<?>> typeMap=new HashMap<String,Class<?>&gt;(); 这样带通配符的赋值方法竟然可以。也就是Map里可以存不同泛型的Class对象。证明JAVA的泛型是编译时泛型，运行时擦除。</p>

<h5 id="buildingjava">Building.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Building</span> <span class="o">{</span><span class="kd">public</span> <span class="nf">Building</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am Building!"</span><span class="o">);}}</span>
</code></pre>
</div>

<h5 id="housejava">House.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">House</span> <span class="kd">extends</span> <span class="n">Building</span> <span class="o">{</span><span class="kd">public</span> <span class="nf">House</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am House!"</span><span class="o">);}}</span>
</code></pre>
</div>

<h5 id="classtypecapturejava">ClassTypeCapture.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClassTypeCapture</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Class</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">typeMap</span><span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Class</span><span class="o">&lt;?&gt;&gt;();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addType</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">value</span><span class="o">){</span>
        <span class="n">typeMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">createNew</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">){</span>
        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">c</span><span class="o">=</span><span class="n">typeMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="n">Object</span> <span class="n">o</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">o</span><span class="o">;</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise21java">Exercise21.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise21</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">ClassTypeCapture</span> <span class="n">ctc</span><span class="o">=</span><span class="k">new</span> <span class="n">ClassTypeCapture</span><span class="o">();</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">addType</span><span class="o">(</span><span class="s">"Building"</span><span class="o">,</span><span class="n">Building</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">addType</span><span class="o">(</span><span class="s">"House"</span><span class="o">,</span><span class="n">House</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">createNew</span><span class="o">(</span><span class="s">"Building"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-22">Exercise 22</h4>
<ul>
  <li><strong>Exercise 22</strong>: (6) Use a type tag along with reflection to create a method that uses the argument version of newInstance( ) to create an object of a class with a constructor that has arguments.</li>
</ul>

<h5 id="fruitjava">Fruit.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Fruit</span><span class="o">{</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">();}</span>
</code></pre>
</div>

<h5 id="applejava">Apple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Apple</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">color</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Apple</span><span class="o">(</span><span class="n">String</span> <span class="n">color</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">color</span><span class="o">=</span><span class="n">color</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A "</span><span class="o">+</span><span class="n">color</span><span class="o">+</span><span class="s">" Apple!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="bananajava">Banana.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Banana</span> <span class="kd">implements</span> <span class="n">Fruit</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">color</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Banana</span><span class="o">(</span><span class="n">String</span> <span class="n">color</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">color</span><span class="o">=</span><span class="n">color</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"A "</span><span class="o">+</span><span class="n">color</span><span class="o">+</span><span class="s">" Banana!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="factoryjava">Factory.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Factory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="n">T</span> <span class="nf">create</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="facapplejava">FacApple.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FacApple</span> <span class="kd">implements</span> <span class="n">Factory</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="n">Apple</span> <span class="nf">create</span><span class="o">(){</span>
        <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">c</span><span class="o">=</span><span class="k">new</span> <span class="n">String</span><span class="o">();</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">i</span><span class="o">){</span>
            <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                <span class="n">c</span><span class="o">=</span><span class="s">"Red"</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                <span class="n">c</span><span class="o">=</span><span class="s">"Green"</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="n">c</span><span class="o">=</span><span class="s">"Yellow"</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>

        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Apple</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="facbananajava">FacBanana.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FacBanana</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Fac</span> <span class="kd">implements</span> <span class="n">Factory</span><span class="o">&lt;</span><span class="n">Banana</span><span class="o">&gt;{</span>
        <span class="kd">public</span> <span class="n">Banana</span> <span class="nf">create</span><span class="o">(){</span>
            <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
            <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">c</span><span class="o">=</span><span class="k">new</span> <span class="n">String</span><span class="o">();</span>
            <span class="k">switch</span><span class="o">(</span><span class="n">i</span><span class="o">){</span>
                <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
                    <span class="n">c</span><span class="o">=</span><span class="s">"Green"</span><span class="o">;</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
                    <span class="n">c</span><span class="o">=</span><span class="s">"Yellow"</span><span class="o">;</span>
                    <span class="k">break</span><span class="o">;</span>

            <span class="o">}</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Banana</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="platejava">Plate.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Plate</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">F</span> <span class="kd">extends</span> <span class="n">Factory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">Plate</span><span class="o">(</span><span class="n">F</span> <span class="n">f</span><span class="o">){</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">create</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Factory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">f</span><span class="o">){</span><span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">create</span><span class="o">());}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">){</span><span class="k">return</span> <span class="o">(</span><span class="n">index</span><span class="o">&lt;</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">())?</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">):</span><span class="kc">null</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise22java">Exercise22.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise22</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="c1">//测试苹果盘子</span>
        <span class="n">FacApple</span> <span class="n">fa</span><span class="o">=</span><span class="k">new</span> <span class="n">FacApple</span><span class="o">();</span>
        <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;</span> <span class="n">pa</span><span class="o">=</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Apple</span><span class="o">&gt;(</span><span class="n">fa</span><span class="o">);</span>
        <span class="n">pa</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fa</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pa</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pa</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
        <span class="c1">//测试香蕉盘子</span>
        <span class="n">FacBanana</span><span class="o">.</span><span class="na">Fac</span> <span class="n">fb</span><span class="o">=</span><span class="k">new</span> <span class="n">FacBanana</span><span class="o">.</span><span class="na">Fac</span><span class="o">();</span>
        <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Banana</span><span class="o">&gt;</span> <span class="n">pb</span><span class="o">=</span><span class="k">new</span> <span class="n">Plate</span><span class="o">&lt;</span><span class="n">Banana</span><span class="o">&gt;(</span><span class="n">fb</span><span class="o">);</span>
        <span class="n">pb</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">fb</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pb</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">pb</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-23">Exercise 23</h4>
<ul>
  <li><strong>Exercise 23</strong>: (1) Modify FactoryConstraint.java so that create( ) takes an argument.</li>
</ul>

<h5 id="factoryijava">FactoryI.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">FactoryI</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">create</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="integerfactoryjava">IntegerFactory.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IntegerFactory</span> <span class="kd">implements</span> <span class="n">FactoryI</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="nf">create</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="foo2java">Foo2.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo2</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">;</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">F</span> <span class="kd">extends</span> <span class="n">FactoryI</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="nf">Foo2</span><span class="o">(</span><span class="n">F</span> <span class="n">factory</span><span class="o">,</span> <span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">num</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="widgetjava">Widget.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Widget</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Factory</span> <span class="kd">implements</span> <span class="n">FactoryI</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="nf">create</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;();</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
                <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Widget</span><span class="o">());</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise23java">Exercise23.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise23</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">new</span> <span class="n">Foo2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">IntegerFactory</span><span class="o">(),</span><span class="mi">10</span><span class="o">);</span>
        <span class="k">new</span> <span class="n">Foo2</span><span class="o">&lt;</span><span class="n">Widget</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Widget</span><span class="o">.</span><span class="na">Factory</span><span class="o">(),</span><span class="mi">10</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-24">Exercise 24</h4>
<ul>
  <li><strong>Exercise 24</strong>: (3) Modify Exercise 21 so that factory objects are held in the Map instead of Class&lt;?&gt;.</li>
</ul>

<h5 id="factoryjava-1">Factory.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Factory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="n">T</span> <span class="nf">create</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>
<h5 id="buildingjava-1">Building.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Building</span> <span class="o">{</span><span class="kd">public</span> <span class="nf">Building</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am Building!"</span><span class="o">);}}</span>
</code></pre>
</div>

<h5 id="housejava-1">House.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">House</span> <span class="kd">extends</span> <span class="n">Building</span> <span class="o">{</span><span class="kd">public</span> <span class="nf">House</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"I am House!"</span><span class="o">);}}</span>
</code></pre>
</div>

<h5 id="facbuildingjava">FacBuilding.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FacBuilding</span> <span class="kd">implements</span> <span class="n">Factory</span><span class="o">&lt;</span><span class="n">Building</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="n">Building</span> <span class="nf">create</span><span class="o">(){</span><span class="k">return</span> <span class="k">new</span> <span class="n">Building</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="fachousejava">FacHouse.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FacBuilding</span> <span class="kd">implements</span> <span class="n">Factory</span><span class="o">&lt;</span><span class="n">Building</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="n">Building</span> <span class="nf">create</span><span class="o">(){</span><span class="k">return</span> <span class="k">new</span> <span class="n">Building</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise24java">Exercise24.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise24</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Factory</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">typeMap</span><span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Factory</span><span class="o">&lt;?&gt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addType</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Factory</span><span class="o">&lt;?&gt;</span> <span class="n">value</span><span class="o">){</span>
        <span class="n">typeMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span><span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">createNew</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">){</span>
        <span class="n">Factory</span><span class="o">&lt;?&gt;</span> <span class="n">f</span><span class="o">=</span><span class="n">typeMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="n">Object</span> <span class="n">o</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">o</span><span class="o">;</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Exercise24</span> <span class="n">ctc</span><span class="o">=</span><span class="k">new</span> <span class="n">Exercise24</span><span class="o">();</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">addType</span><span class="o">(</span><span class="s">"Building"</span><span class="o">,</span><span class="k">new</span> <span class="n">FacBuilding</span><span class="o">());</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">addType</span><span class="o">(</span><span class="s">"House"</span><span class="o">,</span><span class="k">new</span> <span class="n">FacHouse</span><span class="o">());</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">createNew</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>   <span class="c1">//Exception: java.lang.NullPointerException</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">createNew</span><span class="o">(</span><span class="s">"Building"</span><span class="o">);</span>
        <span class="n">ctc</span><span class="o">.</span><span class="na">createNew</span><span class="o">(</span><span class="s">"House"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-25">Exercise 25</h4>
<ul>
  <li><strong>Exercise 25</strong>: (2) Create two interfaces and a class that implements both. Create two generic methods, one whose argument parameter is bounded by the first interface and one whose argument parameter is bounded by the second interface. Create an instance of the class that implements both interfaces, and show that it can be used with both generic methods.</li>
</ul>

<h5 id="interface1java">Interface1.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Interface1</span><span class="o">{</span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">print1</span><span class="o">();}</span>
</code></pre>
</div>

<h5 id="interface2java">Interface2.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Interface2</span><span class="o">{</span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">print2</span><span class="o">();}</span>
</code></pre>
</div>

<h5 id="implementationjava">Implementation.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Implementation</span> <span class="kd">implements</span> <span class="n">Interface1</span><span class="o">,</span> <span class="n">Interface2</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print1</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Inherit from Interface1!"</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">print2</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Inherit from Interface2!"</span><span class="o">);}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise25java">Exercise25.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise25</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Interface1</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">foo1</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">t</span><span class="o">.</span><span class="na">print1</span><span class="o">();}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">V</span> <span class="kd">extends</span> <span class="n">Interface2</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">foo2</span><span class="o">(</span><span class="n">V</span> <span class="n">v</span><span class="o">){</span><span class="n">v</span><span class="o">.</span><span class="na">print2</span><span class="o">();}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Exercise25</span><span class="o">.</span><span class="na">foo1</span><span class="o">(</span><span class="k">new</span> <span class="n">Implementation</span><span class="o">());</span>
        <span class="n">Exercise25</span><span class="o">.</span><span class="na">foo2</span><span class="o">(</span><span class="k">new</span> <span class="n">Implementation</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-26">Exercise 26</h4>
<ul>
  <li><strong>Exercise 26</strong>: (2) Demonstrate array covariance using Numbers and Integers.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise26</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Number</span><span class="o">[]</span> <span class="n">numArray</span><span class="o">=</span><span class="k">new</span> <span class="n">Integer</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">numArray</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">numArray</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-27">Exercise 27</h4>
<ul>
  <li><strong>Exercise 27</strong>: (2) Show that covariance doesn’t work with Lists, using Numbers and Integers, then introduce wildcards.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise27</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="c1">//List&lt;Number&gt; numList1=new ArrayList&lt;Integer&gt;();  //Error</span>
        <span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">numList2</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-28">Exercise 28</h4>
<ul>
  <li><strong>Exercise 28</strong>: (4) Create a generic class Generic1<T> with a single method that takes an argument of type T. Create a second generic class Generic2<T> with a single method that returns an argument of type T. Write a generic method with a contravariant argument of the first generic class that calls its method. Write a second generic method with a covariant argument of the second generic class that calls its method. Test using the typeinfo.pets library.</T></T></li>
</ul>

<h5 id="generic1java">Generic1.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Generic1</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">item</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Generic1</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">item</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">item</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">item</span><span class="o">);}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="generic2java">Generic2.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Generic2</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">item</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Generic2</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">item</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">(){</span><span class="k">return</span> <span class="n">item</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise28java">Exercise28.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise28</span><span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">foo1</span><span class="o">(</span><span class="n">Generic1</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">g</span><span class="o">,</span> <span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">g</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">t</span><span class="o">);}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">V</span> <span class="nf">foo2</span><span class="o">(</span><span class="n">Generic2</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">V</span><span class="o">&gt;</span> <span class="n">g</span><span class="o">){</span><span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="na">get</span><span class="o">();}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Generic1</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span> <span class="n">genNum</span><span class="o">=</span><span class="k">new</span> <span class="n">Generic1</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span>
        <span class="n">Generic2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">genInt</span><span class="o">=</span><span class="k">new</span> <span class="n">Generic2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;(</span><span class="k">new</span> <span class="n">Integer</span><span class="o">(</span><span class="mi">222</span><span class="o">));</span>
        <span class="n">Exercise28</span><span class="o">.</span><span class="na">foo1</span><span class="o">(</span><span class="n">genNum</span><span class="o">,</span> <span class="k">new</span> <span class="n">Float</span><span class="o">(</span><span class="mf">111.1f</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">genNum</span><span class="o">);</span>
        <span class="n">Integer</span> <span class="n">i</span><span class="o">=</span><span class="n">Exercise28</span><span class="o">.</span><span class="na">foo2</span><span class="o">(</span><span class="n">genInt</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-29">Exercise 29</h4>
<ul>
  <li><strong>Exercise 29</strong>: (5) Create a generic method that takes as an argument a Holder&lt;List<?>>. Determine what methods you can and can’t call for the Holder and for the List. Repeat for an argument of List<Holder<?>&gt;.</li>
</ul>

<h5 id="holderjava">Holder.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Holder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">obj</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Holder</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">obj</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">obj</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="na">toString</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise29java">Exercise29.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise29</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setList</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">l</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">l</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">holderSet</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">h</span><span class="o">){</span>
        <span class="c1">//h.set(new ArrayList&lt;String&gt;(Arrays.asList("Hello World".split(" "))));    //Error: mismatch; ArrayList&lt;String&gt; cannot be converted to CAP#1</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">holderGet</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">h</span><span class="o">){</span>
        <span class="k">return</span> <span class="n">h</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">listSet</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">h</span><span class="o">){</span>
        <span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="c1">//list.add("TOTO");     //Error: mismatch; ArrayList&lt;String&gt; cannot be converted to CAP#1</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Object</span> <span class="nf">listGet</span><span class="o">(</span><span class="n">Holder</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">List</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">h</span><span class="o">){</span>
        <span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">li</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">li</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">10</span><span class="o">));</span>
        <span class="n">Holder</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">hli</span><span class="o">=</span><span class="k">new</span> <span class="n">Holder</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;(</span><span class="n">li</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hli</span><span class="o">);</span>
        <span class="n">Exercise29</span><span class="o">.</span><span class="na">setList</span><span class="o">(</span><span class="n">li</span><span class="o">);</span>
        <span class="c1">//Exercise29.holderSet(hli);    //Error: argument mismatch; ArrayList&lt;String&gt; cannot be converted to CAP#1</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Exercise29</span><span class="o">.</span><span class="na">holderGet</span><span class="o">(</span><span class="n">hli</span><span class="o">));</span>
        <span class="c1">//Exercise29.listSet(hli);    //Error: argument mismatch; String cannot be converted to CAP#1</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Exercise29</span><span class="o">.</span><span class="na">listGet</span><span class="o">(</span><span class="n">hli</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-30">Exercise 30</h4>
<ul>
  <li><strong>Exercise 30</strong>: (2) Create a Holder for each of the primitive wrapper types, and show that autoboxing and autounboxing works for the set( ) and get( ) methods of each instance.</li>
</ul>

<h5 id="holderjava-1">Holder.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Holder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">T</span> <span class="n">obj</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Holder</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="n">obj</span><span class="o">=</span><span class="n">t</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">obj</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">obj</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="na">toString</span><span class="o">();}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="integerholderjava">IntegerHolder.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IntegerHolder</span> <span class="kd">extends</span> <span class="n">Holder</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="nf">IntegerHolder</span><span class="o">(</span><span class="n">Integer</span> <span class="n">i</span><span class="o">){</span><span class="kd">super</span><span class="o">(</span><span class="n">i</span><span class="o">);}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise30java">Exercise30.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise30</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
            <span class="n">IntegerHolder</span> <span class="n">ih</span><span class="o">=</span><span class="k">new</span> <span class="n">IntegerHolder</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-31">Exercise 31</h4>
<ul>
  <li><strong>Exercise 31</strong>: (1) Remove all the generics from MultipleInterfaceVariants.java and modify the code so that the example compiles.</li>
</ul>

<h5 id="payablejava">Payable.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Payable</span> <span class="o">{}</span>
</code></pre>
</div>

<h5 id="employeejava">Employee.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="kd">implements</span> <span class="n">Payable</span> <span class="o">{}</span>
</code></pre>
</div>

<h5 id="hourlyjava">Hourly.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Hourly</span> <span class="kd">extends</span> <span class="n">Employee</span> <span class="o">{}</span>
</code></pre>
</div>

<h5 id="exercise31java">Exercise31.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise31</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">Employee</span> <span class="n">e</span><span class="o">=</span><span class="k">new</span> <span class="n">Employee</span><span class="o">();</span>
        <span class="n">Hourly</span> <span class="n">h</span><span class="o">=</span><span class="k">new</span> <span class="n">Hourly</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-32">Exercise 32</h4>
<ul>
  <li><strong>Exercise 32</strong>: (1) Verify that FixedSizeStack in GenericCast.java generates exceptions if you try to go out of its bounds. Does this mean that bounds-checking code is not required?</li>
</ul>

<h5 id="fixedsizestackjava">FixedSizeStack.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixedSizeStack</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">storage</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">FixedSizeStack</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="n">storage</span><span class="o">[</span><span class="n">index</span><span class="o">++]</span> <span class="o">=</span> <span class="n">item</span><span class="o">;</span> <span class="o">}</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="o">(</span><span class="n">T</span><span class="o">)</span><span class="n">storage</span><span class="o">[--</span><span class="n">index</span><span class="o">];</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise32java">Exercise32.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise32</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">SIZE</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FixedSizeStack</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FixedSizeStack</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">SIZE</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="s">"A B C D E F G H I J"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">)){</span>
            <span class="n">strings</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//strings.push("end");    //Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SIZE</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-33">Exercise 33</h4>
<ul>
  <li><strong>Exercise 33</strong>: (3) Repair GenericCast.java using an ArrayList.</li>
</ul>

<h5 id="arrayfixedsizestackjava">ArrayFixedSizeStack.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArrayFixedSizeStack</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">storage</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">ArrayFixedSizeStack</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">push</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="n">storage</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span> <span class="n">index</span><span class="o">++;</span> <span class="o">}</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">pop</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="o">(</span><span class="n">T</span><span class="o">)</span><span class="n">storage</span><span class="o">.</span><span class="na">get</span><span class="o">(--</span><span class="n">index</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="o">(){</span><span class="k">return</span> <span class="n">index</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise33java">Exercise33.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise33</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ArrayFixedSizeStack</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">strings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayFixedSizeStack</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="s">"A B C D E F G H I J"</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">" "</span><span class="o">)){</span>
            <span class="n">strings</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">strings</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">"end"</span><span class="o">);</span>    <span class="c1">//Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException</span>
        <span class="k">while</span><span class="o">(</span><span class="n">strings</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">s</span> <span class="o">+</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-34">Exercise 34</h4>
<ul>
  <li><strong>Exercise 34</strong>: (4) Create a self-bounded generic type that contains an abstract method that takes an argument of the generic type parameter and produces a return value of the generic type parameter. In a non-abstract method of the class, call the abstract method and return its result. Inherit from the self-bounded type and test the resulting class.</li>
</ul>

<p>自限定类对于需要互相比较的对象比较合适。相当于限定了圆形只能和圆形比较面积，长方形只能和长方形比较面积。</p>

<h5 id="shapejava">Shape.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Math.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Shape</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Shape</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;{</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isLarger</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">area</span><span class="o">()&gt;</span><span class="n">t</span><span class="o">.</span><span class="na">area</span><span class="o">();}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSmaller</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">area</span><span class="o">()&lt;</span><span class="n">t</span><span class="o">.</span><span class="na">area</span><span class="o">();}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equal</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">){</span><span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">area</span><span class="o">()==</span><span class="n">t</span><span class="o">.</span><span class="na">area</span><span class="o">();}</span>
    <span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">();</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="circlejava">Circle.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Math.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">extends</span> <span class="n">Shape</span><span class="o">&lt;</span><span class="n">Circle</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">radius</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Circle</span><span class="o">(</span><span class="kt">double</span> <span class="n">r</span><span class="o">){</span><span class="n">radius</span><span class="o">=</span><span class="n">r</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="na">PI</span><span class="o">*</span><span class="n">radius</span><span class="o">*</span><span class="n">radius</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="rectanglejava">Rectangle.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Math.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">extends</span> <span class="n">Shape</span><span class="o">&lt;</span><span class="n">Rectangle</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">width</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">height</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Rectangle</span><span class="o">(</span><span class="kt">double</span> <span class="n">w</span><span class="o">,</span> <span class="kt">double</span> <span class="n">h</span><span class="o">){</span><span class="n">width</span><span class="o">=</span><span class="n">w</span><span class="o">;</span> <span class="n">height</span><span class="o">=</span><span class="n">h</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">area</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">width</span><span class="o">*</span><span class="n">height</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise34java">Exercise34.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.Math.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise34</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//自限定的意义在于：圆形只能和圆形比较面积</span>
        <span class="n">Circle</span> <span class="n">c1</span><span class="o">=</span><span class="k">new</span> <span class="n">Circle</span><span class="o">(</span><span class="mf">11.1</span><span class="o">);</span>
        <span class="n">Circle</span> <span class="n">c2</span><span class="o">=</span><span class="k">new</span> <span class="n">Circle</span><span class="o">(</span><span class="mf">15.5</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="na">isLarger</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="na">isSmaller</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="na">equal</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
        <span class="c1">//自限定的意义在于：长方形只能和长方形比较面积</span>
        <span class="n">Rectangle</span> <span class="n">r1</span><span class="o">=</span><span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="mf">4.0</span><span class="o">,</span><span class="mf">6.0</span><span class="o">);</span>
        <span class="n">Rectangle</span> <span class="n">r2</span><span class="o">=</span><span class="k">new</span> <span class="n">Rectangle</span><span class="o">(</span><span class="mf">3.0</span><span class="o">,</span><span class="mf">8.0</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r1</span><span class="o">.</span><span class="na">isLarger</span><span class="o">(</span><span class="n">r2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r1</span><span class="o">.</span><span class="na">isSmaller</span><span class="o">(</span><span class="n">r2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r1</span><span class="o">.</span><span class="na">equal</span><span class="o">(</span><span class="n">r2</span><span class="o">));</span>
        <span class="c1">//不允许比较长方形和圆形的面积</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r1</span><span class="o">.</span><span class="na">isLarger</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r1</span><span class="o">.</span><span class="na">isSmaller</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">r1</span><span class="o">.</span><span class="na">equal</span><span class="o">(</span><span class="n">c2</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-35">Exercise 35</h4>
<ul>
  <li><strong>Exercise 35</strong>: (1) Modify CheckedList.java so that it uses the Coffee classes defined in this chapter.</li>
</ul>

<h5 id="coffeejava-1">Coffee.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Coffee</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">count</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Coffee</span><span class="o">(){</span><span class="n">id</span><span class="o">=</span><span class="n">count</span><span class="o">++;}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">showId</span><span class="o">(){</span><span class="k">return</span> <span class="n">id</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="lattejava-1">Latte.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Latte</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"No."</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">showId</span><span class="o">())+</span><span class="s">"&gt;&gt;&gt; I am Latte!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="capuccinojava-1">Capuccino.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Capuccino</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"No."</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">showId</span><span class="o">())+</span><span class="s">"&gt;&gt;&gt; I am Capuccino!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="esppressojava">Esppresso.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Esppresso</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span><span class="k">return</span> <span class="s">"No."</span><span class="o">+</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">showId</span><span class="o">())+</span><span class="s">"&gt;&gt;&gt; I am Esppresso!"</span><span class="o">;}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise35java">Exercise35.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise35</span><span class="o">{</span>
    <span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">"rawtypes"</span><span class="o">,</span><span class="s">"unchecked"</span><span class="o">})</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">oldStyleMethod</span><span class="o">(</span><span class="n">List</span> <span class="n">probablyCapuccino</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">probablyCapuccino</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Latte</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@SuppressWarnings</span><span class="o">({</span><span class="s">"rawtypes"</span><span class="o">,</span><span class="s">"unchecked"</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="c1">//unsafe list</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Capuccino</span><span class="o">&gt;</span> <span class="n">capUnsafe</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Capuccino</span><span class="o">&gt;();</span>
        <span class="n">Exercise35</span><span class="o">.</span><span class="na">oldStyleMethod</span><span class="o">(</span><span class="n">capUnsafe</span><span class="o">);</span> <span class="c1">//ClassCastException</span>
        <span class="c1">//safe list</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">Capuccino</span><span class="o">&gt;</span> <span class="n">capSafe</span><span class="o">=</span><span class="n">Collections</span><span class="o">.</span><span class="na">checkedList</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Capuccino</span><span class="o">&gt;(),</span> <span class="n">Capuccino</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="n">Exercise35</span><span class="o">.</span><span class="na">oldStyleMethod</span><span class="o">(</span><span class="n">capSafe</span><span class="o">);</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-36">Exercise 36</h4>
<ul>
  <li><strong>Exercise 36</strong>: (2) Add a second parameterized exception to the Processor class and demonstrate that the exceptions can vary independently.</li>
</ul>

<h5 id="processorjava">Processor.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Processor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">,</span> <span class="n">F</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">resultCollector</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="processorrunnerjava">ProcessorRunner.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProcessRunner</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">,</span> <span class="n">F</span> <span class="kd">extends</span> <span class="n">Exception</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Processor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">processAll</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">E</span><span class="o">,</span><span class="n">F</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">resultCollector</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Processor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">,</span><span class="n">E</span><span class="o">,</span><span class="n">F</span><span class="o">&gt;</span> <span class="n">processor</span> <span class="o">:</span> <span class="k">this</span><span class="o">){</span>
            <span class="n">processor</span><span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="n">resultCollector</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resultCollector</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="failure1java">Failure1.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Failure1</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;}</span>
</code></pre>
</div>

<h5 id="failure2java">Failure2.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Failure3</span> <span class="kd">extends</span> <span class="n">Exception</span> <span class="o">{</span><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span><span class="o">=</span><span class="mi">0</span><span class="o">;}</span>
</code></pre>
</div>

<h5 id="processor1java">Processor1.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Processor1</span> <span class="kd">implements</span> <span class="n">Processor</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Failure1</span><span class="o">,</span><span class="n">Failure3</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">resultCollector</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Failure1</span><span class="o">,</span><span class="n">Failure3</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">count</span><span class="o">&gt;=</span><span class="mi">5</span><span class="o">){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Failure3</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">count</span><span class="o">--</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">){</span>
            <span class="n">resultCollector</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Hep!"</span><span class="o">);</span>
        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
            <span class="n">resultCollector</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Ho!"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">count</span><span class="o">&lt;-</span><span class="mi">1</span><span class="o">){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Failure1</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="processor2java">Processor2.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Processor2</span> <span class="kd">implements</span> <span class="n">Processor</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Failure2</span><span class="o">,</span><span class="n">Failure3</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">resultCollector</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Failure2</span><span class="o">,</span><span class="n">Failure3</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">count</span><span class="o">&gt;=</span><span class="mi">5</span><span class="o">){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Failure3</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">count</span><span class="o">--</span> <span class="o">==</span> <span class="mi">0</span><span class="o">){</span>
            <span class="n">resultCollector</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">47</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">resultCollector</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">11</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">count</span><span class="o">&lt;-</span><span class="mi">1</span><span class="o">){</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">Failure3</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h5 id="exercise36java">Exercise36.java</h5>
<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise36</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">ProcessRunner</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Failure1</span><span class="o">,</span><span class="n">Failure3</span><span class="o">&gt;</span> <span class="n">runner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ProcessRunner</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Failure1</span><span class="o">,</span><span class="n">Failure3</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">runner</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Processor1</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">runner</span><span class="o">.</span><span class="na">processAll</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Failure1</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e1</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Failure3</span> <span class="n">e3</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e3</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">ProcessRunner</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Failure2</span><span class="o">,</span><span class="n">Failure3</span><span class="o">&gt;</span> <span class="n">runner2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ProcessRunner</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Failure2</span><span class="o">,</span><span class="n">Failure3</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">runner2</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Processor2</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">runner2</span><span class="o">.</span><span class="na">processAll</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Failure2</span> <span class="n">e2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e2</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Failure3</span> <span class="n">e3</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e3</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-37">Exercise 37</h4>
<ul>
  <li><strong>Exercise 37</strong>: (2) Add a new mixin class Colored to Mixins.java, mix it into Mixin, and show that it works.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
 *  时间戳系统
 */</span>
<span class="kd">interface</span> <span class="nc">TimeStamped</span> <span class="o">{</span> <span class="kt">long</span> <span class="nf">getStamp</span><span class="o">();</span> <span class="o">}</span>

<span class="kd">class</span> <span class="nc">TimeStampedImp</span> <span class="kd">implements</span> <span class="n">TimeStamped</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">timeStamp</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">TimeStampedImp</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">timeStamp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="o">().</span><span class="na">getTime</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getStamp</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">timeStamp</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 *  序列号系统
 */</span>
<span class="kd">interface</span> <span class="nc">SerialNumbered</span> <span class="o">{</span> <span class="kt">long</span> <span class="nf">getSerialNumber</span><span class="o">();</span> <span class="o">}</span>

<span class="kd">class</span> <span class="nc">SerialNumberedImp</span> <span class="kd">implements</span> <span class="n">SerialNumbered</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialNumber</span> <span class="o">=</span> <span class="n">counter</span><span class="o">++;</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getSerialNumber</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">serialNumber</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 *  版本系统（附加的第三个混型）
 */</span>
<span class="kd">interface</span> <span class="nc">VersionId</span> <span class="o">{</span> <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getVersionId</span><span class="o">();}</span>

<span class="kd">class</span> <span class="nc">VersionIdImp</span> <span class="kd">implements</span> <span class="n">VersionId</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">version</span><span class="o">=</span><span class="mf">1.0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">VersionIdImp</span><span class="o">(</span><span class="kt">double</span> <span class="n">v</span><span class="o">){</span><span class="n">version</span><span class="o">=</span><span class="n">v</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">progressVersion</span><span class="o">(){</span><span class="n">version</span><span class="o">+=</span><span class="mf">0.1</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getVersionId</span><span class="o">(){</span><span class="k">return</span> <span class="n">version</span><span class="o">;}</span>
<span class="o">}</span>

<span class="cm">/**
 *  白板类系统
 */</span>
<span class="kd">interface</span> <span class="nc">Basic</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">String</span> <span class="n">val</span><span class="o">);</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">get</span><span class="o">();</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">BasicImp</span> <span class="kd">implements</span> <span class="n">Basic</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">value</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">String</span> <span class="n">val</span><span class="o">)</span> <span class="o">{</span> <span class="n">value</span> <span class="o">=</span> <span class="n">val</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">value</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="cm">/**
 *  混型系统
 */</span>
<span class="kd">class</span> <span class="nc">Mixin</span> <span class="kd">extends</span> <span class="n">BasicImp</span> <span class="kd">implements</span> <span class="n">TimeStamped</span><span class="o">,</span> <span class="n">SerialNumbered</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">TimeStamped</span> <span class="n">timeStamp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TimeStampedImp</span><span class="o">();</span>
    <span class="kd">private</span> <span class="n">SerialNumbered</span> <span class="n">serialNumber</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SerialNumberedImp</span><span class="o">();</span>
    <span class="kd">private</span> <span class="n">VersionId</span> <span class="n">id</span><span class="o">=</span><span class="k">new</span> <span class="n">VersionIdImp</span><span class="o">(</span><span class="mf">1.0</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getStamp</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">timeStamp</span><span class="o">.</span><span class="na">getStamp</span><span class="o">();</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getSerialNumber</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">serialNumber</span><span class="o">.</span><span class="na">getSerialNumber</span><span class="o">();</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getVersionId</span><span class="o">(){</span> <span class="k">return</span> <span class="n">id</span><span class="o">.</span><span class="na">getVersionId</span><span class="o">();}</span>
<span class="o">}</span>

<span class="cm">/**
 *  测试
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise37</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Mixin</span> <span class="n">mixin1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Mixin</span><span class="o">(),</span> <span class="n">mixin2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Mixin</span><span class="o">();</span>
        <span class="n">mixin1</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"test string 1"</span><span class="o">);</span>
        <span class="n">mixin2</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"test string 2"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mixin1</span><span class="o">.</span><span class="na">get</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">mixin1</span><span class="o">.</span><span class="na">getStamp</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">mixin1</span><span class="o">.</span><span class="na">getSerialNumber</span><span class="o">()+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">mixin1</span><span class="o">.</span><span class="na">getVersionId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mixin2</span><span class="o">.</span><span class="na">get</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">mixin2</span><span class="o">.</span><span class="na">getStamp</span><span class="o">()</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">mixin2</span><span class="o">.</span><span class="na">getSerialNumber</span><span class="o">()+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">mixin2</span><span class="o">.</span><span class="na">getVersionId</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-38">Exercise 38</h4>
<ul>
  <li><strong>Exercise 38</strong>: (4) Create a simple Decorator system by starting with basic coffee, then providing decorators of steamed milk, foam, chocolate, caramel and whipped cream.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Coffee</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">volumn</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Coffee</span><span class="o">(</span><span class="kt">int</span> <span class="n">v</span><span class="o">){</span><span class="n">volumn</span><span class="o">=</span><span class="n">v</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">drink</span><span class="o">(</span><span class="kt">int</span> <span class="n">v</span><span class="o">){</span><span class="n">volumn</span><span class="o">=</span> <span class="o">(</span><span class="n">v</span><span class="o">&lt;=</span><span class="n">volumn</span><span class="o">)?</span> <span class="n">volumn</span><span class="o">-</span><span class="nl">v:</span><span class="mi">0</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">checkRest</span><span class="o">(){</span><span class="k">return</span> <span class="n">volumn</span><span class="o">;}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Decorator</span> <span class="kd">extends</span> <span class="n">Coffee</span><span class="o">{</span>
    <span class="n">Coffee</span> <span class="n">c</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Decorator</span><span class="o">(</span><span class="n">Coffee</span> <span class="n">c</span><span class="o">,</span> <span class="kt">int</span> <span class="n">ex</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">checkRest</span><span class="o">()+</span><span class="n">ex</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">c</span><span class="o">=</span><span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">MilkCoffee</span> <span class="kd">extends</span> <span class="n">Decorator</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">MilkCoffee</span><span class="o">(</span><span class="n">Coffee</span> <span class="n">c</span><span class="o">,</span><span class="kt">int</span> <span class="n">ex</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">c</span><span class="o">,</span><span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">FoamCoffee</span> <span class="kd">extends</span> <span class="n">Decorator</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">FoamCoffee</span><span class="o">(</span><span class="n">Coffee</span> <span class="n">c</span><span class="o">,</span><span class="kt">int</span> <span class="n">ex</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">c</span><span class="o">,</span><span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">CaramelCoffee</span> <span class="kd">extends</span> <span class="n">Decorator</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">CaramelCoffee</span><span class="o">(</span><span class="n">Coffee</span> <span class="n">c</span><span class="o">,</span><span class="kt">int</span> <span class="n">ex</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">c</span><span class="o">,</span><span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">ChocolateCoffee</span> <span class="kd">extends</span> <span class="n">Decorator</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">ChocolateCoffee</span><span class="o">(</span><span class="n">Coffee</span> <span class="n">c</span><span class="o">,</span><span class="kt">int</span> <span class="n">ex</span><span class="o">){</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">c</span><span class="o">,</span><span class="n">ex</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise38</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//制作玛奇朵</span>
        <span class="n">MilkCoffee</span> <span class="n">latte</span><span class="o">=</span><span class="k">new</span> <span class="n">MilkCoffee</span><span class="o">(</span><span class="k">new</span> <span class="n">Coffee</span><span class="o">(</span><span class="mi">10</span><span class="o">),</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">FoamCoffee</span> <span class="n">cappuccino</span><span class="o">=</span><span class="k">new</span> <span class="n">FoamCoffee</span><span class="o">(</span><span class="n">latte</span><span class="o">,</span><span class="mi">5</span><span class="o">);</span>
        <span class="n">cappuccino</span><span class="o">.</span><span class="na">drink</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>    <span class="c1">//服务员偷喝一口</span>
        <span class="n">CaramelCoffee</span> <span class="n">macchiato</span><span class="o">=</span><span class="k">new</span> <span class="n">CaramelCoffee</span><span class="o">(</span><span class="n">cappuccino</span><span class="o">,</span><span class="mi">3</span><span class="o">);</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">macchiato</span><span class="o">.</span><span class="na">checkRest</span><span class="o">());</span>
        <span class="n">macchiato</span><span class="o">.</span><span class="na">drink</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">macchiato</span><span class="o">.</span><span class="na">checkRest</span><span class="o">());</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-39">Exercise 39</h4>
<ul>
  <li><strong>Exercise 39</strong>: (1) Add a new mixin class Colored to DynamicProxyMixin.java, mix it into mixin, and show that it works.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
 *  tuple容器
 */</span>
<span class="kd">class</span> <span class="nc">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="n">A</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="n">B</span> <span class="n">second</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">TwoTuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span> <span class="n">first</span> <span class="o">=</span> <span class="n">a</span><span class="o">;</span> <span class="n">second</span> <span class="o">=</span> <span class="n">b</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"("</span> <span class="o">+</span> <span class="n">first</span> <span class="o">+</span> <span class="s">", "</span> <span class="o">+</span> <span class="n">second</span> <span class="o">+</span> <span class="s">")"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;</span> <span class="nf">tuple</span><span class="o">(</span><span class="n">A</span> <span class="n">a</span><span class="o">,</span> <span class="n">B</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">A</span><span class="o">,</span><span class="n">B</span><span class="o">&gt;(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  时间戳系统
 */</span>
<span class="kd">interface</span> <span class="nc">TimeStamped</span> <span class="o">{</span> <span class="kt">long</span> <span class="nf">getStamp</span><span class="o">();</span> <span class="o">}</span>

<span class="kd">class</span> <span class="nc">TimeStampedImp</span> <span class="kd">implements</span> <span class="n">TimeStamped</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">timeStamp</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">TimeStampedImp</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">timeStamp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="o">().</span><span class="na">getTime</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getStamp</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">timeStamp</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  序列号系统
 */</span>
<span class="kd">interface</span> <span class="nc">SerialNumbered</span> <span class="o">{</span> <span class="kt">long</span> <span class="nf">getSerialNumber</span><span class="o">();</span> <span class="o">}</span>

<span class="kd">class</span> <span class="nc">SerialNumberedImp</span> <span class="kd">implements</span> <span class="n">SerialNumbered</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">long</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialNumber</span> <span class="o">=</span> <span class="n">counter</span><span class="o">++;</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getSerialNumber</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">serialNumber</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  新加的Colored系统
 */</span>
<span class="kd">interface</span> <span class="nc">Colored</span> <span class="o">{</span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isColored</span><span class="o">();}</span>

<span class="kd">class</span> <span class="nc">ColoredImp</span> <span class="kd">implements</span> <span class="n">Colored</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">colored</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">ColoredImp</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">c</span><span class="o">){</span><span class="n">colored</span><span class="o">=</span><span class="n">c</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">makeColor</span><span class="o">(){</span><span class="n">colored</span><span class="o">=</span><span class="kc">true</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">removeColor</span><span class="o">(){</span><span class="n">colored</span><span class="o">=</span><span class="kc">false</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isColored</span><span class="o">(){</span><span class="k">return</span> <span class="n">colored</span><span class="o">;}</span>
<span class="o">}</span>
<span class="cm">/**
 *  动态代理
 */</span>
<span class="kd">class</span> <span class="nc">MixinProxy</span> <span class="kd">implements</span> <span class="n">InvocationHandler</span> <span class="o">{</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">delegatesByMethod</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MixinProxy</span><span class="o">(</span><span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">,</span><span class="n">Class</span><span class="o">&lt;?&gt;&gt;...</span> <span class="n">pairs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">delegatesByMethod</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">TwoTuple</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">,</span><span class="n">Class</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">pair</span> <span class="o">:</span> <span class="n">pairs</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="n">Method</span> <span class="n">method</span> <span class="o">:</span> <span class="n">pair</span><span class="o">.</span><span class="na">second</span><span class="o">.</span><span class="na">getMethods</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
                <span class="c1">// The first interface in the map</span>
                <span class="c1">// implements the method.</span>
                <span class="k">if</span> <span class="o">(!</span><span class="n">delegatesByMethod</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">methodName</span><span class="o">))</span>
                    <span class="n">delegatesByMethod</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">methodName</span><span class="o">,</span> <span class="n">pair</span><span class="o">.</span><span class="na">first</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="n">Object</span> <span class="n">proxy</span><span class="o">,</span> <span class="n">Method</span> <span class="n">method</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
        <span class="n">Object</span> <span class="n">delegate</span> <span class="o">=</span> <span class="n">delegatesByMethod</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">methodName</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">delegate</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Object</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">TwoTuple</span><span class="o">...</span> <span class="n">pairs</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Class</span><span class="o">[]</span> <span class="n">interfaces</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Class</span><span class="o">[</span><span class="n">pairs</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pairs</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">interfaces</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="n">Class</span><span class="o">)</span><span class="n">pairs</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">second</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">ClassLoader</span> <span class="n">cl</span> <span class="o">=</span> <span class="n">pairs</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">first</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getClassLoader</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">Proxy</span><span class="o">.</span><span class="na">newProxyInstance</span><span class="o">(</span><span class="n">cl</span><span class="o">,</span> <span class="n">interfaces</span><span class="o">,</span> <span class="k">new</span> <span class="n">MixinProxy</span><span class="o">(</span><span class="n">pairs</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  测试
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise39</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Object</span> <span class="n">mixin</span> <span class="o">=</span> <span class="n">MixinProxy</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">TwoTuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">BasicImp</span><span class="o">(),</span> <span class="n">Basic</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
                                              <span class="n">TwoTuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">TimeStampedImp</span><span class="o">(),</span> <span class="n">TimeStamped</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
                                              <span class="n">TwoTuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">SerialNumberedImp</span><span class="o">(),</span><span class="n">SerialNumbered</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
                                              <span class="n">TwoTuple</span><span class="o">.</span><span class="na">tuple</span><span class="o">(</span><span class="k">new</span> <span class="n">ColoredImp</span><span class="o">(</span><span class="kc">false</span><span class="o">),</span><span class="n">Colored</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
        <span class="n">Basic</span> <span class="n">b</span> <span class="o">=</span> <span class="o">(</span><span class="n">Basic</span><span class="o">)</span><span class="n">mixin</span><span class="o">;</span>
        <span class="n">TimeStamped</span> <span class="n">t</span> <span class="o">=</span> <span class="o">(</span><span class="n">TimeStamped</span><span class="o">)</span><span class="n">mixin</span><span class="o">;</span>
        <span class="n">SerialNumbered</span> <span class="n">s</span> <span class="o">=</span> <span class="o">(</span><span class="n">SerialNumbered</span><span class="o">)</span><span class="n">mixin</span><span class="o">;</span>
        <span class="n">Colored</span> <span class="n">c</span><span class="o">=(</span><span class="n">Colored</span><span class="o">)</span><span class="n">mixin</span><span class="o">;</span>
        <span class="n">b</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">getStamp</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">.</span><span class="na">getSerialNumber</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">isColored</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-40">Exercise 40</h4>
<ul>
  <li><strong>Exercise 40</strong>: (3) Add a speak( ) method to all the pets in typeinfo.pets. Modify Apply.java to call the speak( ) method for a heterogeneous collection of Pet.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
 *  Exercise 40
 */</span>
<span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">ciaoshen</span><span class="o">.</span><span class="na">thinkinjava</span><span class="o">.</span><span class="na">chapter15</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.lang.reflect.*</span><span class="o">;</span>
<span class="cm">/**
 *  LEV 1
 */</span>
<span class="kd">class</span> <span class="nc">Individual</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(){</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">=</span><span class="s">"NULL"</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">=</span><span class="n">name</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"..."</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 2
 */</span>
<span class="kd">class</span> <span class="nc">Person</span> <span class="kd">extends</span> <span class="n">Individual</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Pet</span> <span class="kd">extends</span> <span class="n">Individual</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Pet</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Pet</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 3 - 狗，猫，鼠
 */</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"WongWong!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MiewMiew!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Rodent</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"JiJiJi!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 4 - 狗系
 */</span>
<span class="kd">class</span> <span class="nc">Mutt</span> <span class="kd">extends</span> <span class="n">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Pug</span> <span class="kd">extends</span> <span class="n">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Pug</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Pug</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 4 - 猫系
 */</span>
<span class="kd">class</span> <span class="nc">EgyptianMau</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Manx</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Manx</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Manx</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 4 - 鼠系
 */</span>
<span class="kd">class</span> <span class="nc">Rat</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Rat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Rat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Mouse</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Hamster</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  Apply类
 */</span>
<span class="kd">class</span> <span class="nc">Apply</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">,</span> <span class="n">S</span> <span class="kd">extends</span> <span class="n">Iterable</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;&gt;</span> <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="n">S</span> <span class="n">seq</span><span class="o">,</span> <span class="n">Method</span> <span class="n">f</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="n">T</span> <span class="nl">t:</span> <span class="n">seq</span><span class="o">)</span>
                <span class="n">f</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">t</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// Failures are programmer errors</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  测试类
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise40</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;</span> <span class="n">lp</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Pet</span><span class="o">&gt;();</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Mutt</span><span class="o">(</span><span class="s">"MuMu"</span><span class="o">));</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Pug</span><span class="o">(</span><span class="s">"PuPu"</span><span class="o">));</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">EgyptianMau</span><span class="o">(</span><span class="s">"MauMau"</span><span class="o">));</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Manx</span><span class="o">(</span><span class="s">"ManMan"</span><span class="o">));</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Rat</span><span class="o">(</span><span class="s">"RaRa"</span><span class="o">));</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Mouse</span><span class="o">(</span><span class="s">"MouMou"</span><span class="o">));</span>
        <span class="n">lp</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Hamster</span><span class="o">(</span><span class="s">"HaHa"</span><span class="o">));</span>

        <span class="k">try</span><span class="o">{</span>
            <span class="n">Apply</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">lp</span><span class="o">,</span><span class="n">Pet</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(</span><span class="s">"speak"</span><span class="o">));</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-41">Exercise 41</h4>
<ul>
  <li><strong>Exercise 41:</strong> (1) Modify Fill2.java to use the classes in typeinfo.pets instead of the Coffee classes.</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//addable接口</span>
<span class="kd">interface</span> <span class="nc">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">);</span> <span class="o">}</span>

<span class="c1">//面向Addable接口的fill方法</span>
<span class="kd">class</span> <span class="nc">FillPets</span> <span class="o">{</span>
    <span class="c1">//用反射填充容器</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Pet</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">fill</span><span class="o">(</span><span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">addable</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">T</span><span class="o">&gt;</span> <span class="n">classToken</span><span class="o">,</span> <span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">addable</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">classToken</span><span class="o">.</span><span class="na">newInstance</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/** 《适配器》
 * 原理是类库里的Collection和SimpleQueue动不了。
 * 那就给他们都套一层代理。然后新的代理类实现Addable接口。
 */</span>
<span class="c1">//Collection是通过组合的方式套代理</span>
<span class="kd">class</span> <span class="nc">AddableCollectionAdapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">AddableCollectionAdapter</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="n">c</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// 把加了add()方法的容器的引用，赋值给Addable接口。</span>
<span class="kd">class</span> <span class="nc">Adapter</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">collectionAdapter</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">AddableCollectionAdapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//SimpleQueue</span>
<span class="kd">class</span> <span class="nc">SimpleQueue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">storage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span> <span class="n">storage</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">t</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">get</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">iterator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">storage</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">//SimpleQueue的派生类实现Addable接口。</span>
<span class="kd">class</span> <span class="nc">AddableSimpleQueue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">SimpleQueue</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">Addable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 1
 */</span>
<span class="kd">class</span> <span class="nc">Individual</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(){</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">=</span><span class="s">"NULL"</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="nf">Individual</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">){</span><span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">=</span><span class="n">name</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"..."</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 2
 */</span>
<span class="kd">class</span> <span class="nc">Person</span> <span class="kd">extends</span> <span class="n">Individual</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Pet</span> <span class="kd">extends</span> <span class="n">Individual</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Pet</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Pet</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 3 - 狗，猫，鼠
 */</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"WongWong!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MiewMiew!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Rodent</span> <span class="kd">extends</span> <span class="n">Pet</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Rodent</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">speak</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"JiJiJi!!!"</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 4 - 狗系
 */</span>
<span class="kd">class</span> <span class="nc">Mutt</span> <span class="kd">extends</span> <span class="n">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Mutt</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Pug</span> <span class="kd">extends</span> <span class="n">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Pug</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Pug</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 4 - 猫系
 */</span>
<span class="kd">class</span> <span class="nc">EgyptianMau</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">EgyptianMau</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Manx</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Manx</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Manx</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  LEV 4 - 鼠系
 */</span>
<span class="kd">class</span> <span class="nc">Rat</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Rat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Rat</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Mouse</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Mouse</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Hamster</span> <span class="kd">extends</span> <span class="n">Rodent</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Hamster</span><span class="o">()</span> <span class="o">{</span> <span class="kd">super</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  测试类
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise41</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="c1">//Pet容器</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;</span> <span class="n">dogs</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;();</span>
        <span class="c1">//给Pet容器套上实现了Addable接口的适配器，就能用面向Addable接口的fill()方法了。</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="k">new</span> <span class="n">AddableCollectionAdapter</span><span class="o">&lt;</span><span class="n">Dog</span><span class="o">&gt;(</span><span class="n">dogs</span><span class="o">),</span><span class="n">Mutt</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
        <span class="c1">//用辅助方法获得Addable接口对象实例</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">Adapter</span><span class="o">.</span><span class="na">collectionAdapter</span><span class="o">(</span><span class="n">dogs</span><span class="o">),</span> <span class="n">Pug</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Dog</span> <span class="nl">d:</span> <span class="n">dogs</span><span class="o">){</span>
            <span class="n">d</span><span class="o">.</span><span class="na">speak</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"----------------------"</span><span class="o">);</span>

        <span class="c1">//SimpleQueue实现了Addable()接口与的派生类。也可以用fill()方法填充。</span>
        <span class="n">AddableSimpleQueue</span><span class="o">&lt;</span><span class="n">Cat</span><span class="o">&gt;</span> <span class="n">catQueue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddableSimpleQueue</span><span class="o">&lt;</span><span class="n">Cat</span><span class="o">&gt;();</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">catQueue</span><span class="o">,</span> <span class="n">EgyptianMau</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
        <span class="n">Fill2</span><span class="o">.</span><span class="na">fill</span><span class="o">(</span><span class="n">catQueue</span><span class="o">,</span> <span class="n">Manx</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Cat</span> <span class="nl">c:</span> <span class="n">catQueue</span><span class="o">){</span>
            <span class="n">c</span><span class="o">.</span><span class="na">speak</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

<h4 id="exercise-42">Exercise 42</h4>
<ul>
  <li><strong>Exercise 42</strong>: (5) Create two separate classes, with nothing in common. Each class should hold a value, and at least have methods that produce that value and perform a modification upon that value. Modify Functional.java so that it performs functional operations on collections of your classes (these operations do not have to be arithmetic as they are in Functional.java).</li>
</ul>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="cm">/**
 *  统一接口：黑箱子
 */</span>
<span class="kd">interface</span> <span class="nc">BlackBox</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">T</span> <span class="n">t</span><span class="o">);</span>
    <span class="kd">public</span> <span class="n">T</span> <span class="nf">function</span><span class="o">();</span>
<span class="o">}</span>
<span class="cm">/**
 *  两个独立的类
 */</span>
<span class="c1">//魔数=31的简单散列值</span>
<span class="kd">class</span> <span class="nc">Hasher</span> <span class="kd">implements</span> <span class="n">BlackBox</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">Long</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="n">l</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">Long</span> <span class="n">n</span><span class="o">){</span><span class="n">num</span><span class="o">=</span><span class="n">n</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">Long</span> <span class="nf">function</span><span class="o">(){</span><span class="k">return</span> <span class="mi">31</span><span class="o">*</span><span class="n">num</span><span class="o">;}</span>
<span class="o">}</span>
<span class="c1">//返回5范围内的上下浮动值</span>
<span class="kd">class</span> <span class="nc">Floater</span> <span class="kd">implements</span> <span class="n">BlackBox</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">num</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Random</span> <span class="n">rand</span><span class="o">=</span><span class="k">new</span> <span class="n">Random</span><span class="o">();</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">Integer</span> <span class="n">n</span><span class="o">){</span><span class="n">n</span><span class="o">=</span><span class="n">num</span><span class="o">;}</span>
    <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">function</span><span class="o">(){</span><span class="k">return</span> <span class="o">(</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">2</span><span class="o">)==</span><span class="mi">0</span><span class="o">)?</span> <span class="n">num</span><span class="o">+</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">5</span><span class="o">):</span><span class="n">num</span><span class="o">-</span><span class="n">rand</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="mi">5</span><span class="o">);}</span>
<span class="o">}</span>
<span class="cm">/**
 *  Functional
 */</span>
<span class="kd">class</span> <span class="nc">NewFunctional</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">doSomething</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">,</span> <span class="n">BlackBox</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">bb</span><span class="o">){</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">T</span> <span class="nl">t:</span><span class="n">c</span><span class="o">){</span>
            <span class="n">bb</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">bb</span><span class="o">.</span><span class="na">function</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="cm">/**
 *  测试
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Exercise42</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">ll</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
        <span class="n">ll</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">11111</span><span class="n">l</span><span class="o">,</span><span class="mi">22222</span><span class="n">l</span><span class="o">,</span><span class="mi">33333</span><span class="n">l</span><span class="o">,</span><span class="mi">44444</span><span class="n">l</span><span class="o">,</span><span class="mi">55555</span><span class="n">l</span><span class="o">));</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">li</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;();</span>
        <span class="n">li</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="mi">111</span><span class="o">,</span><span class="mi">222</span><span class="o">,</span><span class="mi">333</span><span class="o">,</span><span class="mi">444</span><span class="o">,</span><span class="mi">555</span><span class="o">));</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">result1</span><span class="o">=</span><span class="n">NewFunctional</span><span class="o">.</span><span class="na">doSomething</span><span class="o">(</span><span class="n">ll</span><span class="o">,</span><span class="k">new</span> <span class="n">Hasher</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result1</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">result2</span><span class="o">=</span><span class="n">NewFunctional</span><span class="o">.</span><span class="na">doSomething</span><span class="o">(</span><span class="n">li</span><span class="o">,</span><span class="k">new</span> <span class="n">Floater</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">result2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
</div>

        <div class="after-post"></div> <!-- 文章结尾，和Disqus留一些间隔。-->
        <script>
            $("div.after-post").css("margin-bottom","50px");
        </script>

        <!-- Disqus plugin -->
        <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = /java/thinking_in_java/2016/08/09/tij4-15.html;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = /java/thinking_in_java/2016/08/09/tij4-15; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//www-ciaoshen-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>
    <!-- .container -->


    <!-- footer bar -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<footer>
    <!-- Don't show tag cloud
    <div class="footer" id="footer">
        <div class="container">
            <div id="tags-cloud-title">
            <div class="row">
                <div class="col-lg-12  col-md-12 col-sm-12 col-xs-12">
                    <h2>Tag Cloud</h2>
                </div>
            </div>
            </div>
            <div id="tags-cloud" class="row">
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_String" href="/tags/String.html">
                        String
                        <span class="badge">5</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Memory_Model" href="/tags/Memory_Model.html">
                        Memory_Model
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JVM" href="/tags/JVM.html">
                        JVM
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hexo" href="/tags/Hexo.html">
                        Hexo
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Github" href="/tags/Github.html">
                        Github
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Blog" href="/tags/Blog.html">
                        Blog
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Git" href="/tags/Git.html">
                        Git
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JDK" href="/tags/JDK.html">
                        JDK
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JRE" href="/tags/JRE.html">
                        JRE
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IDE" href="/tags/IDE.html">
                        IDE
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_OOP" href="/tags/OOP.html">
                        OOP
                        <span class="badge">7</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Initialization" href="/tags/Initialization.html">
                        Initialization
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Control_Flow" href="/tags/Control_Flow.html">
                        Control_Flow
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_GC" href="/tags/GC.html">
                        GC
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Access_Control" href="/tags/Access_Control.html">
                        Access_Control
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Package" href="/tags/Package.html">
                        Package
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Inheritance" href="/tags/Inheritance.html">
                        Inheritance
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Composition" href="/tags/Composition.html">
                        Composition
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Factory_Pattern" href="/tags/Factory_Pattern.html">
                        Factory_Pattern
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Polymorphism" href="/tags/Polymorphism.html">
                        Polymorphism
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Late_Binding" href="/tags/Late_Binding.html">
                        Late_Binding
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_State_Pattern" href="/tags/State_Pattern.html">
                        State_Pattern
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Interface" href="/tags/Interface.html">
                        Interface
                        <span class="badge">5</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Abstract_Class" href="/tags/Abstract_Class.html">
                        Abstract_Class
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Strategy_Pattern" href="/tags/Strategy_Pattern.html">
                        Strategy_Pattern
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Inner_Class" href="/tags/Inner_Class.html">
                        Inner_Class
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Callback" href="/tags/Callback.html">
                        Callback
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Closure" href="/tags/Closure.html">
                        Closure
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Lambda_Expression" href="/tags/Lambda_Expression.html">
                        Lambda_Expression
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Container" href="/tags/Container.html">
                        Container
                        <span class="badge">9</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Array" href="/tags/Array.html">
                        Array
                        <span class="badge">6</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hash" href="/tags/Hash.html">
                        Hash
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Exception" href="/tags/Exception.html">
                        Exception
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IO" href="/tags/IO.html">
                        IO
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Regular_Expression" href="/tags/Regular_Expression.html">
                        Regular_Expression
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Reflection" href="/tags/Reflection.html">
                        Reflection
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Career_Path" href="/tags/Career_Path.html">
                        Career_Path
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Immutability" href="/tags/Immutability.html">
                        Immutability
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Dynamic_Proxies" href="/tags/Dynamic_Proxies.html">
                        Dynamic_Proxies
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Generics" href="/tags/Generics.html">
                        Generics
                        <span class="badge">8</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Adapter_Pattern" href="/tags/Adapter_Pattern.html">
                        Adapter_Pattern
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Wildcards" href="/tags/Wildcards.html">
                        Wildcards
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_PESC" href="/tags/PESC.html">
                        PESC
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Covariant" href="/tags/Covariant.html">
                        Covariant
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_View" href="/tags/View.html">
                        View
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Iterator" href="/tags/Iterator.html">
                        Iterator
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Fly_Weight" href="/tags/Fly_Weight.html">
                        Fly_Weight
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_LinkedList" href="/tags/LinkedList.html">
                        LinkedList
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Weak_Reference" href="/tags/Weak_Reference.html">
                        Weak_Reference
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Phantom_Reference" href="/tags/Phantom_Reference.html">
                        Phantom_Reference
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_HashMap" href="/tags/HashMap.html">
                        HashMap
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_File" href="/tags/File.html">
                        File
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Stream" href="/tags/Stream.html">
                        Stream
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Encapsulation" href="/tags/Encapsulation.html">
                        Encapsulation
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Unicode" href="/tags/Unicode.html">
                        Unicode
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_UTF-8" href="/tags/UTF-8.html">
                        UTF-8
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_ASCII" href="/tags/ASCII.html">
                        ASCII
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Encoding" href="/tags/Encoding.html">
                        Encoding
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Charset" href="/tags/Charset.html">
                        Charset
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_CPU" href="/tags/CPU.html">
                        CPU
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Process" href="/tags/Process.html">
                        Process
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Block" href="/tags/Block.html">
                        Block
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Logic_Gates" href="/tags/Logic_Gates.html">
                        Logic_Gates
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_NIO" href="/tags/NIO.html">
                        NIO
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Enum" href="/tags/Enum.html">
                        Enum
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Table_Driven" href="/tags/Table_Driven.html">
                        Table_Driven
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Annotations" href="/tags/Annotations.html">
                        Annotations
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Hibernate" href="/tags/Hibernate.html">
                        Hibernate
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JUnit" href="/tags/JUnit.html">
                        JUnit
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Spring" href="/tags/Spring.html">
                        Spring
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Syntactic sugar" href="/tags/Syntactic sugar.html">
                        Syntactic sugar
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_AOP" href="/tags/AOP.html">
                        AOP
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Concurrency" href="/tags/Concurrency.html">
                        Concurrency
                        <span class="badge">4</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Thread" href="/tags/Thread.html">
                        Thread
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_DJ" href="/tags/DJ.html">
                        DJ
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_IOC" href="/tags/IOC.html">
                        IOC
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Interrupt" href="/tags/Interrupt.html">
                        Interrupt
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_HTML" href="/tags/HTML.html">
                        HTML
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_CSS" href="/tags/CSS.html">
                        CSS
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Javascript" href="/tags/Javascript.html">
                        Javascript
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_JQuery" href="/tags/JQuery.html">
                        JQuery
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Sass" href="/tags/Sass.html">
                        Sass
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Responsive_Design" href="/tags/Responsive_Design.html">
                        Responsive_Design
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Code_Style" href="/tags/Code_Style.html">
                        Code_Style
                        <span class="badge">15</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Builder_Pattern" href="/tags/Builder_Pattern.html">
                        Builder_Pattern
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Instance_Control" href="/tags/Instance_Control.html">
                        Instance_Control
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Singleton" href="/tags/Singleton.html">
                        Singleton
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Comparable" href="/tags/Comparable.html">
                        Comparable
                        <span class="badge">2</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Clone" href="/tags/Clone.html">
                        Clone
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_API" href="/tags/API.html">
                        API
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Template_Pattern" href="/tags/Template_Pattern.html">
                        Template_Pattern
                        <span class="badge">3</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Jekyll" href="/tags/Jekyll.html">
                        Jekyll
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_Bootstrap" href="/tags/Bootstrap.html">
                        Bootstrap
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_SSH" href="/tags/SSH.html">
                        SSH
                        <span class="badge">1</span>
                        </a>
                    </div>
                
                    <div col-lg-3  col-md-4 col-sm-4 col-xs-6">
                        <a class="list-group-item" id="tag_RSA" href="/tags/RSA.html">
                        RSA
                        <span class="badge">1</span>
                        </a>
                    </div>
                
            </div>
        </div>
    </div>
    don't need tag cloud here -->

    <div class="footer-bottom">
        <div class="container">
            <p class="pull-left"> Copyright © <b>Wei SHEN</b> &nbsp | &nbsp Designed by <b>Wei SHEN</b> &nbsp | &nbsp Coded by <b>Wei SHEN</b> &nbsp | &nbsp 2015-2017. All right reserved.  &nbsp | &nbsp  Contact me: <b>symantec__@hotmail.com</b> </p>
            <div class="pull-right">
                <ul class="social">

                </ul>
            </div>
        </div>
    </div>
    <!--/.footer-bottom-->
</footer>



    <!-- Bootstrap Core JavaScript -->
    <script src="/assets/js/bootstrap.min.js"></script>
    <!-- Add space between two paragraph -->
    <script src="/assets/js/span.js"></script>
    <!-- Adjust images size -->
    <script src="/assets/js/imgResponsive.js"></script>
    <!-- Disqus comment count plugin -->
    <script id="dsq-count-scr" src="//www-ciaoshen-com.disqus.com/count.js" async></script>

</body>

</html>
